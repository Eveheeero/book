<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p3430" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_3430{left:69px;bottom:68px;letter-spacing:0.12px;}
#t2_3430{left:110px;bottom:68px;letter-spacing:0.1px;}
#t3_3430{left:69px;bottom:1141px;letter-spacing:-0.15px;word-spacing:0.01px;}
#t4_3430{left:69px;bottom:869px;letter-spacing:-0.15px;word-spacing:-0.65px;}
#t5_3430{left:69px;bottom:852px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t6_3430{left:69px;bottom:836px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#t7_3430{left:69px;bottom:813px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#t8_3430{left:69px;bottom:786px;}
#t9_3430{left:95px;bottom:790px;letter-spacing:-0.14px;word-spacing:-0.46px;}
#ta_3430{left:69px;bottom:763px;}
#tb_3430{left:95px;bottom:767px;letter-spacing:-0.13px;word-spacing:-0.48px;}
#tc_3430{left:95px;bottom:750px;letter-spacing:-0.14px;}
#td_3430{left:69px;bottom:727px;letter-spacing:-0.14px;word-spacing:-0.46px;}
#te_3430{left:69px;bottom:710px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#tf_3430{left:69px;bottom:687px;letter-spacing:-0.14px;word-spacing:-1px;}
#tg_3430{left:69px;bottom:671px;letter-spacing:-0.17px;word-spacing:-0.43px;}
#th_3430{left:69px;bottom:654px;letter-spacing:-0.14px;word-spacing:-0.49px;}
#ti_3430{left:69px;bottom:637px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#tj_3430{left:69px;bottom:620px;letter-spacing:-0.14px;word-spacing:-0.77px;}
#tk_3430{left:69px;bottom:603px;letter-spacing:-0.17px;word-spacing:-0.55px;}
#tl_3430{left:69px;bottom:587px;letter-spacing:-0.14px;word-spacing:-1.2px;}
#tm_3430{left:69px;bottom:570px;letter-spacing:-0.15px;word-spacing:-0.45px;}
#tn_3430{left:69px;bottom:553px;letter-spacing:-0.15px;word-spacing:-0.45px;}
#to_3430{left:69px;bottom:530px;letter-spacing:-0.16px;word-spacing:-0.44px;}
#tp_3430{left:69px;bottom:513px;letter-spacing:-0.13px;word-spacing:-0.5px;}
#tq_3430{left:69px;bottom:496px;letter-spacing:-0.14px;word-spacing:-0.53px;}
#tr_3430{left:69px;bottom:480px;letter-spacing:-0.14px;word-spacing:-0.44px;}
#ts_3430{left:69px;bottom:430px;letter-spacing:-0.09px;}
#tt_3430{left:162px;bottom:430px;letter-spacing:-0.1px;word-spacing:0.01px;}
#tu_3430{left:69px;bottom:407px;letter-spacing:-0.14px;word-spacing:-0.95px;}
#tv_3430{left:69px;bottom:390px;letter-spacing:-0.16px;word-spacing:-0.43px;}
#tw_3430{left:69px;bottom:373px;letter-spacing:-0.14px;word-spacing:-1.12px;}
#tx_3430{left:235px;bottom:373px;letter-spacing:-0.13px;word-spacing:-1.11px;}
#ty_3430{left:69px;bottom:357px;letter-spacing:-0.14px;word-spacing:-0.42px;}
#tz_3430{left:96px;bottom:314px;letter-spacing:-0.11px;}
#t10_3430{left:69px;bottom:268px;letter-spacing:-0.14px;word-spacing:-0.46px;}
#t11_3430{left:69px;bottom:251px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t12_3430{left:69px;bottom:234px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#t13_3430{left:69px;bottom:211px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t14_3430{left:258px;bottom:923px;letter-spacing:0.13px;word-spacing:-0.08px;}
#t15_3430{left:359px;bottom:923px;letter-spacing:0.13px;word-spacing:-0.02px;}
#t16_3430{left:259px;bottom:1031px;letter-spacing:0.12px;word-spacing:-0.21px;}
#t17_3430{left:255px;bottom:1001px;letter-spacing:-0.16px;}
#t18_3430{left:662px;bottom:1001px;}
#t19_3430{left:432px;bottom:977px;letter-spacing:0.1px;word-spacing:0.04px;}

.s1_3430{font-size:12px;font-family:NeoSansIntel_6wv3;color:#000;}
.s2_3430{font-size:14px;font-family:NeoSansIntel_6wv3;color:#0860A8;}
.s3_3430{font-size:14px;font-family:Verdana_b5t;color:#000;}
.s4_3430{font-size:21px;font-family:TimesNewRoman_b5y;color:#000;}
.s5_3430{font-size:17px;font-family:NeoSansIntelMedium_6wv2;color:#0860A8;}
.s6_3430{font-size:14px;font-family:NeoSansIntel_6wv3;color:#000;}
.s7_3430{font-size:15px;font-family:NeoSansIntelMedium_6wv2;color:#0860A8;}
.s8_3430{font-size:12px;font-family:Arial-Bold_b5w;color:#000;}
.s9_3430{font-size:11px;font-family:Arial_b5v;color:#000;}
.sa_3430{font-size:12px;font-family:Arial_b5v;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts3430" type="text/css" >

@font-face {
	font-family: Arial-Bold_b5w;
	src: url("fonts/Arial-Bold_b5w.woff") format("woff");
}

@font-face {
	font-family: Arial_b5v;
	src: url("fonts/Arial_b5v.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntelMedium_6wv2;
	src: url("fonts/NeoSansIntelMedium_6wv2.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_6wv3;
	src: url("fonts/NeoSansIntel_6wv3.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_b5y;
	src: url("fonts/TimesNewRoman_b5y.woff") format("woff");
}

@font-face {
	font-family: Verdana_b5t;
	src: url("fonts/Verdana_b5t.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg3430Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg3430" style="-webkit-user-select: none;"><object width="935" height="1210" data="3430/3430.svg" type="image/svg+xml" id="pdf3430" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_3430" class="t s1_3430">11-46 </span><span id="t2_3430" class="t s1_3430">Vol. 3A </span>
<span id="t3_3430" class="t s2_3430">ADVANCED PROGRAMMABLE INTERRUPT CONTROLLER (APIC) </span>
<span id="t4_3430" class="t s3_3430">In the xAPIC mode, the Destination Format Register (DFR) through the MMIO interface determines the choice of a </span>
<span id="t5_3430" class="t s3_3430">flat logical mode or a clustered logical mode. Flat logical mode is not supported in the x2APIC mode. Hence the </span>
<span id="t6_3430" class="t s3_3430">Destination Format Register (DFR) is eliminated in x2APIC mode. </span>
<span id="t7_3430" class="t s3_3430">The 32-bit logical x2APIC ID field of LDR is partitioned into two sub-fields: </span>
<span id="t8_3430" class="t s4_3430">• </span><span id="t9_3430" class="t s3_3430">Cluster ID (LDR[31:16]): is the address of the destination cluster </span>
<span id="ta_3430" class="t s4_3430">• </span><span id="tb_3430" class="t s3_3430">Logical ID (LDR[15:0]): defines a logical ID of the individual local x2APIC within the cluster specified by </span>
<span id="tc_3430" class="t s3_3430">LDR[31:16]. </span>
<span id="td_3430" class="t s3_3430">This layout enables 2^16-1 clusters each with up to 16 unique logical IDs - effectively providing an addressability </span>
<span id="te_3430" class="t s3_3430">of ((2^20) - 16) processors in logical destination mode. </span>
<span id="tf_3430" class="t s3_3430">It is likely that processor implementations may choose to support less than 16 bits of the cluster ID or less than 16- </span>
<span id="tg_3430" class="t s3_3430">bits of the Logical ID in the Logical Destination Register. However system software should be agnostic to the </span>
<span id="th_3430" class="t s3_3430">number of bits implemented in the cluster ID and logical ID sub-fields. The x2APIC hardware initialization will </span>
<span id="ti_3430" class="t s3_3430">ensure that the appropriately initialized logical x2APIC IDs are available to system software and reads of non- </span>
<span id="tj_3430" class="t s3_3430">implemented bits return zero. This is a read-only register that software must read to determine the logical x2APIC </span>
<span id="tk_3430" class="t s3_3430">ID of the processor. Specifically, software can apply a 16-bit mask to the lowest 16 bits of the logical x2APIC ID to </span>
<span id="tl_3430" class="t s3_3430">identify the logical address of a processor within a cluster without needing to know the number of implemented bits </span>
<span id="tm_3430" class="t s3_3430">in cluster ID and Logical ID sub-fields. Similarly, software can create a message destination address for cluster </span>
<span id="tn_3430" class="t s3_3430">model, by bit-Oring the Logical X2APIC ID (31:0) of processors that have matching Cluster ID(31:16). </span>
<span id="to_3430" class="t s3_3430">To enable cluster ID assignment in a fashion that matches the system topology characteristics and to enable effi- </span>
<span id="tp_3430" class="t s3_3430">cient routing of logical mode lowest priority device interrupts in link based platform interconnects, the LDR are </span>
<span id="tq_3430" class="t s3_3430">initialized by hardware based on the value of x2APIC ID upon x2APIC state transitions. Details of this initialization </span>
<span id="tr_3430" class="t s3_3430">are provided in Section 11.12.10.2. </span>
<span id="ts_3430" class="t s5_3430">11.12.10.2 </span><span id="tt_3430" class="t s5_3430">Deriving Logical x2APIC ID from the Local x2APIC ID </span>
<span id="tu_3430" class="t s3_3430">In x2APIC mode, the 32-bit logical x2APIC ID, which can be read from LDR, is derived from the 32-bit local x2APIC </span>
<span id="tv_3430" class="t s3_3430">ID. Specifically, the 16-bit logical ID sub-field is derived by shifting 1 by the lowest 4 bits of the x2APIC ID, i.e., </span>
<span id="tw_3430" class="t s3_3430">Logical ID = 1 « x2APIC </span><span id="tx_3430" class="t s3_3430">ID[3:0]. The remaining bits of the x2APIC ID then form the cluster ID portion of the logical </span>
<span id="ty_3430" class="t s3_3430">x2APIC ID: </span>
<span id="tz_3430" class="t s6_3430">Logical x2APIC ID = [(x2APIC ID[19:4] « 16) | (1 « x2APIC ID[3:0])] </span>
<span id="t10_3430" class="t s3_3430">The use of the lowest 4 bits in the x2APIC ID implies that at least 16 APIC IDs are reserved for logical processors </span>
<span id="t11_3430" class="t s3_3430">within a socket in multi-socket configurations. If more than 16 APIC IDS are reserved for logical processors in a </span>
<span id="t12_3430" class="t s3_3430">socket/package then multiple cluster IDs can exist within the package. </span>
<span id="t13_3430" class="t s3_3430">The LDR initialization occurs whenever the x2APIC mode is enabled (see Section 11.12.5). </span>
<span id="t14_3430" class="t s7_3430">Figure 11-29. </span><span id="t15_3430" class="t s7_3430">Logical Destination Register in x2APIC Mode </span>
<span id="t16_3430" class="t s8_3430">MSR Address: 80DH </span>
<span id="t17_3430" class="t s9_3430">31 </span><span id="t18_3430" class="t s9_3430">0 </span>
<span id="t19_3430" class="t sa_3430">Logical x2APIC ID </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
