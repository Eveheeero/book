<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p319" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_319{left:789px;bottom:68px;letter-spacing:0.08px;word-spacing:0.01px;}
#t2_319{left:827px;bottom:68px;letter-spacing:0.1px;}
#t3_319{left:712px;bottom:1076px;letter-spacing:0.26px;word-spacing:0.56px;}
#t4_319{left:290px;bottom:1051px;letter-spacing:0.24px;word-spacing:0.59px;}
#t5_319{left:69px;bottom:996px;letter-spacing:-0.16px;word-spacing:-0.45px;}
#t6_319{left:69px;bottom:979px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t7_319{left:69px;bottom:962px;letter-spacing:-0.15px;word-spacing:-0.51px;}
#t8_319{left:267px;bottom:962px;letter-spacing:-0.15px;word-spacing:-0.48px;}
#t9_319{left:339px;bottom:962px;letter-spacing:-0.14px;word-spacing:-0.51px;}
#ta_319{left:755px;bottom:962px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#tb_319{left:827px;bottom:962px;letter-spacing:-0.05px;}
#tc_319{left:69px;bottom:938px;letter-spacing:-0.13px;}
#td_319{left:99px;bottom:938px;letter-spacing:-0.16px;word-spacing:-0.47px;}
#te_319{left:242px;bottom:938px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#tf_319{left:69px;bottom:921px;letter-spacing:-0.19px;word-spacing:-0.42px;}
#tg_319{left:69px;bottom:904px;letter-spacing:-0.16px;word-spacing:-0.91px;}
#th_319{left:69px;bottom:888px;letter-spacing:-0.22px;word-spacing:-0.42px;}
#ti_319{left:69px;bottom:871px;letter-spacing:-0.19px;word-spacing:-1.29px;}
#tj_319{left:744px;bottom:871px;letter-spacing:-0.12px;word-spacing:-1.38px;}
#tk_319{left:69px;bottom:854px;letter-spacing:-0.16px;word-spacing:-0.47px;}
#tl_319{left:69px;bottom:830px;letter-spacing:-0.15px;word-spacing:-0.63px;}
#tm_319{left:491px;bottom:830px;letter-spacing:-0.17px;word-spacing:-0.65px;}
#tn_319{left:628px;bottom:830px;letter-spacing:-0.14px;word-spacing:-0.61px;}
#to_319{left:69px;bottom:813px;letter-spacing:-0.14px;word-spacing:-0.42px;}
#tp_319{left:136px;bottom:813px;letter-spacing:-0.17px;word-spacing:-0.47px;}
#tq_319{left:338px;bottom:813px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#tr_319{left:69px;bottom:796px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#ts_319{left:69px;bottom:771px;letter-spacing:-0.14px;word-spacing:-0.77px;}
#tt_319{left:730px;bottom:771px;letter-spacing:-0.17px;}
#tu_319{left:69px;bottom:755px;letter-spacing:-0.15px;}
#tv_319{left:138px;bottom:755px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#tw_319{left:69px;bottom:738px;letter-spacing:-0.16px;word-spacing:-0.46px;}
#tx_319{left:69px;bottom:713px;letter-spacing:-0.15px;word-spacing:-0.69px;}
#ty_319{left:754px;bottom:713px;letter-spacing:-0.18px;word-spacing:-0.64px;}
#tz_319{left:843px;bottom:713px;}
#t10_319{left:69px;bottom:697px;letter-spacing:-0.15px;word-spacing:-0.48px;}
#t11_319{left:69px;bottom:680px;letter-spacing:-0.15px;word-spacing:-0.44px;}
#t12_319{left:69px;bottom:663px;letter-spacing:-0.16px;}
#t13_319{left:69px;bottom:639px;letter-spacing:-0.2px;word-spacing:-0.53px;}
#t14_319{left:69px;bottom:622px;letter-spacing:-0.24px;word-spacing:-0.42px;}
#t15_319{left:69px;bottom:597px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t16_319{left:69px;bottom:580px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#t17_319{left:373px;bottom:580px;letter-spacing:-0.17px;word-spacing:-0.42px;}
#t18_319{left:569px;bottom:580px;letter-spacing:-0.12px;}
#t19_319{left:69px;bottom:512px;letter-spacing:0.16px;}
#t1a_319{left:150px;bottom:512px;letter-spacing:0.21px;word-spacing:0.01px;}
#t1b_319{left:69px;bottom:487px;letter-spacing:-0.14px;word-spacing:-0.58px;}
#t1c_319{left:480px;bottom:487px;letter-spacing:-0.17px;word-spacing:-0.56px;}
#t1d_319{left:617px;bottom:487px;letter-spacing:-0.13px;word-spacing:-0.56px;}
#t1e_319{left:69px;bottom:470px;letter-spacing:-0.14px;word-spacing:-0.63px;}
#t1f_319{left:69px;bottom:454px;letter-spacing:-0.11px;word-spacing:-0.53px;}
#t1g_319{left:248px;bottom:454px;letter-spacing:-0.18px;}
#t1h_319{left:384px;bottom:454px;letter-spacing:-0.16px;word-spacing:-0.45px;}
#t1i_319{left:69px;bottom:437px;letter-spacing:-0.15px;word-spacing:-0.52px;}
#t1j_319{left:69px;bottom:412px;letter-spacing:-0.16px;word-spacing:-0.95px;}
#t1k_319{left:717px;bottom:412px;letter-spacing:-0.16px;}
#t1l_319{left:69px;bottom:396px;letter-spacing:-0.16px;}
#t1m_319{left:131px;bottom:396px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t1n_319{left:69px;bottom:379px;letter-spacing:-0.14px;word-spacing:-0.98px;}
#t1o_319{left:69px;bottom:362px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#t1p_319{left:69px;bottom:336px;}
#t1q_319{left:95px;bottom:339px;letter-spacing:-0.15px;word-spacing:-0.41px;}
#t1r_319{left:700px;bottom:339px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#t1s_319{left:772px;bottom:339px;letter-spacing:-0.11px;}
#t1t_319{left:69px;bottom:313px;}
#t1u_319{left:95px;bottom:316px;letter-spacing:-0.14px;word-spacing:-0.42px;}
#t1v_319{left:793px;bottom:316px;letter-spacing:-0.14px;}
#t1w_319{left:95px;bottom:299px;letter-spacing:-0.16px;}
#t1x_319{left:134px;bottom:299px;letter-spacing:-0.11px;}
#t1y_319{left:69px;bottom:273px;}
#t1z_319{left:95px;bottom:276px;letter-spacing:-0.14px;word-spacing:-0.41px;}
#t20_319{left:755px;bottom:283px;}
#t21_319{left:771px;bottom:276px;letter-spacing:-0.17px;}
#t22_319{left:95px;bottom:260px;letter-spacing:-0.18px;word-spacing:-0.42px;}
#t23_319{left:228px;bottom:260px;letter-spacing:-0.16px;word-spacing:-0.47px;}
#t24_319{left:303px;bottom:260px;letter-spacing:-0.11px;}
#t25_319{left:69px;bottom:233px;}
#t26_319{left:95px;bottom:237px;letter-spacing:-0.14px;word-spacing:-0.59px;}
#t27_319{left:778px;bottom:243px;}
#t28_319{left:793px;bottom:237px;letter-spacing:-0.15px;}
#t29_319{left:95px;bottom:220px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t2a_319{left:254px;bottom:220px;letter-spacing:-0.16px;word-spacing:-0.48px;}
#t2b_319{left:330px;bottom:220px;letter-spacing:-0.12px;}
#t2c_319{left:95px;bottom:195px;}
#t2d_319{left:121px;bottom:195px;letter-spacing:-0.14px;word-spacing:-0.43px;}
#t2e_319{left:643px;bottom:195px;letter-spacing:-0.17px;word-spacing:-0.47px;}
#t2f_319{left:760px;bottom:195px;letter-spacing:-0.11px;}
#t2g_319{left:95px;bottom:171px;}
#t2h_319{left:121px;bottom:171px;letter-spacing:-0.15px;word-spacing:-0.41px;}
#t2i_319{left:121px;bottom:154px;letter-spacing:-0.21px;word-spacing:-0.41px;}
#t2j_319{left:353px;bottom:154px;letter-spacing:-0.17px;word-spacing:-0.47px;}
#t2k_319{left:460px;bottom:154px;letter-spacing:-0.11px;}
#t2l_319{left:69px;bottom:128px;}
#t2m_319{left:95px;bottom:131px;letter-spacing:-0.14px;word-spacing:-0.43px;}
#t2n_319{left:792px;bottom:138px;}
#t2o_319{left:95px;bottom:114px;letter-spacing:-0.18px;word-spacing:-0.43px;}
#t2p_319{left:329px;bottom:114px;letter-spacing:-0.17px;word-spacing:-0.47px;}
#t2q_319{left:440px;bottom:114px;letter-spacing:-0.12px;}

.s1_319{font-size:12px;font-family:NeoSansIntel_6wv3;color:#000;}
.s2_319{font-size:24px;font-family:NeoSansIntelMedium_6wv2;color:#0860A8;}
.s3_319{font-size:14px;font-family:Verdana_b5t;color:#000;}
.s4_319{font-size:14px;font-family:Verdana-Bold_b5u;color:#000;}
.s5_319{font-size:21px;font-family:NeoSansIntelMedium_6wv2;color:#0860A8;}
.s6_319{font-size:21px;font-family:TimesNewRoman_b5y;color:#000;}
.s7_319{font-size:11px;font-family:Verdana_b5t;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts319" type="text/css" >

@font-face {
	font-family: NeoSansIntelMedium_6wv2;
	src: url("fonts/NeoSansIntelMedium_6wv2.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_6wv3;
	src: url("fonts/NeoSansIntel_6wv3.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_b5y;
	src: url("fonts/TimesNewRoman_b5y.woff") format("woff");
}

@font-face {
	font-family: Verdana-Bold_b5u;
	src: url("fonts/Verdana-Bold_b5u.woff") format("woff");
}

@font-face {
	font-family: Verdana_b5t;
	src: url("fonts/Verdana_b5t.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg319Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg319" style="-webkit-user-select: none;"><object width="935" height="1210" data="319/319.svg" type="image/svg+xml" id="pdf319" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_319" class="t s1_319">Vol. 1 </span><span id="t2_319" class="t s1_319">13-1 </span>
<span id="t3_319" class="t s2_319">CHAPTER 13 </span>
<span id="t4_319" class="t s2_319">MANAGING STATE USING THE XSAVE FEATURE SET </span>
<span id="t5_319" class="t s3_319">The XSAVE feature set extends the functionality of the FXSAVE and FXRSTOR instructions (see Section 10.5, </span>
<span id="t6_319" class="t s3_319">“FXSAVE and FXRSTOR Instructions”) by supporting the saving and restoring of processor state in addition to the </span>
<span id="t7_319" class="t s3_319">x87 execution environment (</span><span id="t8_319" class="t s4_319">x87 state</span><span id="t9_319" class="t s3_319">) and the registers used by the streaming SIMD extensions (</span><span id="ta_319" class="t s4_319">SSE state</span><span id="tb_319" class="t s3_319">). </span>
<span id="tc_319" class="t s3_319">The </span><span id="td_319" class="t s4_319">XSAVE feature set </span><span id="te_319" class="t s3_319">comprises eight instructions. XGETBV and XSETBV allow software to read and write the </span>
<span id="tf_319" class="t s3_319">extended control register XCR0, which controls the operation of the XSAVE feature set. XSAVE, XSAVEOPT, </span>
<span id="tg_319" class="t s3_319">XSAVEC, and XSAVES are four instructions that save processor state to memory; XRSTOR and XRSTORS are corre- </span>
<span id="th_319" class="t s3_319">sponding instructions that load processor state from memory. XGETBV, XSAVE, XSAVEOPT, XSAVEC, and XRSTOR </span>
<span id="ti_319" class="t s3_319">can be executed at any privilege level; XSETBV, XSAVES, and XRSTORS can be executed only if CPL </span><span id="tj_319" class="t s3_319">= 0. In addition </span>
<span id="tk_319" class="t s3_319">to XCR0, the XSAVES and XRSTORS instructions are controlled also by the IA32_XSS MSR (index DA0H). </span>
<span id="tl_319" class="t s3_319">The XSAVE feature set organizes the state that manages into </span><span id="tm_319" class="t s4_319">state components</span><span id="tn_319" class="t s3_319">. Operation of the instructions is </span>
<span id="to_319" class="t s3_319">based on </span><span id="tp_319" class="t s4_319">state-component bitmaps </span><span id="tq_319" class="t s3_319">that have the same format as XCR0 and as the IA32_XSS MSR: each bit </span>
<span id="tr_319" class="t s3_319">corresponds to a state component. Section 13.1 discusses these state components and bitmaps in more detail. </span>
<span id="ts_319" class="t s3_319">Section 13.2 describes how the processor enumerates support for the XSAVE feature set and for </span><span id="tt_319" class="t s4_319">XSAVE-enabled </span>
<span id="tu_319" class="t s4_319">features </span><span id="tv_319" class="t s3_319">(those features that require use of the XSAVE feature set for their enabling). Section 13.3 explains how </span>
<span id="tw_319" class="t s3_319">software can enable the XSAVE feature set and XSAVE-enabled features. </span>
<span id="tx_319" class="t s3_319">The XSAVE feature set allows saving and loading processor state from a region of memory called an </span><span id="ty_319" class="t s4_319">XSAVE area</span><span id="tz_319" class="t s3_319">. </span>
<span id="t10_319" class="t s3_319">Section 13.4 presents details of the XSAVE area and its organization. Each XSAVE-managed state component is </span>
<span id="t11_319" class="t s3_319">associated with a section of the XSAVE area. Section 13.5 describes in detail each of the XSAVE-managed state </span>
<span id="t12_319" class="t s3_319">components. </span>
<span id="t13_319" class="t s3_319">Section 13.7 through Section 13.12 describe the operation of XSAVE, XRSTOR, XSAVEOPT, XSAVEC, XSAVES, and </span>
<span id="t14_319" class="t s3_319">XRSTORS, respectively. </span>
<span id="t15_319" class="t s3_319">Section 13.13 provides some details about memory accesses performed by instructions in the XSAVE feature set, </span>
<span id="t16_319" class="t s3_319">and Section 13.14 describes a facility called </span><span id="t17_319" class="t s4_319">extended feature disable </span><span id="t18_319" class="t s3_319">(XFD). </span>
<span id="t19_319" class="t s5_319">13.1 </span><span id="t1a_319" class="t s5_319">XSAVE-SUPPORTED FEATURES AND STATE-COMPONENT BITMAPS </span>
<span id="t1b_319" class="t s3_319">The XSAVE feature set supports the saving and restoring of </span><span id="t1c_319" class="t s4_319">state components</span><span id="t1d_319" class="t s3_319">, each of which is a discrete set of </span>
<span id="t1e_319" class="t s3_319">processor registers (or parts of registers). In general, each such state component corresponds to a particular CPU </span>
<span id="t1f_319" class="t s3_319">feature. Such a feature is </span><span id="t1g_319" class="t s4_319">XSAVE-supported</span><span id="t1h_319" class="t s3_319">. Some XSAVE-supported features use registers in multiple XSAVE- </span>
<span id="t1i_319" class="t s3_319">managed state components. </span>
<span id="t1j_319" class="t s3_319">The XSAVE feature set organizes the state components of the XSAVE-supported features using </span><span id="t1k_319" class="t s4_319">state-component </span>
<span id="t1l_319" class="t s4_319">bitmaps</span><span id="t1m_319" class="t s3_319">. A state-component bitmap comprises 64 bits; each bit in such a bitmap corresponds to a single state </span>
<span id="t1n_319" class="t s3_319">component. The following bits are defined in state-component bitmaps (details on individual state components are </span>
<span id="t1o_319" class="t s3_319">provided in subsections of Section 13.5): </span>
<span id="t1p_319" class="t s6_319">• </span><span id="t1q_319" class="t s3_319">Bit 0 corresponds to the state component used for the x87 FPU execution environment (</span><span id="t1r_319" class="t s4_319">x87 state</span><span id="t1s_319" class="t s3_319">). </span>
<span id="t1t_319" class="t s6_319">• </span><span id="t1u_319" class="t s3_319">Bit 1 corresponds to the state component used for registers used by the streaming SIMD extensions (</span><span id="t1v_319" class="t s4_319">SSE </span>
<span id="t1w_319" class="t s4_319">state</span><span id="t1x_319" class="t s3_319">). </span>
<span id="t1y_319" class="t s6_319">• </span><span id="t1z_319" class="t s3_319">Bit 2 corresponds to the state component used for the additional register state used by the Intel </span>
<span id="t20_319" class="t s7_319">® </span>
<span id="t21_319" class="t s3_319">Advanced </span>
<span id="t22_319" class="t s3_319">Vector Extensions (</span><span id="t23_319" class="t s4_319">AVX state</span><span id="t24_319" class="t s3_319">). </span>
<span id="t25_319" class="t s6_319">• </span><span id="t26_319" class="t s3_319">Bits 4:3 correspond to the two state components used for the additional register state used by Intel </span>
<span id="t27_319" class="t s7_319">® </span>
<span id="t28_319" class="t s3_319">Memory </span>
<span id="t29_319" class="t s3_319">Protection Extensions (</span><span id="t2a_319" class="t s4_319">MPX state</span><span id="t2b_319" class="t s3_319">): </span>
<span id="t2c_319" class="t s3_319">— </span><span id="t2d_319" class="t s3_319">State component 3 is used for the 4 128-bit bounds registers BND0–BND3 (</span><span id="t2e_319" class="t s4_319">BNDREGS state</span><span id="t2f_319" class="t s3_319">). </span>
<span id="t2g_319" class="t s3_319">— </span><span id="t2h_319" class="t s3_319">State component 4 is used for the 64-bit user-mode MPX configuration register BNDCFGU and the 64-bit </span>
<span id="t2i_319" class="t s3_319">MPX status register BNDSTATUS (</span><span id="t2j_319" class="t s4_319">BNDCSR state</span><span id="t2k_319" class="t s3_319">). </span>
<span id="t2l_319" class="t s6_319">• </span><span id="t2m_319" class="t s3_319">Bits 7:5 correspond to the three state components used for the additional register state used by Intel </span>
<span id="t2n_319" class="t s7_319">® </span>
<span id="t2o_319" class="t s3_319">Advanced Vector Extensions 512 (</span><span id="t2p_319" class="t s4_319">AVX-512 state</span><span id="t2q_319" class="t s3_319">): </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
