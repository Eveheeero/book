<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p123" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_123{left:110px;bottom:1129px;letter-spacing:-0.19px;word-spacing:1.45px;}
#t2_123{left:800px;bottom:1129px;letter-spacing:-0.17px;}
#t3_123{left:110px;bottom:1082px;letter-spacing:0.12px;}
#t4_123{left:173px;bottom:1082px;letter-spacing:0.16px;word-spacing:2.24px;}
#t5_123{left:486px;bottom:1082px;letter-spacing:0.14px;}
#t6_123{left:580px;bottom:1082px;}
#t7_123{left:593px;bottom:1082px;letter-spacing:0.14px;}
#t8_123{left:696px;bottom:1082px;}
#t9_123{left:110px;bottom:1036px;letter-spacing:-0.19px;}
#ta_123{left:143px;bottom:1036px;letter-spacing:-0.17px;}
#tb_123{left:235px;bottom:1036px;letter-spacing:-0.18px;word-spacing:0.55px;}
#tc_123{left:790px;bottom:1036px;letter-spacing:-0.17px;}
#td_123{left:110px;bottom:1015px;letter-spacing:-0.16px;word-spacing:2.63px;}
#te_123{left:680px;bottom:1015px;letter-spacing:-0.18px;}
#tf_123{left:722px;bottom:1015px;letter-spacing:-0.17px;word-spacing:2.31px;}
#tg_123{left:110px;bottom:994px;letter-spacing:-0.17px;word-spacing:1.43px;}
#th_123{left:440px;bottom:994px;letter-spacing:-0.18px;}
#ti_123{left:533px;bottom:994px;letter-spacing:-0.21px;word-spacing:1.52px;}
#tj_123{left:706px;bottom:994px;letter-spacing:-0.18px;}
#tk_123{left:741px;bottom:994px;}
#tl_123{left:152px;bottom:950px;word-spacing:2.11px;}
#tm_123{left:445px;bottom:950px;letter-spacing:0.12px;}
#tn_123{left:530px;bottom:950px;letter-spacing:0.12px;}
#to_123{left:560px;bottom:950px;letter-spacing:0.12px;}
#tp_123{left:592px;bottom:950px;letter-spacing:0.01px;word-spacing:2.06px;}
#tq_123{left:703px;bottom:950px;letter-spacing:0.12px;}
#tr_123{left:152px;bottom:931px;letter-spacing:-0.03px;word-spacing:1.89px;}
#ts_123{left:220px;bottom:901px;letter-spacing:0.09px;}
#tt_123{left:704px;bottom:901px;}
#tu_123{left:432px;bottom:883px;letter-spacing:-0.16px;}
#tv_123{left:456px;bottom:866px;letter-spacing:-0.15px;}
#tw_123{left:254px;bottom:824px;letter-spacing:-0.14px;word-spacing:1.68px;}
#tx_123{left:110px;bottom:786px;letter-spacing:-0.38px;word-spacing:2.59px;}
#ty_123{left:286px;bottom:786px;letter-spacing:-0.17px;}
#tz_123{left:380px;bottom:786px;letter-spacing:-0.18px;word-spacing:2.29px;}
#t10_123{left:684px;bottom:786px;letter-spacing:-0.18px;}
#t11_123{left:787px;bottom:786px;letter-spacing:-0.15px;}
#t12_123{left:110px;bottom:766px;letter-spacing:-0.12px;word-spacing:1.34px;}
#t13_123{left:220px;bottom:736px;letter-spacing:0.09px;}
#t14_123{left:704px;bottom:736px;}
#t15_123{left:432px;bottom:718px;letter-spacing:-0.16px;}
#t16_123{left:428px;bottom:701px;letter-spacing:-0.16px;}
#t17_123{left:456px;bottom:683px;letter-spacing:-0.15px;}
#t18_123{left:251px;bottom:641px;letter-spacing:-0.14px;word-spacing:1.68px;}
#t19_123{left:110px;bottom:580px;letter-spacing:0.12px;}
#t1a_123{left:173px;bottom:580px;letter-spacing:0.01px;word-spacing:2.53px;}
#t1b_123{left:475px;bottom:580px;letter-spacing:0.14px;}
#t1c_123{left:522px;bottom:580px;}
#t1d_123{left:110px;bottom:534px;letter-spacing:-0.19px;}
#t1e_123{left:143px;bottom:534px;letter-spacing:-0.17px;}
#t1f_123{left:191px;bottom:534px;letter-spacing:-0.16px;word-spacing:0.28px;}
#t1g_123{left:741px;bottom:534px;letter-spacing:-0.15px;}
#t1h_123{left:770px;bottom:534px;letter-spacing:-0.18px;word-spacing:2.87px;}
#t1i_123{left:110px;bottom:513px;letter-spacing:-0.18px;word-spacing:3.82px;}
#t1j_123{left:348px;bottom:513px;letter-spacing:-0.17px;}
#t1k_123{left:399px;bottom:513px;letter-spacing:-0.14px;word-spacing:3.75px;}
#t1l_123{left:110px;bottom:493px;letter-spacing:-0.15px;}
#t1m_123{left:182px;bottom:493px;letter-spacing:-0.17px;}
#t1n_123{left:226px;bottom:493px;letter-spacing:-0.17px;word-spacing:1.46px;}
#t1o_123{left:220px;bottom:463px;letter-spacing:0.12px;}
#t1p_123{left:704px;bottom:463px;}
#t1q_123{left:450px;bottom:445px;letter-spacing:-0.16px;}
#t1r_123{left:434px;bottom:428px;letter-spacing:-0.21px;}
#t1s_123{left:278px;bottom:385px;letter-spacing:-0.16px;word-spacing:1.73px;}
#t1t_123{left:602px;bottom:385px;letter-spacing:-0.18px;}
#t1u_123{left:646px;bottom:385px;letter-spacing:-0.11px;}
#t1v_123{left:110px;bottom:346px;letter-spacing:-0.16px;word-spacing:0.76px;}
#t1w_123{left:498px;bottom:346px;letter-spacing:-0.18px;}
#t1x_123{left:547px;bottom:346px;letter-spacing:-0.14px;word-spacing:0.73px;}
#t1y_123{left:110px;bottom:326px;letter-spacing:-0.2px;word-spacing:2.38px;}
#t1z_123{left:630px;bottom:326px;letter-spacing:-0.18px;}
#t20_123{left:680px;bottom:326px;letter-spacing:-0.14px;word-spacing:2px;}
#t21_123{left:110px;bottom:305px;letter-spacing:-0.17px;word-spacing:1.42px;}
#t22_123{left:421px;bottom:305px;letter-spacing:-0.18px;}
#t23_123{left:465px;bottom:305px;letter-spacing:-0.14px;word-spacing:1.39px;}
#t24_123{left:110px;bottom:269px;letter-spacing:-0.15px;word-spacing:0.22px;}
#t25_123{left:110px;bottom:248px;letter-spacing:-0.16px;word-spacing:1.06px;}
#t26_123{left:557px;bottom:248px;letter-spacing:-0.18px;}
#t27_123{left:606px;bottom:248px;letter-spacing:-0.15px;word-spacing:1.01px;}
#t28_123{left:110px;bottom:228px;letter-spacing:-0.15px;word-spacing:0.63px;}
#t29_123{left:110px;bottom:207px;letter-spacing:-0.15px;word-spacing:-0.06px;}
#t2a_123{left:110px;bottom:186px;letter-spacing:-0.16px;word-spacing:1.67px;}
#t2b_123{left:651px;bottom:186px;letter-spacing:-0.18px;}
#t2c_123{left:709px;bottom:186px;letter-spacing:-0.19px;word-spacing:1.51px;}
#t2d_123{left:110px;bottom:166px;letter-spacing:-0.18px;word-spacing:1.47px;}
#t2e_123{left:110px;bottom:130px;letter-spacing:-0.15px;word-spacing:2.11px;}
#t2f_123{left:110px;bottom:109px;letter-spacing:-0.14px;word-spacing:-0.1px;}
#t2g_123{left:186px;bottom:109px;letter-spacing:-0.17px;}
#t2h_123{left:234px;bottom:109px;letter-spacing:-0.13px;word-spacing:-0.11px;}

.s1_123{font-size:17px;font-family:CMSL10_1g7;color:#000;}
.s2_123{font-size:17px;font-family:CMR10_1fw;color:#000;}
.s3_123{font-size:18px;font-family:CMBX12_1fi;color:#000;}
.s4_123{font-size:18px;font-family:CMTT12_1gn;color:#000;}
.s5_123{font-size:17px;font-family:CMTT10_1gl;color:#000;}
.s6_123{font-size:15px;font-family:CMTI10_1gf;color:#000;}
.s7_123{font-size:15px;font-family:CMTT10_1gl;color:#000;}
.s8_123{font-size:12px;font-family:CMR8_1g3;color:#000;}
.s9_123{font-size:14px;font-family:CMTT9_1gr;color:#000;}
.sa_123{font-size:14px;font-family:CMR9_1g5;color:#000;}
.sb_123{font-size:17px;font-family:CMR10_1fw;color:#000080;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts123" type="text/css" >

@font-face {
	font-family: CMBX12_1fi;
	src: url("fonts/CMBX12_1fi.woff") format("woff");
}

@font-face {
	font-family: CMR10_1fw;
	src: url("fonts/CMR10_1fw.woff") format("woff");
}

@font-face {
	font-family: CMR8_1g3;
	src: url("fonts/CMR8_1g3.woff") format("woff");
}

@font-face {
	font-family: CMR9_1g5;
	src: url("fonts/CMR9_1g5.woff") format("woff");
}

@font-face {
	font-family: CMSL10_1g7;
	src: url("fonts/CMSL10_1g7.woff") format("woff");
}

@font-face {
	font-family: CMTI10_1gf;
	src: url("fonts/CMTI10_1gf.woff") format("woff");
}

@font-face {
	font-family: CMTT10_1gl;
	src: url("fonts/CMTT10_1gl.woff") format("woff");
}

@font-face {
	font-family: CMTT12_1gn;
	src: url("fonts/CMTT12_1gn.woff") format("woff");
}

@font-face {
	font-family: CMTT9_1gr;
	src: url("fonts/CMTT9_1gr.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg123Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg123" style="-webkit-user-select: none;"><object width="935" height="1210" data="123/123.svg" type="image/svg+xml" id="pdf123" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_123" class="t s1_123">Volume II: RISC-V Privileged Architectures V20211203 </span><span id="t2_123" class="t s2_123">109 </span>
<span id="t3_123" class="t s3_123">8.2.7 </span><span id="t4_123" class="t s3_123">Hypervisor Time Delta Registers (</span><span id="t5_123" class="t s4_123">htimedelta</span><span id="t6_123" class="t s3_123">, </span><span id="t7_123" class="t s4_123">htimedeltah</span><span id="t8_123" class="t s3_123">) </span>
<span id="t9_123" class="t s2_123">The </span><span id="ta_123" class="t s5_123">htimedelta </span><span id="tb_123" class="t s2_123">CSR is a read/write register that contains the delta between the value of the </span><span id="tc_123" class="t s5_123">time </span>
<span id="td_123" class="t s2_123">CSR and the value returned in VS-mode or VU-mode. That is, reading the </span><span id="te_123" class="t s5_123">time </span><span id="tf_123" class="t s2_123">CSR in VS or </span>
<span id="tg_123" class="t s2_123">VU mode returns the sum of the contents of </span><span id="th_123" class="t s5_123">htimedelta </span><span id="ti_123" class="t s2_123">and the actual value of </span><span id="tj_123" class="t s5_123">time</span><span id="tk_123" class="t s2_123">. </span>
<span id="tl_123" class="t s6_123" data-mappings='[[12,"fl"]]'>Because overﬂow is ignored when summing </span><span id="tm_123" class="t s7_123">htimedelta </span><span id="tn_123" class="t s6_123">and </span><span id="to_123" class="t s7_123">time</span><span id="tp_123" class="t s6_123">, large values of </span><span id="tq_123" class="t s7_123">htimedelta </span>
<span id="tr_123" class="t s6_123" data-mappings='[[40,"ff"]]'>may be used to represent negative time oﬀsets. </span>
<span id="ts_123" class="t s8_123">63 </span><span id="tt_123" class="t s8_123">0 </span>
<span id="tu_123" class="t s9_123">htimedelta </span>
<span id="tv_123" class="t sa_123">64 </span>
<span id="tw_123" class="t s2_123">Figure 8.15: Hypervisor time delta register, HSXLEN=64. </span>
<span id="tx_123" class="t s2_123">For HSXLEN=32 only, </span><span id="ty_123" class="t s5_123">htimedelta </span><span id="tz_123" class="t s2_123">holds the lower 32 bits of the delta, and </span><span id="t10_123" class="t s5_123">htimedeltah </span><span id="t11_123" class="t s2_123">holds </span>
<span id="t12_123" class="t s2_123">the upper 32 bits of the delta. </span>
<span id="t13_123" class="t s8_123">31 </span><span id="t14_123" class="t s8_123">0 </span>
<span id="t15_123" class="t s9_123">htimedelta </span>
<span id="t16_123" class="t s9_123">htimedeltah </span>
<span id="t17_123" class="t sa_123">32 </span>
<span id="t18_123" class="t s2_123">Figure 8.16: Hypervisor time delta registers, HSXLEN=32. </span>
<span id="t19_123" class="t s3_123">8.2.8 </span><span id="t1a_123" class="t s3_123">Hypervisor Trap Value Register (</span><span id="t1b_123" class="t s4_123">htval</span><span id="t1c_123" class="t s3_123">) </span>
<span id="t1d_123" class="t s2_123">The </span><span id="t1e_123" class="t s5_123">htval </span><span id="t1f_123" class="t s2_123">register is an HSXLEN-bit read/write register formatted as shown in Figure </span><span id="t1g_123" class="t sb_123">8.17</span><span id="t1h_123" class="t s2_123">. When </span>
<span id="t1i_123" class="t s2_123">a trap is taken into HS-mode, </span><span id="t1j_123" class="t s5_123">htval </span><span id="t1k_123" class="t s2_123" data-mappings='[[42,"fi"]]'>is written with additional exception-speciﬁc information, </span>
<span id="t1l_123" class="t s2_123">alongside </span><span id="t1m_123" class="t s5_123">stval</span><span id="t1n_123" class="t s2_123">, to assist software in handling the trap. </span>
<span id="t1o_123" class="t s8_123">HSXLEN-1 </span><span id="t1p_123" class="t s8_123">0 </span>
<span id="t1q_123" class="t s9_123">htval </span>
<span id="t1r_123" class="t sa_123">HSXLEN </span>
<span id="t1s_123" class="t s2_123">Figure 8.17: Hypervisor trap value register (</span><span id="t1t_123" class="t s5_123">htval</span><span id="t1u_123" class="t s2_123">). </span>
<span id="t1v_123" class="t s2_123">When a guest-page-fault trap is taken into HS-mode, </span><span id="t1w_123" class="t s5_123">htval </span><span id="t1x_123" class="t s2_123">is written with either zero or the guest </span>
<span id="t1y_123" class="t s2_123">physical address that faulted, shifted right by 2 bits. For other traps, </span><span id="t1z_123" class="t s5_123">htval </span><span id="t20_123" class="t s2_123">is set to zero, but a </span>
<span id="t21_123" class="t s2_123" data-mappings='[[37,"fi"]]'>future standard or extension may redeﬁne </span><span id="t22_123" class="t s5_123">htval</span><span id="t23_123" class="t s2_123">’s setting for other traps. </span>
<span id="t24_123" class="t s2_123" data-mappings='[[69,"fi"]]'>A guest-page fault may arise due to an implicit memory access during ﬁrst-stage (VS-stage) address </span>
<span id="t25_123" class="t s2_123">translation, in which case a guest physical address written to </span><span id="t26_123" class="t s5_123">htval </span><span id="t27_123" class="t s2_123">is that of the implicit memory </span>
<span id="t28_123" class="t s2_123">access that faulted—for example, the address of a VS-level page table entry that could not be read. </span>
<span id="t29_123" class="t s2_123">(The guest physical address corresponding to the original virtual address is unknown when VS-stage </span>
<span id="t2a_123" class="t s2_123">translation fails to complete.) Additional information is provided in CSR </span><span id="t2b_123" class="t s5_123">htinst </span><span id="t2c_123" class="t s2_123">to disambiguate </span>
<span id="t2d_123" class="t s2_123">such situations. </span>
<span id="t2e_123" class="t s2_123">Otherwise, for misaligned loads and stores that cause guest-page faults, a nonzero guest physical </span>
<span id="t2f_123" class="t s2_123">address in </span><span id="t2g_123" class="t s5_123">htval </span><span id="t2h_123" class="t s2_123">corresponds to the faulting portion of the access as indicated by the virtual address </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
