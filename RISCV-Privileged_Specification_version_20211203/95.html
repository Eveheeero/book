<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p95" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_95{left:110px;bottom:1129px;letter-spacing:-0.19px;word-spacing:1.45px;}
#t2_95{left:808px;bottom:1129px;letter-spacing:-0.17px;}
#t3_95{left:110px;bottom:1082px;letter-spacing:-0.15px;word-spacing:0.98px;}
#t4_95{left:280px;bottom:1082px;letter-spacing:-0.3px;}
#t5_95{left:326px;bottom:1082px;letter-spacing:-0.15px;word-spacing:1.19px;}
#t6_95{left:110px;bottom:1062px;letter-spacing:-0.18px;word-spacing:0.69px;}
#t7_95{left:110px;bottom:1041px;letter-spacing:-0.14px;word-spacing:0.86px;}
#t8_95{left:110px;bottom:1020px;letter-spacing:-0.18px;word-spacing:3.63px;}
#t9_95{left:110px;bottom:999px;letter-spacing:-0.15px;word-spacing:0.99px;}
#ta_95{left:110px;bottom:979px;letter-spacing:-0.13px;word-spacing:1.35px;}
#tb_95{left:152px;bottom:934px;letter-spacing:-0.03px;word-spacing:5.31px;}
#tc_95{left:152px;bottom:916px;letter-spacing:0.12px;}
#td_95{left:211px;bottom:916px;letter-spacing:-0.03px;word-spacing:3.31px;}
#te_95{left:152px;bottom:898px;letter-spacing:0.06px;word-spacing:1.75px;}
#tf_95{left:446px;bottom:898px;letter-spacing:0.09px;}
#tg_95{left:466px;bottom:898px;}
#th_95{left:466px;bottom:898px;}
#ti_95{left:478px;bottom:898px;letter-spacing:0.12px;}
#tj_95{left:494px;bottom:898px;}
#tk_95{left:110px;bottom:861px;letter-spacing:-0.17px;word-spacing:0.57px;}
#tl_95{left:110px;bottom:825px;letter-spacing:-0.17px;word-spacing:0.77px;}
#tm_95{left:110px;bottom:804px;letter-spacing:-0.15px;word-spacing:1.75px;}
#tn_95{left:110px;bottom:784px;letter-spacing:-0.14px;word-spacing:1.39px;}
#to_95{left:110px;bottom:748px;letter-spacing:-0.17px;word-spacing:1.42px;}
#tp_95{left:152px;bottom:705px;letter-spacing:-0.14px;word-spacing:1.3px;}
#tq_95{left:152px;bottom:684px;letter-spacing:-0.14px;word-spacing:1.39px;}
#tr_95{left:152px;bottom:652px;letter-spacing:-0.14px;word-spacing:0.6px;}
#ts_95{left:152px;bottom:632px;letter-spacing:-0.15px;word-spacing:1.67px;}
#tt_95{left:152px;bottom:611px;letter-spacing:-0.18px;word-spacing:1.51px;}
#tu_95{left:152px;bottom:590px;letter-spacing:-0.17px;word-spacing:3.42px;}
#tv_95{left:413px;bottom:590px;letter-spacing:-0.13px;word-spacing:3.32px;}
#tw_95{left:152px;bottom:569px;letter-spacing:-0.14px;word-spacing:1.86px;}
#tx_95{left:152px;bottom:549px;letter-spacing:-0.17px;word-spacing:2.61px;}
#ty_95{left:152px;bottom:528px;letter-spacing:-0.17px;word-spacing:1.7px;}
#tz_95{left:152px;bottom:507px;letter-spacing:-0.16px;word-spacing:2.08px;}
#t10_95{left:152px;bottom:487px;letter-spacing:-0.15px;word-spacing:0.95px;}
#t11_95{left:152px;bottom:466px;letter-spacing:-0.15px;word-spacing:1.39px;}
#t12_95{left:152px;bottom:440px;letter-spacing:-0.12px;word-spacing:0.48px;}
#t13_95{left:152px;bottom:419px;letter-spacing:-0.18px;word-spacing:2.72px;}
#t14_95{left:152px;bottom:398px;letter-spacing:-0.13px;word-spacing:1.35px;}
#t15_95{left:110px;bottom:355px;letter-spacing:-0.18px;word-spacing:1.45px;}
#t16_95{left:152px;bottom:311px;word-spacing:2.39px;}
#t17_95{left:152px;bottom:292px;word-spacing:2.15px;}
#t18_95{left:152px;bottom:274px;letter-spacing:0.02px;}
#t19_95{left:240px;bottom:274px;letter-spacing:0.02px;word-spacing:3.59px;}
#t1a_95{left:152px;bottom:256px;letter-spacing:-0.04px;word-spacing:3.62px;}
#t1b_95{left:524px;bottom:256px;letter-spacing:0.03px;word-spacing:3.57px;}
#t1c_95{left:152px;bottom:237px;letter-spacing:-0.04px;word-spacing:3.39px;}
#t1d_95{left:152px;bottom:219px;letter-spacing:-0.05px;word-spacing:1.92px;}
#t1e_95{left:177px;bottom:201px;letter-spacing:0.02px;word-spacing:2.41px;}
#t1f_95{left:152px;bottom:183px;letter-spacing:0.11px;word-spacing:1.64px;}
#t1g_95{left:177px;bottom:164px;letter-spacing:0.01px;word-spacing:3.02px;}
#t1h_95{left:152px;bottom:146px;letter-spacing:0.05px;word-spacing:1.27px;}
#t1i_95{left:152px;bottom:128px;letter-spacing:-0.03px;word-spacing:1.41px;}
#t1j_95{left:152px;bottom:110px;letter-spacing:0.04px;word-spacing:1.91px;}

.s1_95{font-size:17px;font-family:CMSL10_1g7;color:#000;}
.s2_95{font-size:17px;font-family:CMR10_1fw;color:#000;}
.s3_95{font-size:17px;font-family:CMTI10_1gf;color:#000;}
.s4_95{font-size:15px;font-family:CMTI10_1gf;color:#000;}
.s5_95{font-size:15px;font-family:CMR10_1fw;color:#000;}
.s6_95{font-size:15px;font-family:CMSY10_1g9;color:#000;}
.s7_95{font-size:15px;font-family:CMTT10_1gl;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts95" type="text/css" >

@font-face {
	font-family: CMR10_1fw;
	src: url("fonts/CMR10_1fw.woff") format("woff");
}

@font-face {
	font-family: CMSL10_1g7;
	src: url("fonts/CMSL10_1g7.woff") format("woff");
}

@font-face {
	font-family: CMSY10_1g9;
	src: url("fonts/CMSY10_1g9.woff") format("woff");
}

@font-face {
	font-family: CMTI10_1gf;
	src: url("fonts/CMTI10_1gf.woff") format("woff");
}

@font-face {
	font-family: CMTT10_1gl;
	src: url("fonts/CMTT10_1gl.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg95Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg95" style="-webkit-user-select: none;"><object width="935" height="1210" data="95/95.svg" type="image/svg+xml" id="pdf95" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_95" class="t s1_95">Volume II: RISC-V Privileged Architectures V20211203 </span><span id="t2_95" class="t s2_95">81 </span>
<span id="t3_95" class="t s2_95">The G bit designates a </span><span id="t4_95" class="t s3_95">global </span><span id="t5_95" class="t s2_95">mapping. Global mappings are those that exist in all address spaces. </span>
<span id="t6_95" class="t s2_95">For non-leaf PTEs, the global setting implies that all mappings in the subsequent levels of the page </span>
<span id="t7_95" class="t s2_95">table are global. Note that failing to mark a global mapping as global merely reduces performance, </span>
<span id="t8_95" class="t s2_95">whereas marking a non-global mapping as global is a software bug that, after switching to an </span>
<span id="t9_95" class="t s2_95" data-mappings='[[23,"ff"]]'>address space with a diﬀerent non-global mapping for that address range, can unpredictably result </span>
<span id="ta_95" class="t s2_95">in either mapping being used. </span>
<span id="tb_95" class="t s4_95">Global mappings need not be stored redundantly in address-translation caches for multiple </span>
<span id="tc_95" class="t s4_95">ASIDs. </span><span id="td_95" class="t s4_95" data-mappings='[[31,"fl"]]'>Additionally, they need not be ﬂushed from local address-translation caches when an </span>
<span id="te_95" class="t s4_95">SFENCE.VMA instruction is executed with </span><span id="tf_95" class="t s5_95">rs2</span><span id="tg_95" class="t s6_95"≯</span><span id="th_95" class="t s5_95">=</span><span id="ti_95" class="t s7_95">x0</span><span id="tj_95" class="t s4_95">. </span>
<span id="tk_95" class="t s2_95" data-mappings='[[8,"fi"],[94,"fi"]]'>The RSW ﬁeld is reserved for use by supervisor software; the implementation shall ignore this ﬁeld. </span>
<span id="tl_95" class="t s2_95">Each leaf PTE contains an accessed (A) and dirty (D) bit. The A bit indicates the virtual page has </span>
<span id="tm_95" class="t s2_95">been read, written, or fetched from since the last time the A bit was cleared. The D bit indicates </span>
<span id="tn_95" class="t s2_95">the virtual page has been written since the last time the D bit was cleared. </span>
<span id="to_95" class="t s2_95">Two schemes to manage the A and D bits are permitted: </span>
<span id="tp_95" class="t s2_95">When a virtual page is accessed and the A bit is clear, or is written and the D bit is clear, a </span>
<span id="tq_95" class="t s2_95">page-fault exception is raised. </span>
<span id="tr_95" class="t s2_95">When a virtual page is accessed and the A bit is clear, or is written and the D bit is clear, the </span>
<span id="ts_95" class="t s2_95">implementation sets the corresponding bit(s) in the PTE. The PTE update must be atomic </span>
<span id="tt_95" class="t s2_95">with respect to other accesses to the PTE, and must atomically check that the PTE is valid </span>
<span id="tu_95" class="t s2_95" data-mappings='[[13,"ffi"]]'>and grants suﬃcient permissions. </span><span id="tv_95" class="t s2_95">Updates of the A bit may be performed as a result of </span>
<span id="tw_95" class="t s2_95">speculation, but updates to the D bit must be exact (i.e., not speculative), and observed in </span>
<span id="tx_95" class="t s2_95">program order by the local hart. Furthermore, the PTE update must appear in the global </span>
<span id="ty_95" class="t s2_95">memory order no later than the explicit memory access, or any subsequent explicit memory </span>
<span id="tz_95" class="t s2_95">access to that virtual page by the local hart. The ordering on loads and stores provided by </span>
<span id="t10_95" class="t s2_95">FENCE instructions and the acquire/release bits on atomic instructions also orders the PTE </span>
<span id="t11_95" class="t s2_95">updates associated with those loads and stores as observed by remote harts. </span>
<span id="t12_95" class="t s2_95">The PTE update is not required to be atomic with respect to the explicit memory access that </span>
<span id="t13_95" class="t s2_95">caused the update, and the sequence is interruptible. However, the hart must not perform </span>
<span id="t14_95" class="t s2_95">the explicit memory access before the PTE update is globally visible. </span>
<span id="t15_95" class="t s2_95">All harts in a system must employ the same PTE-update scheme as each other. </span>
<span id="t16_95" class="t s4_95" data-mappings='[[28,"fi"]]'>Prior versions of this speciﬁcation required PTE A bit updates to be exact, but allowing the A </span>
<span id="t17_95" class="t s4_95" data-mappings='[[51,"fi"]]'>bit to be updated as a result of speculation simpliﬁes the implementation of address translation </span>
<span id="t18_95" class="t s4_95">prefetchers. </span><span id="t19_95" class="t s4_95">System software typically uses the A bit as a page replacement policy hint, but </span>
<span id="t1a_95" class="t s4_95">does not require exactness for functional correctness. </span><span id="t1b_95" class="t s4_95">On the other hand, D bit updates are </span>
<span id="t1c_95" class="t s4_95" data-mappings='[[73,"ff"]]'>still required to be exact and performed in program order, as the D bit aﬀects the functional </span>
<span id="t1d_95" class="t s4_95">correctness of page eviction. </span>
<span id="t1e_95" class="t s4_95">Implementations are of course still permitted to perform both A and D bit updates only in </span>
<span id="t1f_95" class="t s4_95">an exact manner. </span>
<span id="t1g_95" class="t s4_95">In both cases, requiring atomicity ensures that the PTE update will not be interrupted by </span>
<span id="t1h_95" class="t s4_95">other intervening writes to the page table, as such interruptions could lead to A/D bits being set </span>
<span id="t1i_95" class="t s4_95">on PTEs that have been reused for other purposes, on memory that has been reclaimed for other </span>
<span id="t1j_95" class="t s4_95">purposes, and so on. Simple implementations may instead generate page-fault exceptions. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
