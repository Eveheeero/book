<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p141" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_141{left:110px;bottom:1129px;letter-spacing:-0.19px;word-spacing:1.45px;}
#t2_141{left:800px;bottom:1129px;letter-spacing:-0.17px;}
#t3_141{left:110px;bottom:1080px;letter-spacing:-0.04px;}
#t4_141{left:166px;bottom:1080px;letter-spacing:-0.56px;}
#t5_141{left:110px;bottom:1028px;letter-spacing:0.12px;}
#t6_141{left:173px;bottom:1028px;letter-spacing:0.04px;word-spacing:2.49px;}
#t7_141{left:110px;bottom:983px;letter-spacing:-0.18px;word-spacing:2.2px;}
#t8_141{left:610px;bottom:983px;letter-spacing:-0.14px;}
#t9_141{left:638px;bottom:983px;letter-spacing:-0.1px;word-spacing:1.71px;}
#ta_141{left:110px;bottom:962px;letter-spacing:-0.14px;word-spacing:0.69px;}
#tb_141{left:110px;bottom:941px;letter-spacing:-0.17px;word-spacing:0.1px;}
#tc_141{left:110px;bottom:920px;letter-spacing:-0.14px;word-spacing:1.39px;}
#td_141{left:110px;bottom:900px;letter-spacing:-0.17px;word-spacing:0.69px;}
#te_141{left:110px;bottom:879px;letter-spacing:-0.12px;word-spacing:1.34px;}
#tf_141{left:152px;bottom:834px;letter-spacing:-0.02px;word-spacing:1.89px;}
#tg_141{left:110px;bottom:798px;letter-spacing:-0.14px;word-spacing:2.68px;}
#th_141{left:110px;bottom:777px;letter-spacing:-0.15px;word-spacing:2.88px;}
#ti_141{left:491px;bottom:777px;letter-spacing:-0.24px;}
#tj_141{left:587px;bottom:777px;letter-spacing:-0.2px;word-spacing:2.97px;}
#tk_141{left:110px;bottom:756px;letter-spacing:-0.15px;word-spacing:1.54px;}
#tl_141{left:110px;bottom:736px;letter-spacing:-0.15px;word-spacing:1.92px;}
#tm_141{left:392px;bottom:736px;letter-spacing:-0.18px;}
#tn_141{left:486px;bottom:736px;letter-spacing:-0.15px;}
#to_141{left:507px;bottom:736px;letter-spacing:-0.18px;}
#tp_141{left:594px;bottom:736px;letter-spacing:-0.14px;word-spacing:2.89px;}
#tq_141{left:738px;bottom:736px;letter-spacing:-0.24px;}
#tr_141{left:110px;bottom:715px;letter-spacing:-0.16px;word-spacing:1.24px;}
#ts_141{left:110px;bottom:694px;letter-spacing:-0.17px;word-spacing:1.39px;}
#tt_141{left:400px;bottom:694px;letter-spacing:-0.18px;}
#tu_141{left:467px;bottom:694px;letter-spacing:-0.09px;word-spacing:1.28px;}
#tv_141{left:110px;bottom:658px;letter-spacing:-0.15px;word-spacing:3.15px;}
#tw_141{left:738px;bottom:658px;letter-spacing:-0.18px;}
#tx_141{left:798px;bottom:658px;letter-spacing:-0.18px;}
#ty_141{left:110px;bottom:638px;letter-spacing:-0.17px;}
#tz_141{left:206px;bottom:638px;letter-spacing:-0.19px;word-spacing:2.19px;}
#t10_141{left:387px;bottom:638px;}
#t11_141{left:400px;bottom:638px;letter-spacing:-0.15px;word-spacing:1.62px;}
#t12_141{left:110px;bottom:617px;letter-spacing:-0.16px;word-spacing:0.62px;}
#t13_141{left:110px;bottom:596px;letter-spacing:-0.14px;word-spacing:1.41px;}
#t14_141{left:110px;bottom:576px;letter-spacing:-0.17px;word-spacing:2.48px;}
#t15_141{left:110px;bottom:555px;letter-spacing:-0.17px;word-spacing:0.4px;}
#t16_141{left:110px;bottom:534px;letter-spacing:-0.15px;word-spacing:0.6px;}
#t17_141{left:110px;bottom:514px;letter-spacing:-0.14px;word-spacing:1.86px;}
#t18_141{left:688px;bottom:514px;letter-spacing:-0.14px;}
#t19_141{left:754px;bottom:514px;letter-spacing:-0.16px;word-spacing:1.87px;}
#t1a_141{left:110px;bottom:493px;letter-spacing:-0.17px;}
#t1b_141{left:159px;bottom:493px;letter-spacing:-0.15px;}
#t1c_141{left:180px;bottom:493px;letter-spacing:-0.17px;}
#t1d_141{left:267px;bottom:493px;letter-spacing:-0.14px;word-spacing:1.63px;}
#t1e_141{left:110px;bottom:472px;letter-spacing:-0.17px;word-spacing:1.98px;}
#t1f_141{left:110px;bottom:451px;letter-spacing:-0.16px;word-spacing:3.38px;}
#t1g_141{left:110px;bottom:431px;letter-spacing:-0.16px;}
#t1h_141{left:152px;bottom:386px;letter-spacing:0.01px;word-spacing:3.61px;}
#t1i_141{left:152px;bottom:368px;letter-spacing:0.04px;word-spacing:1.76px;}
#t1j_141{left:110px;bottom:331px;letter-spacing:-0.16px;word-spacing:1.44px;}
#t1k_141{left:152px;bottom:288px;letter-spacing:-0.15px;word-spacing:1.58px;}
#t1l_141{left:152px;bottom:267px;letter-spacing:-0.17px;}
#t1m_141{left:245px;bottom:267px;letter-spacing:-0.14px;word-spacing:1.39px;}
#t1n_141{left:424px;bottom:267px;letter-spacing:-0.18px;}
#t1o_141{left:517px;bottom:267px;letter-spacing:-0.12px;word-spacing:1.38px;}
#t1p_141{left:152px;bottom:235px;letter-spacing:-0.14px;word-spacing:-0.27px;}
#t1q_141{left:152px;bottom:214px;letter-spacing:-0.13px;word-spacing:1.38px;}
#t1r_141{left:197px;bottom:214px;letter-spacing:-0.17px;}
#t1s_141{left:290px;bottom:214px;letter-spacing:-0.14px;word-spacing:1.39px;}
#t1t_141{left:469px;bottom:214px;letter-spacing:-0.18px;}
#t1u_141{left:562px;bottom:214px;letter-spacing:-0.12px;word-spacing:1.38px;}
#t1v_141{left:152px;bottom:182px;letter-spacing:-0.15px;word-spacing:1.33px;}
#t1w_141{left:152px;bottom:162px;letter-spacing:-0.14px;}
#t1x_141{left:199px;bottom:162px;letter-spacing:-0.17px;}
#t1y_141{left:292px;bottom:162px;letter-spacing:-0.15px;}
#t1z_141{left:312px;bottom:162px;letter-spacing:-0.17px;}
#t20_141{left:405px;bottom:162px;letter-spacing:-0.14px;word-spacing:1.39px;}
#t21_141{left:584px;bottom:162px;letter-spacing:-0.18px;}
#t22_141{left:677px;bottom:162px;letter-spacing:-0.12px;word-spacing:1.38px;}
#t23_141{left:152px;bottom:130px;letter-spacing:-0.15px;word-spacing:0.76px;}
#t24_141{left:152px;bottom:109px;letter-spacing:-0.14px;word-spacing:1.4px;}
#t25_141{left:272px;bottom:109px;letter-spacing:-0.17px;}
#t26_141{left:365px;bottom:109px;letter-spacing:-0.15px;}
#t27_141{left:386px;bottom:109px;letter-spacing:-0.18px;}
#t28_141{left:479px;bottom:109px;letter-spacing:-0.14px;word-spacing:1.39px;}
#t29_141{left:657px;bottom:109px;letter-spacing:-0.18px;}
#t2a_141{left:751px;bottom:109px;letter-spacing:-0.12px;word-spacing:1.38px;}

.s1_141{font-size:17px;font-family:CMSL10_1g7;color:#000;}
.s2_141{font-size:17px;font-family:CMR10_1fw;color:#000;}
.s3_141{font-size:22px;font-family:CMBX12_1fi;color:#000;}
.s4_141{font-size:18px;font-family:CMBX12_1fi;color:#000;}
.s5_141{font-size:17px;font-family:CMR10_1fw;color:#000080;}
.s6_141{font-size:15px;font-family:CMTI10_1gf;color:#000;}
.s7_141{font-size:17px;font-family:CMTI10_1gf;color:#000;}
.s8_141{font-size:17px;font-family:CMTT10_1gl;color:#000;}
.s9_141{font-size:17px;font-family:CMMI10_1fq;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts141" type="text/css" >

@font-face {
	font-family: CMBX12_1fi;
	src: url("fonts/CMBX12_1fi.woff") format("woff");
}

@font-face {
	font-family: CMMI10_1fq;
	src: url("fonts/CMMI10_1fq.woff") format("woff");
}

@font-face {
	font-family: CMR10_1fw;
	src: url("fonts/CMR10_1fw.woff") format("woff");
}

@font-face {
	font-family: CMSL10_1g7;
	src: url("fonts/CMSL10_1g7.woff") format("woff");
}

@font-face {
	font-family: CMTI10_1gf;
	src: url("fonts/CMTI10_1gf.woff") format("woff");
}

@font-face {
	font-family: CMTT10_1gl;
	src: url("fonts/CMTT10_1gl.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg141Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg141" style="-webkit-user-select: none;"><object width="935" height="1210" data="141/141.svg" type="image/svg+xml" id="pdf141" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_141" class="t s1_141">Volume II: RISC-V Privileged Architectures V20211203 </span><span id="t2_141" class="t s2_141">127 </span>
<span id="t3_141" class="t s3_141">8.6 </span><span id="t4_141" class="t s3_141">Traps </span>
<span id="t5_141" class="t s4_141">8.6.1 </span><span id="t6_141" class="t s4_141">Trap Cause Codes </span>
<span id="t7_141" class="t s2_141">The hypervisor extension augments the trap cause encoding. Table </span><span id="t8_141" class="t s5_141">8.6 </span><span id="t9_141" class="t s2_141">lists the possible M-mode </span>
<span id="ta_141" class="t s2_141">and HS-mode trap cause codes when the hypervisor extension is implemented. Codes are added for </span>
<span id="tb_141" class="t s2_141">VS-level interrupts (interrupts 2, 6, 10), for supervisor-level guest external interrupts (interrupt 12), </span>
<span id="tc_141" class="t s2_141">for virtual instruction exceptions (exception 22), and for guest-page faults (exceptions 20, 21, 23). </span>
<span id="td_141" class="t s2_141">Furthermore, environment calls from VS-mode are assigned cause 10, whereas those from HS-mode </span>
<span id="te_141" class="t s2_141">or S-mode use cause 9 as usual. </span>
<span id="tf_141" class="t s6_141" data-mappings='[[33,"ff"]]'>HS-mode and VS-mode ECALLs use diﬀerent cause values so they can be delegated separately. </span>
<span id="tg_141" class="t s2_141">When V=1, a virtual instruction exception (code 22) is normally raised instead of an illegal in- </span>
<span id="th_141" class="t s2_141">struction exception if the attempted instruction is </span><span id="ti_141" class="t s7_141" data-mappings='[[8,"fi"]]'>HS-qualiﬁed </span><span id="tj_141" class="t s2_141">but is prevented from executing </span>
<span id="tk_141" class="t s2_141" data-mappings='[[27,"ffi"]]'>when V=1 either due to insuﬃcient privilege or because the instruction is expressly disabled by a </span>
<span id="tl_141" class="t s2_141">supervisor or hypervisor CSR such as </span><span id="tm_141" class="t s8_141">scounteren </span><span id="tn_141" class="t s2_141">or </span><span id="to_141" class="t s8_141">hcounteren</span><span id="tp_141" class="t s2_141">. An instruction is </span><span id="tq_141" class="t s7_141" data-mappings='[[8,"fi"]]'>HS-qualiﬁed </span>
<span id="tr_141" class="t s2_141">if it would be valid to execute in HS-mode (for some values of the instruction’s register operands), </span>
<span id="ts_141" class="t s2_141" data-mappings='[[9,"fi"]]'>assuming ﬁelds TSR and TVM of CSR </span><span id="tt_141" class="t s8_141">mstatus </span><span id="tu_141" class="t s2_141">are both zero. </span>
<span id="tv_141" class="t s2_141">Special rules apply for CSR instructions that access 32-bit high-half CSRs such as </span><span id="tw_141" class="t s8_141">cycleh </span><span id="tx_141" class="t s2_141">and </span>
<span id="ty_141" class="t s8_141">htimedeltah</span><span id="tz_141" class="t s2_141">. When V=1 and XLEN</span><span id="t10_141" class="t s9_141">&gt;</span><span id="t11_141" class="t s2_141">32, an attempt to access a high-half supervisor-level CSR, </span>
<span id="t12_141" class="t s2_141">high-half hypervisor CSR, high-half VS CSR, or high-half unprivileged CSR always raises an illegal </span>
<span id="t13_141" class="t s2_141">instruction exception. And in VS-mode, if the XLEN for VU-mode is greater than 32, an attempt </span>
<span id="t14_141" class="t s2_141">to access a high-half user-level CSR (distinct from an unprivileged CSR) always raises an illegal </span>
<span id="t15_141" class="t s2_141">instruction exception. On the other hand, when V=1 and XLEN=32, an invalid attempt to access a </span>
<span id="t16_141" class="t s2_141">high-half S-level, hypervisor, VS, or unprivileged CSR raises a virtual instruction exception instead </span>
<span id="t17_141" class="t s2_141">of an illegal instruction exception if the same CSR instruction for the partner </span><span id="t18_141" class="t s7_141">low-half </span><span id="t19_141" class="t s2_141">CSR (e.g. </span>
<span id="t1a_141" class="t s8_141">cycle </span><span id="t1b_141" class="t s2_141">or </span><span id="t1c_141" class="t s8_141">htimedelta</span><span id="t1d_141" class="t s2_141" data-mappings='[[13,"fi"]]'>) is HS-qualiﬁed. Likewise, in VS-mode, if the XLEN for VU-mode is 32, an </span>
<span id="t1e_141" class="t s2_141">invalid attempt to access a high-half user-level CSR raises a virtual instruction exception instead </span>
<span id="t1f_141" class="t s2_141">of an illegal instruction exception if the same CSR instruction for the partner low-half CSR is </span>
<span id="t1g_141" class="t s2_141" data-mappings='[[8,"fi"]]'>HS-qualiﬁed. </span>
<span id="t1h_141" class="t s6_141" data-mappings='[[47,"fi"]]'>The RISC-V Privileged Architecture currently deﬁnes no user-level CSRs, but they might be </span>
<span id="t1i_141" class="t s6_141">added by a future version of this standard or by an extension. </span>
<span id="t1j_141" class="t s2_141" data-mappings='[[5,"fi"]]'>Speciﬁcally, a virtual instruction exception is raised for the following cases: </span>
<span id="t1k_141" class="t s2_141">in VS-mode, attempts to access a non-high-half counter CSR when the corresponding bit in </span>
<span id="t1l_141" class="t s8_141">hcounteren </span><span id="t1m_141" class="t s2_141">is 0 and the same bit in </span><span id="t1n_141" class="t s8_141">mcounteren </span><span id="t1o_141" class="t s2_141">is 1; </span>
<span id="t1p_141" class="t s2_141">in VS-mode, if XLEN=32, attempts to access a high-half counter CSR when the corresponding </span>
<span id="t1q_141" class="t s2_141">bit in </span><span id="t1r_141" class="t s8_141">hcounteren </span><span id="t1s_141" class="t s2_141">is 0 and the same bit in </span><span id="t1t_141" class="t s8_141">mcounteren </span><span id="t1u_141" class="t s2_141">is 1; </span>
<span id="t1v_141" class="t s2_141">in VU-mode, attempts to access a non-high-half counter CSR when the corresponding bit in </span>
<span id="t1w_141" class="t s2_141">either </span><span id="t1x_141" class="t s8_141">hcounteren </span><span id="t1y_141" class="t s2_141">or </span><span id="t1z_141" class="t s8_141">scounteren </span><span id="t20_141" class="t s2_141">is 0 and the same bit in </span><span id="t21_141" class="t s8_141">mcounteren </span><span id="t22_141" class="t s2_141">is 1; </span>
<span id="t23_141" class="t s2_141">in VU-mode, if XLEN=32, attempts to access a high-half counter CSR when the correspond- </span>
<span id="t24_141" class="t s2_141">ing bit in either </span><span id="t25_141" class="t s8_141">hcounteren </span><span id="t26_141" class="t s2_141">or </span><span id="t27_141" class="t s8_141">scounteren </span><span id="t28_141" class="t s2_141">is 0 and the same bit in </span><span id="t29_141" class="t s8_141">mcounteren </span><span id="t2a_141" class="t s2_141">is 1; </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
