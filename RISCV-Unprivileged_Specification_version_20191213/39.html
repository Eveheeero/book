<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p39" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_39{left:110px;bottom:1129px;letter-spacing:-0.21px;word-spacing:1.47px;}
#t2_39{left:808px;bottom:1129px;letter-spacing:-0.17px;}
#t3_39{left:110px;bottom:1082px;letter-spacing:-0.15px;word-spacing:1.39px;}
#t4_39{left:747px;bottom:1082px;letter-spacing:-1px;}
#t5_39{left:762px;bottom:1082px;}
#t6_39{left:774px;bottom:1082px;letter-spacing:-0.17px;}
#t7_39{left:792px;bottom:1082px;}
#t8_39{left:170px;bottom:1040px;letter-spacing:0.09px;}
#t9_39{left:221px;bottom:1040px;letter-spacing:0.09px;}
#ta_39{left:361px;bottom:1040px;letter-spacing:0.09px;}
#tb_39{left:406px;bottom:1040px;letter-spacing:0.09px;}
#tc_39{left:457px;bottom:1040px;letter-spacing:0.09px;}
#td_39{left:537px;bottom:1040px;letter-spacing:0.09px;word-spacing:2.51px;}
#te_39{left:643px;bottom:1040px;letter-spacing:5.69px;}
#tf_39{left:781px;bottom:1040px;}
#tg_39{left:148px;bottom:1017px;letter-spacing:-0.17px;}
#th_39{left:259px;bottom:1017px;letter-spacing:-0.16px;}
#ti_39{left:383px;bottom:1017px;letter-spacing:-0.17px;}
#tj_39{left:461px;bottom:1017px;letter-spacing:-0.16px;}
#tk_39{left:592px;bottom:1017px;letter-spacing:-0.16px;}
#tl_39{left:697px;bottom:1017px;letter-spacing:0.02px;}
#tm_39{left:163px;bottom:995px;}
#tn_39{left:287px;bottom:995px;letter-spacing:-0.17px;}
#to_39{left:409px;bottom:995px;}
#tp_39{left:497px;bottom:995px;}
#tq_39{left:596px;bottom:995px;}
#tr_39{left:714px;bottom:995px;}
#ts_39{left:305px;bottom:975px;letter-spacing:-0.14px;}
#tt_39{left:585px;bottom:975px;letter-spacing:-0.15px;}
#tu_39{left:703px;bottom:975px;letter-spacing:-0.21px;}
#tv_39{left:110px;bottom:929px;letter-spacing:-0.14px;word-spacing:1.13px;}
#tw_39{left:110px;bottom:908px;letter-spacing:-0.15px;word-spacing:0.62px;}
#tx_39{left:707px;bottom:908px;letter-spacing:-0.15px;}
#ty_39{left:729px;bottom:908px;letter-spacing:-0.14px;word-spacing:0.68px;}
#tz_39{left:110px;bottom:888px;letter-spacing:-0.16px;word-spacing:2.8px;}
#t10_39{left:453px;bottom:888px;letter-spacing:-0.17px;word-spacing:2.8px;}
#t11_39{left:110px;bottom:867px;}
#t12_39{left:116px;bottom:867px;letter-spacing:-0.17px;}
#t13_39{left:134px;bottom:867px;letter-spacing:-0.15px;word-spacing:2.88px;}
#t14_39{left:330px;bottom:867px;letter-spacing:-1px;}
#t15_39{left:344px;bottom:867px;}
#t16_39{left:361px;bottom:867px;letter-spacing:-0.15px;}
#t17_39{left:428px;bottom:867px;letter-spacing:-0.18px;}
#t18_39{left:452px;bottom:867px;letter-spacing:-0.13px;word-spacing:2.85px;}
#t19_39{left:110px;bottom:846px;letter-spacing:-0.14px;}
#t1a_39{left:151px;bottom:830px;letter-spacing:0.09px;}
#t1b_39{left:375px;bottom:830px;letter-spacing:0.09px;word-spacing:2.51px;}
#t1c_39{left:474px;bottom:830px;letter-spacing:0.09px;word-spacing:2.51px;}
#t1d_39{left:533px;bottom:830px;letter-spacing:0.09px;}
#t1e_39{left:557px;bottom:830px;letter-spacing:0.09px;}
#t1f_39{left:644px;bottom:830px;letter-spacing:5.69px;}
#t1g_39{left:783px;bottom:830px;}
#t1h_39{left:227px;bottom:807px;letter-spacing:-0.16px;}
#t1i_39{left:426px;bottom:807px;letter-spacing:-0.14px;}
#t1j_39{left:496px;bottom:807px;letter-spacing:-0.15px;}
#t1k_39{left:593px;bottom:807px;letter-spacing:-0.16px;}
#t1l_39{left:699px;bottom:807px;letter-spacing:0.02px;}
#t1m_39{left:259px;bottom:786px;letter-spacing:-0.17px;}
#t1n_39{left:433px;bottom:786px;}
#t1o_39{left:512px;bottom:786px;}
#t1p_39{left:597px;bottom:786px;}
#t1q_39{left:716px;bottom:786px;}
#t1r_39{left:228px;bottom:765px;letter-spacing:-0.14px;}
#t1s_39{left:422px;bottom:765px;letter-spacing:-0.16px;}
#t1t_39{left:512px;bottom:765px;}
#t1u_39{left:586px;bottom:765px;letter-spacing:-0.15px;}
#t1v_39{left:698px;bottom:765px;letter-spacing:-0.22px;}
#t1w_39{left:152px;bottom:723px;letter-spacing:0.05px;word-spacing:3.48px;}
#t1x_39{left:152px;bottom:704px;letter-spacing:-0.07px;word-spacing:2.95px;}
#t1y_39{left:280px;bottom:704px;letter-spacing:0.06px;word-spacing:2.71px;}
#t1z_39{left:152px;bottom:686px;letter-spacing:0.03px;word-spacing:1.62px;}
#t20_39{left:706px;bottom:686px;letter-spacing:0.09px;}
#t21_39{left:731px;bottom:686px;letter-spacing:0.1px;word-spacing:1.34px;}
#t22_39{left:152px;bottom:668px;letter-spacing:0.04px;word-spacing:1.83px;}
#t23_39{left:152px;bottom:649px;letter-spacing:0.03px;word-spacing:1.79px;}
#t24_39{left:405px;bottom:649px;letter-spacing:0.12px;}
#t25_39{left:421px;bottom:649px;letter-spacing:-0.03px;word-spacing:1.89px;}
#t26_39{left:177px;bottom:631px;letter-spacing:0.04px;word-spacing:1.79px;}
#t27_39{left:152px;bottom:613px;letter-spacing:0.03px;word-spacing:1.03px;}
#t28_39{left:152px;bottom:595px;word-spacing:2.72px;}
#t29_39{left:152px;bottom:576px;letter-spacing:0.01px;word-spacing:1.82px;}
#t2a_39{left:177px;bottom:558px;letter-spacing:0.02px;word-spacing:3.2px;}
#t2b_39{left:152px;bottom:540px;letter-spacing:0.03px;word-spacing:3.01px;}
#t2c_39{left:152px;bottom:522px;letter-spacing:0.02px;word-spacing:1.5px;}
#t2d_39{left:152px;bottom:503px;letter-spacing:0.04px;word-spacing:1.74px;}
#t2e_39{left:177px;bottom:485px;letter-spacing:-0.03px;word-spacing:1.35px;}
#t2f_39{left:331px;bottom:485px;letter-spacing:0.11px;}
#t2g_39{left:362px;bottom:485px;letter-spacing:0.12px;}
#t2h_39{left:378px;bottom:485px;letter-spacing:0.02px;word-spacing:1.26px;}
#t2i_39{left:152px;bottom:467px;letter-spacing:0.08px;word-spacing:0.98px;}
#t2j_39{left:152px;bottom:449px;letter-spacing:0.05px;word-spacing:2.67px;}
#t2k_39{left:152px;bottom:430px;letter-spacing:-0.06px;word-spacing:1.95px;}
#t2l_39{left:110px;bottom:394px;letter-spacing:-0.15px;word-spacing:2.33px;}
#t2m_39{left:110px;bottom:373px;letter-spacing:-0.18px;word-spacing:1.47px;}
#t2n_39{left:152px;bottom:328px;letter-spacing:0.04px;word-spacing:1.96px;}
#t2o_39{left:152px;bottom:310px;letter-spacing:0.05px;word-spacing:1.74px;}
#t2p_39{left:110px;bottom:274px;letter-spacing:-0.15px;word-spacing:0.29px;}
#t2q_39{left:110px;bottom:253px;letter-spacing:-0.14px;word-spacing:1.72px;}
#t2r_39{left:110px;bottom:232px;letter-spacing:-0.18px;word-spacing:2.98px;}
#t2s_39{left:110px;bottom:211px;letter-spacing:-0.17px;word-spacing:2.32px;}
#t2t_39{left:110px;bottom:191px;letter-spacing:-0.19px;}
#t2u_39{left:154px;bottom:191px;letter-spacing:-1px;}
#t2v_39{left:168px;bottom:191px;}
#t2w_39{left:181px;bottom:191px;letter-spacing:-0.17px;}
#t2x_39{left:199px;bottom:191px;}
#t2y_39{left:207px;bottom:191px;letter-spacing:-0.17px;}
#t2z_39{left:225px;bottom:191px;letter-spacing:-0.19px;word-spacing:1.63px;}
#t30_39{left:724px;bottom:191px;letter-spacing:-0.14px;}
#t31_39{left:745px;bottom:191px;}
#t32_39{left:152px;bottom:146px;letter-spacing:0.05px;word-spacing:3.4px;}
#t33_39{left:152px;bottom:128px;letter-spacing:0.06px;word-spacing:3px;}
#t34_39{left:349px;bottom:128px;letter-spacing:0.03px;word-spacing:3.08px;}
#t35_39{left:152px;bottom:110px;letter-spacing:-0.07px;word-spacing:1.98px;}

.s1_39{font-size:17px;font-family:CMSL10_27d;color:#000;}
.s2_39{font-size:17px;font-family:CMR10_270;color:#000;}
.s3_39{font-size:17px;font-family:CMTI10_27t;color:#000;}
.s4_39{font-size:17px;font-family:CMTT10_27z;color:#000;}
.s5_39{font-size:12px;font-family:CMR8_278;color:#000;}
.s6_39{font-size:15px;font-family:CMTI10_27t;color:#000;}
.s7_39{font-size:15px;font-family:CMR10_270;color:#000;}
.s8_39{font-size:15px;font-family:CMTT10_27z;color:#000;}
.s9_39{font-size:17px;font-family:CMR10_270;color:#000080;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts39" type="text/css" >

@font-face {
	font-family: CMR10_270;
	src: url("fonts/CMR10_270.woff") format("woff");
}

@font-face {
	font-family: CMR8_278;
	src: url("fonts/CMR8_278.woff") format("woff");
}

@font-face {
	font-family: CMSL10_27d;
	src: url("fonts/CMSL10_27d.woff") format("woff");
}

@font-face {
	font-family: CMTI10_27t;
	src: url("fonts/CMTI10_27t.woff") format("woff");
}

@font-face {
	font-family: CMTT10_27z;
	src: url("fonts/CMTT10_27z.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg39Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg39" style="-webkit-user-select: none;"><object width="935" height="1210" data="39/39.svg" type="image/svg+xml" id="pdf39" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_39" class="t s1_39">Volume I: RISC-V Unprivileged ISA V20191213 </span><span id="t2_39" class="t s2_39">21 </span>
<span id="t3_39" class="t s2_39">Plain unconditional jumps (assembler pseudoinstruction J) are encoded as a JAL with </span><span id="t4_39" class="t s3_39">rd</span><span id="t5_39" class="t s2_39">=</span><span id="t6_39" class="t s4_39">x0</span><span id="t7_39" class="t s2_39">. </span>
<span id="t8_39" class="t s5_39">31 </span><span id="t9_39" class="t s5_39">30 </span><span id="ta_39" class="t s5_39">21 </span><span id="tb_39" class="t s5_39">20 </span><span id="tc_39" class="t s5_39">19 </span><span id="td_39" class="t s5_39">12 11 </span><span id="te_39" class="t s5_39">76 </span><span id="tf_39" class="t s5_39">0 </span>
<span id="tg_39" class="t s2_39">imm[20] </span><span id="th_39" class="t s2_39">imm[10:1] </span><span id="ti_39" class="t s2_39">imm[11] </span><span id="tj_39" class="t s2_39">imm[19:12] </span><span id="tk_39" class="t s2_39">rd </span><span id="tl_39" class="t s2_39">opcode </span>
<span id="tm_39" class="t s2_39">1 </span><span id="tn_39" class="t s2_39">10 </span><span id="to_39" class="t s2_39">1 </span><span id="tp_39" class="t s2_39">8 </span><span id="tq_39" class="t s2_39">5 </span><span id="tr_39" class="t s2_39">7 </span>
<span id="ts_39" class="t s2_39" data-mappings='[[1,"ff"]]'>oﬀset[20:1] </span><span id="tt_39" class="t s2_39">dest </span><span id="tu_39" class="t s2_39">JAL </span>
<span id="tv_39" class="t s2_39">The indirect jump instruction JALR (jump and link register) uses the I-type encoding. The target </span>
<span id="tw_39" class="t s2_39">address is obtained by adding the sign-extended 12-bit I-immediate to the register </span><span id="tx_39" class="t s3_39">rs1</span><span id="ty_39" class="t s2_39">, then setting </span>
<span id="tz_39" class="t s2_39" data-mappings='[[15,"fi"]]'>the least-signiﬁcant bit of the result to zero. </span><span id="t10_39" class="t s2_39">The address of the instruction following the jump </span>
<span id="t11_39" class="t s2_39">(</span><span id="t12_39" class="t s4_39">pc</span><span id="t13_39" class="t s2_39">+4) is written to register </span><span id="t14_39" class="t s3_39">rd</span><span id="t15_39" class="t s2_39">. </span><span id="t16_39" class="t s2_39">Register </span><span id="t17_39" class="t s4_39">x0 </span><span id="t18_39" class="t s2_39">can be used as the destination if the result is not </span>
<span id="t19_39" class="t s2_39">required. </span>
<span id="t1a_39" class="t s5_39">31 </span><span id="t1b_39" class="t s5_39">20 19 </span><span id="t1c_39" class="t s5_39">15 14 </span><span id="t1d_39" class="t s5_39">12 </span><span id="t1e_39" class="t s5_39">11 </span><span id="t1f_39" class="t s5_39">76 </span><span id="t1g_39" class="t s5_39">0 </span>
<span id="t1h_39" class="t s2_39">imm[11:0] </span><span id="t1i_39" class="t s2_39">rs1 </span><span id="t1j_39" class="t s2_39">funct3 </span><span id="t1k_39" class="t s2_39">rd </span><span id="t1l_39" class="t s2_39">opcode </span>
<span id="t1m_39" class="t s2_39">12 </span><span id="t1n_39" class="t s2_39">5 </span><span id="t1o_39" class="t s2_39">3 </span><span id="t1p_39" class="t s2_39">5 </span><span id="t1q_39" class="t s2_39">7 </span>
<span id="t1r_39" class="t s2_39" data-mappings='[[1,"ff"]]'>oﬀset[11:0] </span><span id="t1s_39" class="t s2_39">base </span><span id="t1t_39" class="t s2_39">0 </span><span id="t1u_39" class="t s2_39">dest </span><span id="t1v_39" class="t s2_39">JALR </span>
<span id="t1w_39" class="t s6_39">The unconditional jump instructions all use PC-relative addressing to help support position- </span>
<span id="t1x_39" class="t s6_39">independent code. </span><span id="t1y_39" class="t s6_39" data-mappings='[[27,"fi"]]'>The JALR instruction was deﬁned to enable a two-instruction sequence to </span>
<span id="t1z_39" class="t s6_39" data-mappings='[[72,"fi"]]'>jump anywhere in a 32-bit absolute address range. A LUI instruction can ﬁrst load </span><span id="t20_39" class="t s7_39">rs1 </span><span id="t21_39" class="t s6_39">with the </span>
<span id="t22_39" class="t s6_39">upper 20 bits of a target address, then JALR can add in the lower bits. Similarly, AUIPC then </span>
<span id="t23_39" class="t s6_39">JALR can jump anywhere in a 32-bit </span><span id="t24_39" class="t s8_39">pc</span><span id="t25_39" class="t s6_39">-relative address range. </span>
<span id="t26_39" class="t s6_39">Note that the JALR instruction does not treat the 12-bit immediate as multiples of 2 bytes, </span>
<span id="t27_39" class="t s6_39">unlike the conditional branch instructions. This avoids one more immediate format in hardware. </span>
<span id="t28_39" class="t s6_39">In practice, most uses of JALR will have either a zero immediate or be paired with a LUI or </span>
<span id="t29_39" class="t s6_39" data-mappings='[[52,"fi"]]'>AUIPC, so the slight reduction in range is not signiﬁcant. </span>
<span id="t2a_39" class="t s6_39" data-mappings='[[24,"fi"],[86,"fi"]]'>Clearing the least-signiﬁcant bit when calculating the JALR target address both simpliﬁes </span>
<span id="t2b_39" class="t s6_39">the hardware slightly and allows the low bit of function pointers to be used to store auxiliary </span>
<span id="t2c_39" class="t s6_39">information. Although there is potentially a slight loss of error checking in this case, in practice </span>
<span id="t2d_39" class="t s6_39">jumps to an incorrect instruction address will usually quickly raise an exception. </span>
<span id="t2e_39" class="t s6_39">When used with a base </span><span id="t2f_39" class="t s7_39">rs1=</span><span id="t2g_39" class="t s8_39">x0</span><span id="t2h_39" class="t s6_39">, JALR can be used to implement a single instruction subrou- </span>
<span id="t2i_39" class="t s6_39">tine call to the lowest 2KiB or highest 2KiB address region from anywhere in the address space, </span>
<span id="t2j_39" class="t s6_39">which could be used to implement fast calls to a small runtime library. Alternatively, an ABI </span>
<span id="t2k_39" class="t s6_39">could dedicate a general-purpose register to point to a library elsewhere in the address space. </span>
<span id="t2l_39" class="t s2_39">The JAL and JALR instructions will generate an instruction-address-misaligned exception if the </span>
<span id="t2m_39" class="t s2_39">target address is not aligned to a four-byte boundary. </span>
<span id="t2n_39" class="t s6_39">Instruction-address-misaligned exceptions are not possible on machines that support extensions </span>
<span id="t2o_39" class="t s6_39">with 16-bit aligned instructions, such as the compressed instruction-set extension, C. </span>
<span id="t2p_39" class="t s2_39">Return-address prediction stacks are a common feature of high-performance instruction-fetch units, </span>
<span id="t2q_39" class="t s2_39" data-mappings='[[91,"ff"]]'>but require accurate detection of instructions used for procedure calls and returns to be eﬀective. </span>
<span id="t2r_39" class="t s2_39">For RISC-V, hints as to the instructions’ usage are encoded implicitly via the register numbers </span>
<span id="t2s_39" class="t s2_39">used. A JAL instruction should push the return address onto a return-address stack (RAS) only </span>
<span id="t2t_39" class="t s2_39">when </span><span id="t2u_39" class="t s3_39">rd</span><span id="t2v_39" class="t s2_39">=</span><span id="t2w_39" class="t s4_39">x1</span><span id="t2x_39" class="t s2_39">/</span><span id="t2y_39" class="t s4_39">x5</span><span id="t2z_39" class="t s2_39">. JALR instructions should push/pop a RAS as shown in the Table </span><span id="t30_39" class="t s9_39">2.1</span><span id="t31_39" class="t s2_39">. </span>
<span id="t32_39" class="t s6_39">Some other ISAs added explicit hint bits to their indirect-jump instructions to guide return- </span>
<span id="t33_39" class="t s6_39">address stack manipulation. </span><span id="t34_39" class="t s6_39">We use implicit hinting tied to register numbers and the calling </span>
<span id="t35_39" class="t s6_39">convention to reduce the encoding space used for these hints. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
