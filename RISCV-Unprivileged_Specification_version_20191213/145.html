<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p145" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_145{left:110px;bottom:946px;letter-spacing:-0.24px;word-spacing:3.95px;}
#t2_145{left:110px;bottom:852px;letter-spacing:-0.2px;word-spacing:5.01px;}
#t3_145{left:110px;bottom:806px;letter-spacing:-0.07px;word-spacing:4.73px;}
#t4_145{left:110px;bottom:719px;letter-spacing:-0.21px;word-spacing:1.22px;}
#t5_145{left:110px;bottom:698px;letter-spacing:-0.23px;word-spacing:1.65px;}
#t6_145{left:791px;bottom:698px;letter-spacing:-0.15px;}
#t7_145{left:820px;bottom:698px;}
#t8_145{left:152px;bottom:654px;letter-spacing:0.06px;word-spacing:2.67px;}
#t9_145{left:152px;bottom:636px;letter-spacing:0.02px;word-spacing:1.21px;}
#ta_145{left:152px;bottom:617px;letter-spacing:-0.01px;word-spacing:1.85px;}
#tb_145{left:110px;bottom:581px;letter-spacing:-0.32px;word-spacing:1.69px;}
#tc_145{left:135px;bottom:526px;}
#td_145{left:152px;bottom:526px;letter-spacing:-0.17px;word-spacing:1.43px;}
#te_145{left:135px;bottom:492px;}
#tf_145{left:152px;bottom:492px;letter-spacing:-0.17px;word-spacing:1.43px;}
#tg_145{left:135px;bottom:458px;}
#th_145{left:152px;bottom:458px;letter-spacing:-0.19px;word-spacing:1.46px;}
#ti_145{left:152px;bottom:395px;letter-spacing:0.07px;word-spacing:0.88px;}
#tj_145{left:417px;bottom:395px;}
#tk_145{left:425px;bottom:395px;}
#tl_145{left:433px;bottom:395px;}
#tm_145{left:445px;bottom:395px;letter-spacing:0.01px;word-spacing:1.35px;}
#tn_145{left:152px;bottom:377px;letter-spacing:0.06px;word-spacing:1.18px;}
#to_145{left:152px;bottom:358px;letter-spacing:-0.09px;word-spacing:2.02px;}
#tp_145{left:177px;bottom:340px;letter-spacing:-0.02px;word-spacing:1.8px;}
#tq_145{left:152px;bottom:322px;letter-spacing:0.03px;word-spacing:2.32px;}
#tr_145{left:469px;bottom:322px;}
#ts_145{left:477px;bottom:322px;}
#tt_145{left:485px;bottom:322px;}
#tu_145{left:492px;bottom:322px;letter-spacing:0.03px;word-spacing:2.6px;}
#tv_145{left:152px;bottom:303px;letter-spacing:-0.14px;word-spacing:1.62px;}
#tw_145{left:278px;bottom:303px;letter-spacing:0.04px;word-spacing:1.22px;}
#tx_145{left:152px;bottom:285px;letter-spacing:-0.07px;word-spacing:1.6px;}
#ty_145{left:152px;bottom:267px;letter-spacing:0.09px;word-spacing:1.64px;}
#tz_145{left:110px;bottom:230px;letter-spacing:-0.17px;word-spacing:1.42px;}
#t10_145{left:110px;bottom:210px;letter-spacing:-0.15px;word-spacing:0.38px;}
#t11_145{left:110px;bottom:189px;letter-spacing:-0.2px;word-spacing:2.63px;}
#t12_145{left:110px;bottom:168px;letter-spacing:-0.15px;word-spacing:1.39px;}
#t13_145{left:455px;bottom:67px;letter-spacing:-0.17px;}

.s1_145{font-size:32px;font-family:CMBX12_26j;color:#000;}
.s2_145{font-size:38px;font-family:CMBX12_26j;color:#000;}
.s3_145{font-size:17px;font-family:CMR10_270;color:#000;}
.s4_145{font-size:17px;font-family:CMR10_270;color:#000080;}
.s5_145{font-size:15px;font-family:CMTI10_27t;color:#000;}
.s6_145{font-size:17px;font-family:CMSY10_27j;color:#000;}
.s7_145{font-size:15px;font-family:CMTI10_27t;color:#000080;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts145" type="text/css" >

@font-face {
	font-family: CMBX12_26j;
	src: url("fonts/CMBX12_26j.woff") format("woff");
}

@font-face {
	font-family: CMR10_270;
	src: url("fonts/CMR10_270.woff") format("woff");
}

@font-face {
	font-family: CMSY10_27j;
	src: url("fonts/CMSY10_27j.woff") format("woff");
}

@font-face {
	font-family: CMTI10_27t;
	src: url("fonts/CMTI10_27t.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg145Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg145" style="-webkit-user-select: none;"><object width="935" height="1210" data="145/145.svg" type="image/svg+xml" id="pdf145" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_145" class="t s1_145">Chapter 23 </span>
<span id="t2_145" class="t s2_145">“Ztso” Standard Extension for Total </span>
<span id="t3_145" class="t s2_145">Store Ordering, v0.1 </span>
<span id="t4_145" class="t s3_145" data-mappings='[[15,"fi"]]'>This chapter deﬁnes the “Ztso” extension for the RISC-V Total Store Ordering (RVTSO) memory </span>
<span id="t5_145" class="t s3_145" data-mappings='[[30,"fi"],[69,"fi"]]'>consistency model. RVTSO is deﬁned as a delta from RVWMO, which is deﬁned in Chapter </span><span id="t6_145" class="t s4_145">14.1</span><span id="t7_145" class="t s3_145">. </span>
<span id="t8_145" class="t s5_145">The Ztso extension is meant to facilitate the porting of code originally written for the x86 or </span>
<span id="t9_145" class="t s5_145">SPARC architectures, both of which use TSO by default. It also supports implementations which </span>
<span id="ta_145" class="t s5_145">inherently provide RVTSO behavior and want to expose that fact to software. </span>
<span id="tb_145" class="t s3_145">RVTSO makes the following adjustments to RVWMO: </span>
<span id="tc_145" class="t s6_145">• </span><span id="td_145" class="t s3_145">All load operations behave as if they have an acquire-RCpc annotation </span>
<span id="te_145" class="t s6_145">• </span><span id="tf_145" class="t s3_145">All store operations behave as if they have a release-RCpc annotation. </span>
<span id="tg_145" class="t s6_145">• </span><span id="th_145" class="t s3_145">All AMOs behave as if they have both acquire-RCsc and release-RCsc annotations. </span>
<span id="ti_145" class="t s5_145">These rules render all PPO rules except </span><span id="tj_145" class="t s7_145">4</span><span id="tk_145" class="t s5_145">–</span><span id="tl_145" class="t s7_145">7 </span><span id="tm_145" class="t s5_145">redundant. They also make redundant any non-I/O </span>
<span id="tn_145" class="t s5_145">fences that do not have both PW and SR set. Finally, they also imply that no memory operation </span>
<span id="to_145" class="t s5_145">will be reordered past an AMO in either direction. </span>
<span id="tp_145" class="t s5_145">In the context of RVTSO, as is the case for RVWMO, the storage ordering annotations are </span>
<span id="tq_145" class="t s5_145" data-mappings='[[27,"fi"]]'>concisely and completely deﬁned by PPO rules </span><span id="tr_145" class="t s7_145">5</span><span id="ts_145" class="t s5_145">–</span><span id="tt_145" class="t s7_145">7</span><span id="tu_145" class="t s5_145">. In both of these memory models, it is the </span>
<span id="tv_145" class="t s7_145">Load Value Axiom </span><span id="tw_145" class="t s5_145" data-mappings='[[55,"ff"]]'>that allows a hart to forward a value from its store buﬀer to a subsequent (in </span>
<span id="tx_145" class="t s5_145">program order) load—that is to say that stores can be forwarded locally before they are visible to </span>
<span id="ty_145" class="t s5_145">other harts. </span>
<span id="tz_145" class="t s3_145">In spite of the fact that Ztso adds no new instructions to the ISA, code written assuming RVTSO </span>
<span id="t10_145" class="t s3_145">will not run correctly on implementations not supporting Ztso. Binaries compiled to run only under </span>
<span id="t11_145" class="t s3_145" data-mappings='[[35,"fl"]]'>Ztso should indicate as such via a ﬂag in the binary, so that platforms which do not implement </span>
<span id="t12_145" class="t s3_145">Ztso can simply refuse to run them. </span>
<span id="t13_145" class="t s3_145">127 </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
