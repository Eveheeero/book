<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p317" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_317{left:789px;bottom:68px;letter-spacing:0.08px;word-spacing:0.01px;}
#t2_317{left:827px;bottom:68px;letter-spacing:0.1px;}
#t3_317{left:712px;bottom:1076px;letter-spacing:0.26px;word-spacing:0.56px;}
#t4_317{left:290px;bottom:1051px;letter-spacing:0.24px;word-spacing:0.59px;}
#t5_317{left:69px;bottom:996px;letter-spacing:-0.16px;word-spacing:-0.45px;}
#t6_317{left:69px;bottom:979px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t7_317{left:69px;bottom:962px;letter-spacing:-0.15px;word-spacing:-0.51px;}
#t8_317{left:267px;bottom:962px;letter-spacing:-0.15px;word-spacing:-0.48px;}
#t9_317{left:339px;bottom:962px;letter-spacing:-0.14px;word-spacing:-0.51px;}
#ta_317{left:755px;bottom:962px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#tb_317{left:827px;bottom:962px;letter-spacing:-0.05px;}
#tc_317{left:69px;bottom:938px;letter-spacing:-0.13px;}
#td_317{left:99px;bottom:938px;letter-spacing:-0.16px;word-spacing:-0.47px;}
#te_317{left:242px;bottom:938px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#tf_317{left:69px;bottom:921px;letter-spacing:-0.19px;word-spacing:-0.42px;}
#tg_317{left:69px;bottom:904px;letter-spacing:-0.16px;word-spacing:-0.91px;}
#th_317{left:69px;bottom:888px;letter-spacing:-0.22px;word-spacing:-0.42px;}
#ti_317{left:69px;bottom:871px;letter-spacing:-0.19px;word-spacing:-1.29px;}
#tj_317{left:744px;bottom:871px;letter-spacing:-0.12px;word-spacing:-1.38px;}
#tk_317{left:69px;bottom:854px;letter-spacing:-0.16px;word-spacing:-0.47px;}
#tl_317{left:69px;bottom:830px;letter-spacing:-0.15px;word-spacing:-0.63px;}
#tm_317{left:491px;bottom:830px;letter-spacing:-0.17px;word-spacing:-0.65px;}
#tn_317{left:628px;bottom:830px;letter-spacing:-0.14px;word-spacing:-0.61px;}
#to_317{left:69px;bottom:813px;letter-spacing:-0.14px;word-spacing:-0.42px;}
#tp_317{left:136px;bottom:813px;letter-spacing:-0.17px;word-spacing:-0.47px;}
#tq_317{left:338px;bottom:813px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#tr_317{left:69px;bottom:796px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#ts_317{left:69px;bottom:771px;letter-spacing:-0.14px;word-spacing:-0.77px;}
#tt_317{left:730px;bottom:771px;letter-spacing:-0.17px;}
#tu_317{left:69px;bottom:755px;letter-spacing:-0.15px;}
#tv_317{left:138px;bottom:755px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#tw_317{left:69px;bottom:738px;letter-spacing:-0.16px;word-spacing:-0.46px;}
#tx_317{left:69px;bottom:713px;letter-spacing:-0.15px;word-spacing:-0.69px;}
#ty_317{left:754px;bottom:713px;letter-spacing:-0.18px;word-spacing:-0.64px;}
#tz_317{left:843px;bottom:713px;}
#t10_317{left:69px;bottom:697px;letter-spacing:-0.15px;word-spacing:-0.48px;}
#t11_317{left:69px;bottom:680px;letter-spacing:-0.15px;word-spacing:-0.44px;}
#t12_317{left:69px;bottom:663px;letter-spacing:-0.16px;}
#t13_317{left:69px;bottom:639px;letter-spacing:-0.2px;word-spacing:-0.53px;}
#t14_317{left:69px;bottom:622px;letter-spacing:-0.24px;word-spacing:-0.42px;}
#t15_317{left:69px;bottom:597px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t16_317{left:69px;bottom:580px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#t17_317{left:373px;bottom:580px;letter-spacing:-0.17px;word-spacing:-0.42px;}
#t18_317{left:569px;bottom:580px;letter-spacing:-0.12px;}
#t19_317{left:69px;bottom:512px;letter-spacing:0.16px;}
#t1a_317{left:150px;bottom:512px;letter-spacing:0.21px;word-spacing:0.01px;}
#t1b_317{left:69px;bottom:487px;letter-spacing:-0.14px;word-spacing:-0.58px;}
#t1c_317{left:480px;bottom:487px;letter-spacing:-0.17px;word-spacing:-0.56px;}
#t1d_317{left:617px;bottom:487px;letter-spacing:-0.13px;word-spacing:-0.56px;}
#t1e_317{left:69px;bottom:470px;letter-spacing:-0.14px;word-spacing:-0.63px;}
#t1f_317{left:69px;bottom:454px;letter-spacing:-0.11px;word-spacing:-0.53px;}
#t1g_317{left:248px;bottom:454px;letter-spacing:-0.18px;}
#t1h_317{left:384px;bottom:454px;letter-spacing:-0.16px;word-spacing:-0.45px;}
#t1i_317{left:69px;bottom:437px;letter-spacing:-0.15px;word-spacing:-0.52px;}
#t1j_317{left:69px;bottom:412px;letter-spacing:-0.16px;word-spacing:-0.95px;}
#t1k_317{left:717px;bottom:412px;letter-spacing:-0.16px;}
#t1l_317{left:69px;bottom:396px;letter-spacing:-0.16px;}
#t1m_317{left:131px;bottom:396px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t1n_317{left:69px;bottom:379px;letter-spacing:-0.14px;word-spacing:-0.98px;}
#t1o_317{left:69px;bottom:362px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#t1p_317{left:69px;bottom:336px;}
#t1q_317{left:95px;bottom:339px;letter-spacing:-0.15px;word-spacing:-0.41px;}
#t1r_317{left:700px;bottom:339px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#t1s_317{left:772px;bottom:339px;letter-spacing:-0.11px;}
#t1t_317{left:69px;bottom:313px;}
#t1u_317{left:95px;bottom:316px;letter-spacing:-0.14px;word-spacing:-0.42px;}
#t1v_317{left:793px;bottom:316px;letter-spacing:-0.14px;}
#t1w_317{left:95px;bottom:299px;letter-spacing:-0.16px;}
#t1x_317{left:134px;bottom:299px;letter-spacing:-0.11px;}
#t1y_317{left:69px;bottom:273px;}
#t1z_317{left:95px;bottom:276px;letter-spacing:-0.14px;word-spacing:-0.41px;}
#t20_317{left:755px;bottom:283px;}
#t21_317{left:771px;bottom:276px;letter-spacing:-0.17px;}
#t22_317{left:95px;bottom:260px;letter-spacing:-0.18px;word-spacing:-0.42px;}
#t23_317{left:228px;bottom:260px;letter-spacing:-0.16px;word-spacing:-0.47px;}
#t24_317{left:303px;bottom:260px;letter-spacing:-0.11px;}
#t25_317{left:69px;bottom:233px;}
#t26_317{left:95px;bottom:237px;letter-spacing:-0.14px;word-spacing:-0.59px;}
#t27_317{left:778px;bottom:243px;}
#t28_317{left:793px;bottom:237px;letter-spacing:-0.15px;}
#t29_317{left:95px;bottom:220px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t2a_317{left:254px;bottom:220px;letter-spacing:-0.16px;word-spacing:-0.48px;}
#t2b_317{left:330px;bottom:220px;letter-spacing:-0.12px;}
#t2c_317{left:95px;bottom:195px;}
#t2d_317{left:121px;bottom:195px;letter-spacing:-0.14px;word-spacing:-0.43px;}
#t2e_317{left:643px;bottom:195px;letter-spacing:-0.17px;word-spacing:-0.47px;}
#t2f_317{left:760px;bottom:195px;letter-spacing:-0.11px;}
#t2g_317{left:95px;bottom:171px;}
#t2h_317{left:121px;bottom:171px;letter-spacing:-0.15px;word-spacing:-0.41px;}
#t2i_317{left:121px;bottom:154px;letter-spacing:-0.21px;word-spacing:-0.41px;}
#t2j_317{left:353px;bottom:154px;letter-spacing:-0.17px;word-spacing:-0.47px;}
#t2k_317{left:460px;bottom:154px;letter-spacing:-0.11px;}
#t2l_317{left:69px;bottom:128px;}
#t2m_317{left:95px;bottom:131px;letter-spacing:-0.14px;word-spacing:-0.43px;}
#t2n_317{left:792px;bottom:138px;}
#t2o_317{left:95px;bottom:114px;letter-spacing:-0.18px;word-spacing:-0.43px;}
#t2p_317{left:329px;bottom:114px;letter-spacing:-0.17px;word-spacing:-0.47px;}
#t2q_317{left:440px;bottom:114px;letter-spacing:-0.12px;}

.s1_317{font-size:12px;font-family:NeoSansIntel_pgv;color:#000;}
.s2_317{font-size:24px;font-family:NeoSansIntelMedium_pgu;color:#0860A8;}
.s3_317{font-size:14px;font-family:Verdana_13-;color:#000;}
.s4_317{font-size:14px;font-family:Verdana-Bold_pgt;color:#000;}
.s5_317{font-size:21px;font-family:NeoSansIntelMedium_pgu;color:#0860A8;}
.s6_317{font-size:21px;font-family:TimesNewRoman_143;color:#000;}
.s7_317{font-size:11px;font-family:Verdana_13-;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts317" type="text/css" >

@font-face {
	font-family: NeoSansIntelMedium_pgu;
	src: url("fonts/NeoSansIntelMedium_pgu.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_pgv;
	src: url("fonts/NeoSansIntel_pgv.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_143;
	src: url("fonts/TimesNewRoman_143.woff") format("woff");
}

@font-face {
	font-family: Verdana-Bold_pgt;
	src: url("fonts/Verdana-Bold_pgt.woff") format("woff");
}

@font-face {
	font-family: Verdana_13-;
	src: url("fonts/Verdana_13-.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg317Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg317" style="-webkit-user-select: none;"><object width="935" height="1210" data="317/317.svg" type="image/svg+xml" id="pdf317" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_317" class="t s1_317">Vol. 1 </span><span id="t2_317" class="t s1_317">13-1 </span>
<span id="t3_317" class="t s2_317">CHAPTER 13 </span>
<span id="t4_317" class="t s2_317">MANAGING STATE USING THE XSAVE FEATURE SET </span>
<span id="t5_317" class="t s3_317">The XSAVE feature set extends the functionality of the FXSAVE and FXRSTOR instructions (see Section 10.5, </span>
<span id="t6_317" class="t s3_317">“FXSAVE and FXRSTOR Instructions”) by supporting the saving and restoring of processor state in addition to the </span>
<span id="t7_317" class="t s3_317">x87 execution environment (</span><span id="t8_317" class="t s4_317">x87 state</span><span id="t9_317" class="t s3_317">) and the registers used by the streaming SIMD extensions (</span><span id="ta_317" class="t s4_317">SSE state</span><span id="tb_317" class="t s3_317">). </span>
<span id="tc_317" class="t s3_317">The </span><span id="td_317" class="t s4_317">XSAVE feature set </span><span id="te_317" class="t s3_317">comprises eight instructions. XGETBV and XSETBV allow software to read and write the </span>
<span id="tf_317" class="t s3_317">extended control register XCR0, which controls the operation of the XSAVE feature set. XSAVE, XSAVEOPT, </span>
<span id="tg_317" class="t s3_317">XSAVEC, and XSAVES are four instructions that save processor state to memory; XRSTOR and XRSTORS are corre- </span>
<span id="th_317" class="t s3_317">sponding instructions that load processor state from memory. XGETBV, XSAVE, XSAVEOPT, XSAVEC, and XRSTOR </span>
<span id="ti_317" class="t s3_317">can be executed at any privilege level; XSETBV, XSAVES, and XRSTORS can be executed only if CPL </span><span id="tj_317" class="t s3_317">= 0. In addition </span>
<span id="tk_317" class="t s3_317">to XCR0, the XSAVES and XRSTORS instructions are controlled also by the IA32_XSS MSR (index DA0H). </span>
<span id="tl_317" class="t s3_317">The XSAVE feature set organizes the state that manages into </span><span id="tm_317" class="t s4_317">state components</span><span id="tn_317" class="t s3_317">. Operation of the instructions is </span>
<span id="to_317" class="t s3_317">based on </span><span id="tp_317" class="t s4_317">state-component bitmaps </span><span id="tq_317" class="t s3_317">that have the same format as XCR0 and as the IA32_XSS MSR: each bit </span>
<span id="tr_317" class="t s3_317">corresponds to a state component. Section 13.1 discusses these state components and bitmaps in more detail. </span>
<span id="ts_317" class="t s3_317">Section 13.2 describes how the processor enumerates support for the XSAVE feature set and for </span><span id="tt_317" class="t s4_317">XSAVE-enabled </span>
<span id="tu_317" class="t s4_317">features </span><span id="tv_317" class="t s3_317">(those features that require use of the XSAVE feature set for their enabling). Section 13.3 explains how </span>
<span id="tw_317" class="t s3_317">software can enable the XSAVE feature set and XSAVE-enabled features. </span>
<span id="tx_317" class="t s3_317">The XSAVE feature set allows saving and loading processor state from a region of memory called an </span><span id="ty_317" class="t s4_317">XSAVE area</span><span id="tz_317" class="t s3_317">. </span>
<span id="t10_317" class="t s3_317">Section 13.4 presents details of the XSAVE area and its organization. Each XSAVE-managed state component is </span>
<span id="t11_317" class="t s3_317">associated with a section of the XSAVE area. Section 13.5 describes in detail each of the XSAVE-managed state </span>
<span id="t12_317" class="t s3_317">components. </span>
<span id="t13_317" class="t s3_317">Section 13.7 through Section 13.12 describe the operation of XSAVE, XRSTOR, XSAVEOPT, XSAVEC, XSAVES, and </span>
<span id="t14_317" class="t s3_317">XRSTORS, respectively. </span>
<span id="t15_317" class="t s3_317">Section 13.13 provides some details about memory accesses performed by instructions in the XSAVE feature set, </span>
<span id="t16_317" class="t s3_317">and Section 13.14 describes a facility called </span><span id="t17_317" class="t s4_317">extended feature disable </span><span id="t18_317" class="t s3_317">(XFD). </span>
<span id="t19_317" class="t s5_317">13.1 </span><span id="t1a_317" class="t s5_317">XSAVE-SUPPORTED FEATURES AND STATE-COMPONENT BITMAPS </span>
<span id="t1b_317" class="t s3_317">The XSAVE feature set supports the saving and restoring of </span><span id="t1c_317" class="t s4_317">state components</span><span id="t1d_317" class="t s3_317">, each of which is a discrete set of </span>
<span id="t1e_317" class="t s3_317">processor registers (or parts of registers). In general, each such state component corresponds to a particular CPU </span>
<span id="t1f_317" class="t s3_317">feature. Such a feature is </span><span id="t1g_317" class="t s4_317">XSAVE-supported</span><span id="t1h_317" class="t s3_317">. Some XSAVE-supported features use registers in multiple XSAVE- </span>
<span id="t1i_317" class="t s3_317">managed state components. </span>
<span id="t1j_317" class="t s3_317">The XSAVE feature set organizes the state components of the XSAVE-supported features using </span><span id="t1k_317" class="t s4_317">state-component </span>
<span id="t1l_317" class="t s4_317">bitmaps</span><span id="t1m_317" class="t s3_317">. A state-component bitmap comprises 64 bits; each bit in such a bitmap corresponds to a single state </span>
<span id="t1n_317" class="t s3_317">component. The following bits are defined in state-component bitmaps (details on individual state components are </span>
<span id="t1o_317" class="t s3_317">provided in subsections of Section 13.5): </span>
<span id="t1p_317" class="t s6_317">• </span><span id="t1q_317" class="t s3_317">Bit 0 corresponds to the state component used for the x87 FPU execution environment (</span><span id="t1r_317" class="t s4_317">x87 state</span><span id="t1s_317" class="t s3_317">). </span>
<span id="t1t_317" class="t s6_317">• </span><span id="t1u_317" class="t s3_317">Bit 1 corresponds to the state component used for registers used by the streaming SIMD extensions (</span><span id="t1v_317" class="t s4_317">SSE </span>
<span id="t1w_317" class="t s4_317">state</span><span id="t1x_317" class="t s3_317">). </span>
<span id="t1y_317" class="t s6_317">• </span><span id="t1z_317" class="t s3_317">Bit 2 corresponds to the state component used for the additional register state used by the Intel </span>
<span id="t20_317" class="t s7_317">® </span>
<span id="t21_317" class="t s3_317">Advanced </span>
<span id="t22_317" class="t s3_317">Vector Extensions (</span><span id="t23_317" class="t s4_317">AVX state</span><span id="t24_317" class="t s3_317">). </span>
<span id="t25_317" class="t s6_317">• </span><span id="t26_317" class="t s3_317">Bits 4:3 correspond to the two state components used for the additional register state used by Intel </span>
<span id="t27_317" class="t s7_317">® </span>
<span id="t28_317" class="t s3_317">Memory </span>
<span id="t29_317" class="t s3_317">Protection Extensions (</span><span id="t2a_317" class="t s4_317">MPX state</span><span id="t2b_317" class="t s3_317">): </span>
<span id="t2c_317" class="t s3_317">— </span><span id="t2d_317" class="t s3_317">State component 3 is used for the 4 128-bit bounds registers BND0–BND3 (</span><span id="t2e_317" class="t s4_317">BNDREGS state</span><span id="t2f_317" class="t s3_317">). </span>
<span id="t2g_317" class="t s3_317">— </span><span id="t2h_317" class="t s3_317">State component 4 is used for the 64-bit user-mode MPX configuration register BNDCFGU and the 64-bit </span>
<span id="t2i_317" class="t s3_317">MPX status register BNDSTATUS (</span><span id="t2j_317" class="t s4_317">BNDCSR state</span><span id="t2k_317" class="t s3_317">). </span>
<span id="t2l_317" class="t s6_317">• </span><span id="t2m_317" class="t s3_317">Bits 7:5 correspond to the three state components used for the additional register state used by Intel </span>
<span id="t2n_317" class="t s7_317">® </span>
<span id="t2o_317" class="t s3_317">Advanced Vector Extensions 512 (</span><span id="t2p_317" class="t s4_317">AVX-512 state</span><span id="t2q_317" class="t s3_317">): </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
