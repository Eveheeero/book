<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p956" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_956{left:96px;bottom:48px;letter-spacing:-0.15px;}
#t2_956{left:666px;bottom:48px;letter-spacing:-0.12px;word-spacing:0.03px;}
#t3_956{left:96px;bottom:1116px;letter-spacing:-0.17px;word-spacing:0.06px;}
#t4_956{left:601px;bottom:1116px;letter-spacing:-0.17px;word-spacing:2.71px;}
#t5_956{left:96px;bottom:1038px;letter-spacing:0.12px;word-spacing:-0.81px;}
#t6_956{left:96px;bottom:1017px;letter-spacing:0.13px;word-spacing:-0.41px;}
#t7_956{left:96px;bottom:982px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t8_956{left:96px;bottom:960px;letter-spacing:0.13px;word-spacing:-0.46px;}
#t9_956{left:96px;bottom:939px;letter-spacing:0.13px;word-spacing:-0.43px;}
#ta_956{left:96px;bottom:904px;letter-spacing:0.14px;word-spacing:-0.47px;}
#tb_956{left:96px;bottom:882px;letter-spacing:0.11px;word-spacing:-0.94px;}
#tc_956{left:96px;bottom:861px;letter-spacing:0.12px;word-spacing:-1.01px;}
#td_956{left:96px;bottom:840px;letter-spacing:0.1px;word-spacing:-0.47px;}
#te_956{left:96px;bottom:818px;letter-spacing:0.12px;word-spacing:-0.4px;}
#tf_956{left:96px;bottom:782px;letter-spacing:-0.1px;word-spacing:0.01px;}
#tg_956{left:253px;bottom:781px;letter-spacing:0.1px;word-spacing:-0.5px;}
#th_956{left:96px;bottom:760px;letter-spacing:0.12px;word-spacing:-0.45px;}
#ti_956{left:96px;bottom:729px;}
#tj_956{left:124px;bottom:729px;letter-spacing:0.14px;word-spacing:2.52px;}
#tk_956{left:124px;bottom:708px;letter-spacing:0.13px;word-spacing:-0.44px;}
#tl_956{left:96px;bottom:680px;}
#tm_956{left:124px;bottom:680px;letter-spacing:0.15px;word-spacing:-0.49px;}
#tn_956{left:96px;bottom:653px;}
#to_956{left:124px;bottom:653px;letter-spacing:0.14px;word-spacing:-0.44px;}
#tp_956{left:96px;bottom:625px;}
#tq_956{left:124px;bottom:625px;letter-spacing:0.15px;word-spacing:-0.46px;}
#tr_956{left:96px;bottom:598px;}
#ts_956{left:124px;bottom:598px;letter-spacing:0.15px;word-spacing:-0.48px;}
#tt_956{left:96px;bottom:570px;}
#tu_956{left:124px;bottom:570px;letter-spacing:0.11px;word-spacing:-0.42px;}
#tv_956{left:96px;bottom:535px;letter-spacing:0.13px;word-spacing:-0.45px;}
#tw_956{left:96px;bottom:514px;letter-spacing:0.05px;word-spacing:-0.36px;}
#tx_956{left:96px;bottom:492px;letter-spacing:0.13px;word-spacing:-0.47px;}
#ty_956{left:96px;bottom:471px;letter-spacing:0.12px;word-spacing:-0.46px;}
#tz_956{left:96px;bottom:450px;letter-spacing:0.13px;word-spacing:-0.46px;}
#t10_956{left:96px;bottom:413px;letter-spacing:-0.1px;word-spacing:0.01px;}
#t11_956{left:273px;bottom:412px;letter-spacing:0.13px;word-spacing:-0.48px;}
#t12_956{left:96px;bottom:391px;letter-spacing:0.19px;}
#t13_956{left:96px;bottom:360px;}
#t14_956{left:124px;bottom:360px;letter-spacing:0.14px;word-spacing:1.13px;}
#t15_956{left:124px;bottom:339px;letter-spacing:0.14px;word-spacing:-0.55px;}
#t16_956{left:96px;bottom:312px;}
#t17_956{left:124px;bottom:312px;letter-spacing:0.18px;word-spacing:-0.41px;}
#t18_956{left:96px;bottom:284px;}
#t19_956{left:124px;bottom:284px;letter-spacing:0.11px;word-spacing:-0.43px;}
#t1a_956{left:96px;bottom:257px;}
#t1b_956{left:124px;bottom:257px;letter-spacing:0.13px;word-spacing:0.21px;}
#t1c_956{left:124px;bottom:235px;letter-spacing:0.16px;word-spacing:-0.45px;}
#t1d_956{left:234px;bottom:235px;letter-spacing:0.14px;}
#t1e_956{left:261px;bottom:235px;letter-spacing:0.13px;word-spacing:-0.42px;}
#t1f_956{left:96px;bottom:208px;}
#t1g_956{left:124px;bottom:208px;letter-spacing:0.15px;word-spacing:4.13px;}
#t1h_956{left:124px;bottom:186px;letter-spacing:0.13px;word-spacing:-0.31px;}
#t1i_956{left:96px;bottom:159px;}
#t1j_956{left:124px;bottom:159px;letter-spacing:0.16px;word-spacing:-0.43px;}
#t1k_956{left:96px;bottom:131px;}
#t1l_956{left:124px;bottom:131px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t1m_956{left:396px;bottom:12px;letter-spacing:0.16px;}

.s1_956{font-size:17px;font-family:Arial-BoldItalic_623;color:#000;}
.s2_956{font-size:17px;font-family:Arial-Italic_62c;color:#000;}
.s3_956{font-size:18px;font-family:TimesNewRoman_61y;color:#000;}
.s4_956{font-size:17px;font-family:Arial-Bold_61q;color:#000;}
.s5_956{font-size:18px;font-family:TimesNewRoman-Bold_61v;color:#000;}
.s6_956{font-size:18px;font-family:TimesNewRoman-Italic_626;color:#000;}
.s7_956{font-size:18px;font-family:Arial_62w;color:#00AB00;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts956" type="text/css" >

@font-face {
	font-family: Arial-BoldItalic_623;
	src: url("fonts/Arial-BoldItalic_623.woff") format("woff");
}

@font-face {
	font-family: Arial-Bold_61q;
	src: url("fonts/Arial-Bold_61q.woff") format("woff");
}

@font-face {
	font-family: Arial-Italic_62c;
	src: url("fonts/Arial-Italic_62c.woff") format("woff");
}

@font-face {
	font-family: Arial_62w;
	src: url("fonts/Arial_62w.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman-Bold_61v;
	src: url("fonts/TimesNewRoman-Bold_61v.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman-Italic_626;
	src: url("fonts/TimesNewRoman-Italic_626.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_61y;
	src: url("fonts/TimesNewRoman_61y.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg956Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg956" style="-webkit-user-select: none;"><object width="935" height="1210" data="956/956.svg" type="image/svg+xml" id="pdf956" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_956" class="t s1_956">501 </span><span id="t2_956" class="t s2_956">Secure Virtual Machine </span>
<span id="t3_956" class="t s1_956">AMD64 Technology </span><span id="t4_956" class="t s1_956">24593—Rev. 3.41—June 2023 </span>
<span id="t5_956" class="t s3_956">The VMRUN instruction then checks the guest state just loaded. If an illegal state has been loaded, the </span>
<span id="t6_956" class="t s3_956">processor exits back to the host (Section 15.6). </span>
<span id="t7_956" class="t s3_956">Otherwise, the processor now runs the guest code until an intercept event occurs, at which point the </span>
<span id="t8_956" class="t s3_956">processor suspends guest execution and resumes host execution at the instruction following the </span>
<span id="t9_956" class="t s3_956">VMRUN. This is called a #VMEXIT and is described in detail in (Section 15.6). </span>
<span id="ta_956" class="t s3_956">VMRUN saves or restores a minimal amount of state information to allow the VMM to resume </span>
<span id="tb_956" class="t s3_956">execution after a guest has exited. This allows the VMM to handle simple intercept conditions quickly. </span>
<span id="tc_956" class="t s3_956">If additional guest state information must be saved or restored (e.g., to handle more complex intercepts </span>
<span id="td_956" class="t s3_956">or to switch to a different guest), the VMM must use the VMLOAD and VMSAVE instructions to </span>
<span id="te_956" class="t s3_956">handle the additional guest state (Section 15.5.2). </span>
<span id="tf_956" class="t s4_956">Saving Host State. </span><span id="tg_956" class="t s3_956">To ensure that the host can resume operation after #VMEXIT, VMRUN saves at </span>
<span id="th_956" class="t s3_956">least the following host state information: </span>
<span id="ti_956" class="t s5_956">• </span><span id="tj_956" class="t s3_956">CS.SEL, NEXT_RIP—The CS selector and rIP of the instruction following the VMRUN. On </span>
<span id="tk_956" class="t s3_956">#VMEXIT the host resumes running at this address. </span>
<span id="tl_956" class="t s5_956">• </span><span id="tm_956" class="t s3_956">RFLAGS, RAX—Host processor mode and the register used by VMRUN to address the VMCB. </span>
<span id="tn_956" class="t s5_956">• </span><span id="to_956" class="t s3_956">SS.SEL, RSP—Stack pointer for host. </span>
<span id="tp_956" class="t s5_956">• </span><span id="tq_956" class="t s3_956">CR0, CR3, CR4, EFER—Paging/operating mode for host. </span>
<span id="tr_956" class="t s5_956">• </span><span id="ts_956" class="t s3_956">IDTR, GDTR—The pseudo-descriptors. VMRUN does not save or restore the host LDTR. </span>
<span id="tt_956" class="t s5_956">• </span><span id="tu_956" class="t s3_956">ES.SEL and DS.SEL. </span>
<span id="tv_956" class="t s3_956">Processor implementations may store only part or none of host state in the memory area pointed to by </span>
<span id="tw_956" class="t s3_956">VM_HSAVE_PA MSR and may store some or all host state in hidden on-chip memory. Different </span>
<span id="tx_956" class="t s3_956">implementations may choose to save the hidden parts of the host’s segment registers as well as the </span>
<span id="ty_956" class="t s3_956">selectors. For these reasons, software must not rely on the format or contents of the host state save </span>
<span id="tz_956" class="t s3_956">area, nor attempt to change host state by modifying the contents of the host save area. </span>
<span id="t10_956" class="t s4_956">Loading Guest State. </span><span id="t11_956" class="t s3_956">After saving host state, VMRUN loads the following guest state from the </span>
<span id="t12_956" class="t s3_956">VMCB: </span>
<span id="t13_956" class="t s5_956">• </span><span id="t14_956" class="t s3_956">CS, rIP—Guest begins execution at this address. The hidden state of the CS segment register is </span>
<span id="t15_956" class="t s3_956">also loaded from the VMCB. </span>
<span id="t16_956" class="t s5_956">• </span><span id="t17_956" class="t s3_956">RFLAGS, RAX. </span>
<span id="t18_956" class="t s5_956">• </span><span id="t19_956" class="t s3_956">SS, RSP—Includes the hidden state of the SS segment register. </span>
<span id="t1a_956" class="t s5_956">• </span><span id="t1b_956" class="t s3_956">CR0, CR2, CR3, CR4, EFER—Guest paging mode. Writing paging-related control registers with </span>
<span id="t1c_956" class="t s3_956">VMRUN does </span><span id="t1d_956" class="t s6_956">not </span><span id="t1e_956" class="t s3_956">flush the TLB since address spaces are switched. (Section 15.16.) </span>
<span id="t1f_956" class="t s5_956">• </span><span id="t1g_956" class="t s3_956">INTERRUPT_SHADOW—This flag indicates whether the guest is currently in an interrupt </span>
<span id="t1h_956" class="t s3_956">lockout shadow; (Section 15.21.5). </span>
<span id="t1i_956" class="t s5_956">• </span><span id="t1j_956" class="t s3_956">IDTR, GDTR. </span>
<span id="t1k_956" class="t s5_956">• </span><span id="t1l_956" class="t s3_956">ES and DS—Includes the hidden state of the segment registers. </span>
<span id="t1m_956" class="t s7_956">[AMD Public Use] </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
