<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p862" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_862{left:96px;bottom:48px;letter-spacing:-0.15px;}
#t2_862{left:500px;bottom:48px;letter-spacing:-0.11px;word-spacing:0.01px;}
#t3_862{left:96px;bottom:1116px;letter-spacing:-0.17px;word-spacing:0.06px;}
#t4_862{left:601px;bottom:1116px;letter-spacing:-0.17px;word-spacing:2.71px;}
#t5_862{left:96px;bottom:1038px;letter-spacing:0.11px;word-spacing:-0.79px;}
#t6_862{left:813px;bottom:1038px;letter-spacing:0.1px;}
#t7_862{left:96px;bottom:1017px;letter-spacing:0.12px;word-spacing:-0.82px;}
#t8_862{left:96px;bottom:996px;letter-spacing:0.11px;}
#t9_862{left:96px;bottom:949px;letter-spacing:0.14px;}
#ta_862{left:168px;bottom:949px;letter-spacing:0.19px;word-spacing:0.01px;}
#tb_862{left:96px;bottom:913px;letter-spacing:0.11px;word-spacing:-0.46px;}
#tc_862{left:96px;bottom:892px;letter-spacing:0.12px;word-spacing:-0.45px;}
#td_862{left:96px;bottom:870px;letter-spacing:0.1px;word-spacing:-0.5px;}
#te_862{left:620px;bottom:870px;letter-spacing:0.13px;}
#tf_862{left:659px;bottom:870px;letter-spacing:0.12px;}
#tg_862{left:685px;bottom:870px;}
#th_862{left:732px;bottom:870px;letter-spacing:0.09px;word-spacing:-0.48px;}
#ti_862{left:96px;bottom:849px;letter-spacing:0.12px;word-spacing:-0.46px;}
#tj_862{left:96px;bottom:827px;letter-spacing:0.13px;word-spacing:-0.49px;}
#tk_862{left:96px;bottom:806px;letter-spacing:0.11px;word-spacing:-0.42px;}
#tl_862{left:426px;bottom:806px;letter-spacing:0.01px;}
#tm_862{left:476px;bottom:806px;letter-spacing:0.12px;word-spacing:-0.47px;}
#tn_862{left:96px;bottom:785px;letter-spacing:0.1px;word-spacing:-0.42px;}
#to_862{left:96px;bottom:750px;letter-spacing:0.13px;word-spacing:-0.45px;}
#tp_862{left:96px;bottom:728px;letter-spacing:0.11px;word-spacing:-0.47px;}
#tq_862{left:96px;bottom:707px;letter-spacing:0.13px;word-spacing:-0.72px;}
#tr_862{left:96px;bottom:685px;letter-spacing:0.13px;word-spacing:-0.47px;}
#ts_862{left:96px;bottom:664px;letter-spacing:0.11px;word-spacing:-0.45px;}
#tt_862{left:96px;bottom:629px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tu_862{left:96px;bottom:607px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tv_862{left:96px;bottom:586px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tw_862{left:96px;bottom:565px;letter-spacing:0.11px;word-spacing:-0.47px;}
#tx_862{left:96px;bottom:543px;letter-spacing:0.13px;word-spacing:-0.45px;}
#ty_862{left:96px;bottom:508px;letter-spacing:0.16px;word-spacing:-0.46px;}
#tz_862{left:159px;bottom:508px;}
#t10_862{left:169px;bottom:508px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t11_862{left:96px;bottom:487px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t12_862{left:96px;bottom:465px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t13_862{left:96px;bottom:430px;letter-spacing:0.12px;word-spacing:-0.47px;}
#t14_862{left:96px;bottom:409px;letter-spacing:0.12px;word-spacing:-0.44px;}
#t15_862{left:96px;bottom:363px;letter-spacing:0.14px;}
#t16_862{left:168px;bottom:363px;letter-spacing:0.18px;word-spacing:0.01px;}
#t17_862{left:96px;bottom:326px;letter-spacing:0.13px;word-spacing:-0.7px;}
#t18_862{left:335px;bottom:326px;}
#t19_862{left:348px;bottom:326px;letter-spacing:0.12px;word-spacing:-0.7px;}
#t1a_862{left:96px;bottom:305px;letter-spacing:0.11px;word-spacing:-0.44px;}
#t1b_862{left:96px;bottom:284px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t1c_862{left:96px;bottom:262px;letter-spacing:0.13px;word-spacing:-0.48px;}
#t1d_862{left:96px;bottom:241px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t1e_862{left:96px;bottom:206px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t1f_862{left:412px;bottom:206px;}
#t1g_862{left:425px;bottom:206px;letter-spacing:0.12px;word-spacing:-0.48px;}
#t1h_862{left:96px;bottom:184px;letter-spacing:0.12px;word-spacing:-0.44px;}
#t1i_862{left:96px;bottom:163px;letter-spacing:0.1px;word-spacing:-0.39px;}
#t1j_862{left:396px;bottom:12px;letter-spacing:0.16px;}

.s1_862{font-size:17px;font-family:Arial-BoldItalic_623;color:#000;}
.s2_862{font-size:17px;font-family:Arial-Italic_62c;color:#000;}
.s3_862{font-size:18px;font-family:TimesNewRoman_61y;color:#000;}
.s4_862{font-size:21px;font-family:Arial-Bold_61q;color:#000;}
.s5_862{font-size:18px;font-family:TimesNewRoman-Italic_626;color:#000;}
.s6_862{font-size:18px;font-family:Arial_62w;color:#00AB00;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts862" type="text/css" >

@font-face {
	font-family: Arial-BoldItalic_623;
	src: url("fonts/Arial-BoldItalic_623.woff") format("woff");
}

@font-face {
	font-family: Arial-Bold_61q;
	src: url("fonts/Arial-Bold_61q.woff") format("woff");
}

@font-face {
	font-family: Arial-Italic_62c;
	src: url("fonts/Arial-Italic_62c.woff") format("woff");
}

@font-face {
	font-family: Arial_62w;
	src: url("fonts/Arial_62w.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman-Italic_626;
	src: url("fonts/TimesNewRoman-Italic_626.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_61y;
	src: url("fonts/TimesNewRoman_61y.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg862Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg862" style="-webkit-user-select: none;"><object width="935" height="1210" data="862/862.svg" type="image/svg+xml" id="pdf862" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_862" class="t s1_862">407 </span><span id="t2_862" class="t s2_862">Software Debug and Performance Resources </span>
<span id="t3_862" class="t s1_862">AMD64 Technology </span><span id="t4_862" class="t s1_862">24593—Rev. 3.41—June 2023 </span>
<span id="t5_862" class="t s3_862">Note that implicit supervisor-level accesses do not generate a bus lock trap, even when CPL is &gt; 0. </span><span id="t6_862" class="t s3_862">An </span>
<span id="t7_862" class="t s3_862">implicit supervisor-mode access is one that is considered a supervisor access regardless of the value of </span>
<span id="t8_862" class="t s3_862">CPL. </span>
<span id="t9_862" class="t s4_862">13.1.4 </span><span id="ta_862" class="t s4_862">Single Stepping </span>
<span id="tb_862" class="t s3_862">Single-step breakpoints are enabled by setting the rFLAGS[TF] bit to 1. TF may be set by the IRET, </span>
<span id="tc_862" class="t s3_862">POPF or SYSRET instructions, with an IRET executed by a debugger being the typical use case. </span>
<span id="td_862" class="t s3_862">When IRET sets TF, it causes a #DB exception to be taken immediately </span><span id="te_862" class="t s5_862">after </span><span id="tf_862" class="t s3_862">the </span><span id="tg_862" class="t s5_862">target </span><span id="th_862" class="t s3_862">of the IRET is </span>
<span id="ti_862" class="t s3_862">executed, returning control to the debugger and thereby single-stepping the target instruction. Setting </span>
<span id="tj_862" class="t s3_862">TF with a POPF instruction also causes a one-instruction delayed #DB exception. When TF is set by </span>
<span id="tk_862" class="t s3_862">SYSRET however, a #DB exception is taken </span><span id="tl_862" class="t s5_862">before </span><span id="tm_862" class="t s3_862">the target instruction executes, hence SYSRET </span>
<span id="tn_862" class="t s3_862">does not provide the single-stepping behavior of IRET. </span>
<span id="to_862" class="t s3_862">When a #DB exception occurs due to single stepping, the processor clears rFLAGS[TF] before </span>
<span id="tp_862" class="t s3_862">entering the debug handler, so that the debug handler itself is not single stepped. The processor also </span>
<span id="tq_862" class="t s3_862">sets DR6[BS] to 1, which indicates that the #DB exception occurred as a result of single stepping. The </span>
<span id="tr_862" class="t s3_862">rFLAGS image pushed onto the debug-handler stack has the TF bit set, and single stepping resumes </span>
<span id="ts_862" class="t s3_862">when a subsequent IRET pops the stack image into the rFLAGS register. </span>
<span id="tt_862" class="t s3_862">Single-step breakpoints have a higher priority than external interrupts. If an external interrupt occurs </span>
<span id="tu_862" class="t s3_862">during single stepping, control is transferred to the #DB handler first, causing the rFLAGS[TF] bit to </span>
<span id="tv_862" class="t s3_862">be cleared. Next, before the first instruction in the debug handler is executed, the processor transfers </span>
<span id="tw_862" class="t s3_862">control to the pending-interrupt handler. This allows external interrupts to be handled outside of </span>
<span id="tx_862" class="t s3_862">single-step mode. </span>
<span id="ty_862" class="t s3_862">The INT</span><span id="tz_862" class="t s5_862">n</span><span id="t10_862" class="t s3_862">, INT3, and INTO instructions clear the rFLAGS[TF] bit when they are executed. If a </span>
<span id="t11_862" class="t s3_862">debugger is used to single-step software that contains these instructions, it must emulate them instead </span>
<span id="t12_862" class="t s3_862">of executing them. </span>
<span id="t13_862" class="t s3_862">The single-step mechanism can also be set to single step only control transfers, rather than single step </span>
<span id="t14_862" class="t s3_862">every instruction. See “Single Stepping Control Transfers” on page 409 for additional information. </span>
<span id="t15_862" class="t s4_862">13.1.5 </span><span id="t16_862" class="t s4_862">Breakpoint Instruction (INT3) </span>
<span id="t17_862" class="t s3_862">The INT3 instruction, or the INT</span><span id="t18_862" class="t s5_862">n </span><span id="t19_862" class="t s3_862">instruction with an operand of 3, can be used to set breakpoints that </span>
<span id="t1a_862" class="t s3_862">transfer control to the breakpoint-exception (#BP) handler rather than the debug-exception handler. </span>
<span id="t1b_862" class="t s3_862">When a debugger uses the breakpoint instructions to set breakpoints, it does so by replacing the first </span>
<span id="t1c_862" class="t s3_862">bytes of an instruction with the breakpoint instruction. The debugger replaces the breakpoint </span>
<span id="t1d_862" class="t s3_862">instructions with the original-instruction bytes to clear the breakpoint. </span>
<span id="t1e_862" class="t s3_862">INT3 is a single-byte instruction while INT</span><span id="t1f_862" class="t s5_862">n </span><span id="t1g_862" class="t s3_862">with an operand of 3 is a two-byte instruction. The </span>
<span id="t1h_862" class="t s3_862">instructions have slightly different effects on the breakpoint exception-handler stack. See “#BP— </span>
<span id="t1i_862" class="t s3_862">Breakpoint Exception (Vector 3)” on page 248 for additional information on this exception. </span>
<span id="t1j_862" class="t s6_862">[AMD Public Use] </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
