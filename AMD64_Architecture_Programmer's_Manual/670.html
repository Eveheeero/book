<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p670" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_670{left:96px;bottom:48px;letter-spacing:-0.15px;}
#t2_670{left:717px;bottom:48px;letter-spacing:-0.11px;word-spacing:0.01px;}
#t3_670{left:96px;bottom:1116px;letter-spacing:-0.17px;word-spacing:0.06px;}
#t4_670{left:601px;bottom:1116px;letter-spacing:-0.17px;word-spacing:2.71px;}
#t5_670{left:96px;bottom:1038px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t6_670{left:96px;bottom:1017px;letter-spacing:0.14px;word-spacing:-0.45px;}
#t7_670{left:393px;bottom:1017px;letter-spacing:-0.1px;}
#t8_670{left:467px;bottom:1017px;letter-spacing:0.14px;word-spacing:-0.45px;}
#t9_670{left:96px;bottom:996px;letter-spacing:0.13px;word-spacing:-0.48px;}
#ta_670{left:96px;bottom:974px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tb_670{left:96px;bottom:953px;letter-spacing:0.13px;word-spacing:-0.45px;}
#tc_670{left:490px;bottom:953px;letter-spacing:-0.1px;}
#td_670{left:564px;bottom:953px;letter-spacing:0.14px;word-spacing:-0.46px;}
#te_670{left:96px;bottom:931px;letter-spacing:0.13px;word-spacing:-0.48px;}
#tf_670{left:96px;bottom:910px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tg_670{left:96px;bottom:889px;letter-spacing:0.14px;word-spacing:-0.45px;}
#th_670{left:300px;bottom:889px;letter-spacing:-0.1px;}
#ti_670{left:375px;bottom:889px;letter-spacing:0.13px;word-spacing:-0.47px;}
#tj_670{left:96px;bottom:867px;letter-spacing:0.11px;word-spacing:-0.43px;}
#tk_670{left:96px;bottom:846px;letter-spacing:0.13px;word-spacing:-0.46px;}
#tl_670{left:96px;bottom:809px;letter-spacing:-0.11px;word-spacing:0.01px;}
#tm_670{left:346px;bottom:809px;letter-spacing:0.13px;word-spacing:-0.46px;}
#tn_670{left:96px;bottom:787px;letter-spacing:0.13px;word-spacing:-0.51px;}
#to_670{left:96px;bottom:766px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tp_670{left:96px;bottom:744px;letter-spacing:0.12px;word-spacing:-0.48px;}
#tq_670{left:96px;bottom:723px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tr_670{left:96px;bottom:702px;letter-spacing:0.13px;word-spacing:-0.45px;}
#ts_670{left:96px;bottom:680px;letter-spacing:0.12px;word-spacing:-0.82px;}
#tt_670{left:96px;bottom:659px;letter-spacing:0.12px;word-spacing:-0.76px;}
#tu_670{left:96px;bottom:637px;letter-spacing:0.13px;word-spacing:-0.46px;}
#tv_670{left:96px;bottom:602px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tw_670{left:96px;bottom:581px;letter-spacing:0.12px;word-spacing:-0.46px;}
#tx_670{left:96px;bottom:560px;letter-spacing:0.11px;word-spacing:-0.83px;}
#ty_670{left:96px;bottom:538px;letter-spacing:0.12px;word-spacing:-0.45px;}
#tz_670{left:96px;bottom:517px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t10_670{left:96px;bottom:495px;letter-spacing:0.12px;word-spacing:-0.47px;}
#t11_670{left:96px;bottom:459px;letter-spacing:-0.11px;word-spacing:0.01px;}
#t12_670{left:346px;bottom:458px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t13_670{left:96px;bottom:437px;letter-spacing:0.12px;word-spacing:-0.47px;}
#t14_670{left:96px;bottom:415px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t15_670{left:96px;bottom:394px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t16_670{left:96px;bottom:373px;letter-spacing:0.13px;word-spacing:-0.46px;}
#t17_670{left:96px;bottom:338px;letter-spacing:0.12px;word-spacing:-0.55px;}
#t18_670{left:96px;bottom:316px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t19_670{left:96px;bottom:295px;letter-spacing:0.12px;word-spacing:-0.44px;}
#t1a_670{left:96px;bottom:273px;letter-spacing:0.13px;word-spacing:-0.48px;}
#t1b_670{left:96px;bottom:252px;letter-spacing:0.13px;word-spacing:-0.46px;}
#t1c_670{left:96px;bottom:231px;letter-spacing:0.12px;word-spacing:-0.46px;}
#t1d_670{left:96px;bottom:209px;letter-spacing:0.13px;word-spacing:-0.46px;}
#t1e_670{left:96px;bottom:188px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t1f_670{left:96px;bottom:166px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t1g_670{left:96px;bottom:131px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t1h_670{left:96px;bottom:110px;letter-spacing:0.13px;word-spacing:-0.76px;}
#t1i_670{left:396px;bottom:12px;letter-spacing:0.16px;}

.s1_670{font-size:17px;font-family:Arial-BoldItalic_623;color:#000;}
.s2_670{font-size:17px;font-family:Arial-Italic_62c;color:#000;}
.s3_670{font-size:18px;font-family:TimesNewRoman_61y;color:#000;}
.s4_670{font-size:18px;font-family:TimesNewRoman-Italic_626;color:#000;}
.s5_670{font-size:17px;font-family:Arial-Bold_61q;color:#000;}
.s6_670{font-size:18px;font-family:Arial_62w;color:#00AB00;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts670" type="text/css" >

@font-face {
	font-family: Arial-BoldItalic_623;
	src: url("fonts/Arial-BoldItalic_623.woff") format("woff");
}

@font-face {
	font-family: Arial-Bold_61q;
	src: url("fonts/Arial-Bold_61q.woff") format("woff");
}

@font-face {
	font-family: Arial-Italic_62c;
	src: url("fonts/Arial-Italic_62c.woff") format("woff");
}

@font-face {
	font-family: Arial_62w;
	src: url("fonts/Arial_62w.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman-Italic_626;
	src: url("fonts/TimesNewRoman-Italic_626.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_61y;
	src: url("fonts/TimesNewRoman_61y.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg670Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg670" style="-webkit-user-select: none;"><object width="935" height="1210" data="670/670.svg" type="image/svg+xml" id="pdf670" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_670" class="t s1_670">215 </span><span id="t2_670" class="t s2_670">Memory System </span>
<span id="t3_670" class="t s1_670">AMD64 Technology </span><span id="t4_670" class="t s1_670">24593—Rev. 3.41—June 2023 </span>
<span id="t5_670" class="t s3_670">Software can determine the size of the reserved range it wishes to lock in bytes and allocate as many </span>
<span id="t6_670" class="t s3_670">L3-ways as needed by programming the </span><span id="t7_670" class="t s4_670">WayMask </span><span id="t8_670" class="t s3_670">field in MSR C001_109Ah. Software must set </span>
<span id="t9_670" class="t s3_670">CR0.CD on all logical processors sharing the L3 cache and execute the WBINVD instruction to flush </span>
<span id="ta_670" class="t s3_670">the L3 cache before enabling the Range Reservation feature. If the size of the reserved range is less </span>
<span id="tb_670" class="t s3_670">than the number of bytes of L3 cache allocated by the </span><span id="tc_670" class="t s4_670">WayMask </span><span id="td_670" class="t s3_670">field in MSR C001_109Ah, the </span>
<span id="te_670" class="t s3_670">reserved range will remain “locked” in cache. The reserved range follows coherency rules around </span>
<span id="tf_670" class="t s3_670">evictions, probes, and cache flushes. If the size of the reserved range does not fit in the allocated L3 </span>
<span id="tg_670" class="t s3_670">ways as programmed in the </span><span id="th_670" class="t s4_670">WayMask </span><span id="ti_670" class="t s3_670">field in MSR C001_109Ah, the cache lines within the reserved </span>
<span id="tj_670" class="t s3_670">range are replaced using normal L3 cache replacement policy, in those allocated L3 ways. However, </span>
<span id="tk_670" class="t s3_670">the reserved region is only used by cache lines in the reserved range. </span>
<span id="tl_670" class="t s5_670">Range Reservation Operation. </span><span id="tm_670" class="t s3_670">The scope of L3 range reservation is limited to an L3 cache and the </span>
<span id="tn_670" class="t s3_670">cores sharing that L3 cache. Setting up a reserved range reserves a portion of the corresponding cache </span>
<span id="to_670" class="t s3_670">for use by a range of system physical addresses but does not bring the data or instructions at those </span>
<span id="tp_670" class="t s3_670">addresses into the cache. The cache is filled with the data or instructions from the reserved address </span>
<span id="tq_670" class="t s3_670">region as those addresses are accessed by the associated logical processors, either through explicit </span>
<span id="tr_670" class="t s3_670">references by software, by hardware-based prefetching or by speculative execution of instructions </span>
<span id="ts_670" class="t s3_670">which may or may not eventually retire. After the L3 range reservation is enabled, the cache lines with </span>
<span id="tt_670" class="t s3_670">addresses in the reserved range are cached in the reserved region of the L3 cache. The cache lines with </span>
<span id="tu_670" class="t s3_670">addresses outside the reserved range are cached in the unreserved region of the L3 cache. </span>
<span id="tv_670" class="t s3_670">Whether L3 range reservation is enabled or disabled, a cache line in the reserved range will still </span>
<span id="tw_670" class="t s3_670">behave coherently with respect to all coherent operations. Placing a cache line in a reserved location </span>
<span id="tx_670" class="t s3_670">does not exempt it from the rules of coherency. In case where a cache line outside the reserved range is </span>
<span id="ty_670" class="t s3_670">present in the reserved region at the time the L3 range reservation feature is enabled or where a cache </span>
<span id="tz_670" class="t s3_670">line in the reserved range is present in unreserved regions of the cache, normal coherent accesses by </span>
<span id="t10_670" class="t s3_670">any processor in the system will still read the correct, current data from these locations. </span>
<span id="t11_670" class="t s5_670">Programming Considerations. </span><span id="t12_670" class="t s3_670">The Range Reservation configuration registers should not be </span>
<span id="t13_670" class="t s3_670">modified while cacheable traffic is in flight. The recommended way to meet this requirement is to set </span>
<span id="t14_670" class="t s3_670">the CR0.CD bit on all logical processors which are connected to the cache being configured. For the </span>
<span id="t15_670" class="t s3_670">L3 cache, that includes all the logical processors sharing an L3 cache and for the L2 cache that </span>
<span id="t16_670" class="t s3_670">includes the two logical processors which share a physical core and L2 cache. </span>
<span id="t17_670" class="t s3_670">If a given range is reserved in multiple L3 caches in a system, the cache lines can be cached in each of </span>
<span id="t18_670" class="t s3_670">them as long as none of the logical processors accessing the data modify it. Modifying the cache lines </span>
<span id="t19_670" class="t s3_670">will remove them from all other caches. However, once the modification is complete the cache lines </span>
<span id="t1a_670" class="t s3_670">can once again be re-cached in multiple caches if accessed by those processors. The cache lines thus </span>
<span id="t1b_670" class="t s3_670">accessed are again placed in the reserved region of the L3 cache upon access. It is not necessary to </span>
<span id="t1c_670" class="t s3_670">disable and re-enable the address range in order to re-establish the reserved region; the affected </span>
<span id="t1d_670" class="t s3_670">addresses will be brought into the reserved cache regions again as they are accessed, although the </span>
<span id="t1e_670" class="t s3_670">initial accesses to those ranges will incur the latency penalty associated with retrieving the data or </span>
<span id="t1f_670" class="t s3_670">instructions from memory or another cache. </span>
<span id="t1g_670" class="t s3_670">Setting up a reserved range does not affect the cacheability rules of the addresses in that range. For </span>
<span id="t1h_670" class="t s3_670">example, if the page tables specify that the memory type for a page is UC, including that page within a </span>
<span id="t1i_670" class="t s6_670">[AMD Public Use] </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
