<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p1050" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_1050{left:96px;bottom:48px;letter-spacing:-0.15px;}
#t2_1050{left:666px;bottom:48px;letter-spacing:-0.12px;word-spacing:0.03px;}
#t3_1050{left:96px;bottom:1116px;letter-spacing:-0.17px;word-spacing:0.06px;}
#t4_1050{left:601px;bottom:1116px;letter-spacing:-0.17px;word-spacing:2.71px;}
#t5_1050{left:96px;bottom:1038px;letter-spacing:0.13px;word-spacing:-0.45px;}
#t6_1050{left:96px;bottom:1017px;letter-spacing:0.12px;word-spacing:-0.48px;}
#t7_1050{left:96px;bottom:982px;letter-spacing:0.12px;word-spacing:-0.45px;}
#t8_1050{left:96px;bottom:960px;letter-spacing:0.12px;word-spacing:-0.47px;}
#t9_1050{left:96px;bottom:902px;letter-spacing:0.2px;}
#ta_1050{left:192px;bottom:902px;letter-spacing:0.15px;word-spacing:0.06px;}
#tb_1050{left:96px;bottom:866px;letter-spacing:0.11px;word-spacing:-0.54px;}
#tc_1050{left:96px;bottom:844px;letter-spacing:0.09px;word-spacing:-0.5px;}
#td_1050{left:96px;bottom:823px;letter-spacing:0.11px;word-spacing:-1.13px;}
#te_1050{left:96px;bottom:801px;letter-spacing:0.13px;word-spacing:-0.61px;}
#tf_1050{left:96px;bottom:780px;letter-spacing:0.13px;word-spacing:-0.5px;}
#tg_1050{left:96px;bottom:745px;letter-spacing:0.11px;word-spacing:-0.46px;}
#th_1050{left:96px;bottom:724px;letter-spacing:0.12px;word-spacing:-0.46px;}
#ti_1050{left:96px;bottom:702px;letter-spacing:0.1px;word-spacing:-0.42px;}
#tj_1050{left:96px;bottom:662px;letter-spacing:0.14px;}
#tk_1050{left:168px;bottom:662px;letter-spacing:0.13px;word-spacing:0.02px;}
#tl_1050{left:96px;bottom:627px;letter-spacing:0.12px;word-spacing:-0.43px;}
#tm_1050{left:96px;bottom:606px;letter-spacing:0.1px;word-spacing:-0.38px;}
#tn_1050{left:96px;bottom:566px;letter-spacing:0.14px;}
#to_1050{left:168px;bottom:566px;letter-spacing:0.09px;word-spacing:0.13px;}
#tp_1050{left:96px;bottom:531px;letter-spacing:0.1px;word-spacing:-0.93px;}
#tq_1050{left:96px;bottom:510px;letter-spacing:0.09px;word-spacing:-0.85px;}
#tr_1050{left:96px;bottom:488px;letter-spacing:0.11px;word-spacing:-0.47px;}
#ts_1050{left:96px;bottom:467px;letter-spacing:0.09px;word-spacing:-0.43px;}
#tt_1050{left:96px;bottom:432px;letter-spacing:0.12px;word-spacing:-0.5px;}
#tu_1050{left:96px;bottom:410px;letter-spacing:0.09px;word-spacing:-0.75px;}
#tv_1050{left:96px;bottom:389px;letter-spacing:0.11px;word-spacing:-0.49px;}
#tw_1050{left:96px;bottom:367px;letter-spacing:0.14px;word-spacing:-0.99px;}
#tx_1050{left:96px;bottom:346px;letter-spacing:0.1px;word-spacing:-0.41px;}
#ty_1050{left:96px;bottom:325px;letter-spacing:0.11px;word-spacing:-0.51px;}
#tz_1050{left:96px;bottom:290px;letter-spacing:0.11px;word-spacing:-0.45px;}
#t10_1050{left:96px;bottom:268px;letter-spacing:0.13px;word-spacing:-0.47px;}
#t11_1050{left:96px;bottom:228px;letter-spacing:0.14px;}
#t12_1050{left:168px;bottom:228px;letter-spacing:0.1px;word-spacing:0.12px;}
#t13_1050{left:96px;bottom:193px;letter-spacing:0.11px;word-spacing:-0.46px;}
#t14_1050{left:96px;bottom:172px;letter-spacing:0.12px;word-spacing:-0.5px;}
#t15_1050{left:96px;bottom:150px;letter-spacing:0.12px;word-spacing:-0.68px;}
#t16_1050{left:96px;bottom:129px;letter-spacing:0.12px;word-spacing:-0.47px;}
#t17_1050{left:96px;bottom:108px;letter-spacing:0.13px;word-spacing:-0.48px;}
#t18_1050{left:396px;bottom:12px;letter-spacing:0.16px;}

.s1_1050{font-size:17px;font-family:Arial-BoldItalic_623;color:#000;}
.s2_1050{font-size:17px;font-family:Arial-Italic_62c;color:#000;}
.s3_1050{font-size:18px;font-family:TimesNewRoman_61y;color:#000;}
.s4_1050{font-size:24px;font-family:Arial-Bold_61q;color:#000;}
.s5_1050{font-size:18px;font-family:Arial-Bold_61q;color:#000;}
.s6_1050{font-size:18px;font-family:Arial_62w;color:#00AB00;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts1050" type="text/css" >

@font-face {
	font-family: Arial-BoldItalic_623;
	src: url("fonts/Arial-BoldItalic_623.woff") format("woff");
}

@font-face {
	font-family: Arial-Bold_61q;
	src: url("fonts/Arial-Bold_61q.woff") format("woff");
}

@font-face {
	font-family: Arial-Italic_62c;
	src: url("fonts/Arial-Italic_62c.woff") format("woff");
}

@font-face {
	font-family: Arial_62w;
	src: url("fonts/Arial_62w.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_61y;
	src: url("fonts/TimesNewRoman_61y.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg1050Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg1050" style="-webkit-user-select: none;"><object width="935" height="1210" data="1050/1050.svg" type="image/svg+xml" id="pdf1050" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_1050" class="t s1_1050">595 </span><span id="t2_1050" class="t s2_1050">Secure Virtual Machine </span>
<span id="t3_1050" class="t s1_1050">AMD64 Technology </span><span id="t4_1050" class="t s1_1050">24593—Rev. 3.41—June 2023 </span>
<span id="t5_1050" class="t s3_1050">When this feature is enabled, CPU hardware treats the guest C-bit as 1 for all guest memory </span>
<span id="t6_1050" class="t s3_1050">references. The actual C-bit in the guest page tables is ignored by hardware. </span>
<span id="t7_1050" class="t s3_1050">Guest address translation is unchanged, so the guest physical address (without the C-bit) is used for </span>
<span id="t8_1050" class="t s3_1050">translation in the nested page tables. </span>
<span id="t9_1050" class="t s4_1050">15.35 </span><span id="ta_1050" class="t s4_1050">Encrypted State (SEV-ES) </span>
<span id="tb_1050" class="t s3_1050">Encrypted VMs that use the SEV feature described in Section 15.34 may additionally use the SEV-ES </span>
<span id="tc_1050" class="t s3_1050">feature to protect guest register state from the hypervisor. An SEV-ES VM's CPU register state is </span>
<span id="td_1050" class="t s3_1050">encrypted during world switches and cannot be directly accessed or modified by the hypervisor. This is </span>
<span id="te_1050" class="t s3_1050">designed to protect against attacks such as exfiltration (unauthorized reading of VM state) and control </span>
<span id="tf_1050" class="t s3_1050">flow attacks (modifying VM state) including rollback attacks (restoring an earlier VM register state). </span>
<span id="tg_1050" class="t s3_1050">SEV-ES includes architectural support for notifying a VM's operating system when certain types of </span>
<span id="th_1050" class="t s3_1050">world switches are about to occur, allowing the VM to selectively share information with the </span>
<span id="ti_1050" class="t s3_1050">hypervisor when needed for functionality. </span>
<span id="tj_1050" class="t s5_1050">15.35.1 </span><span id="tk_1050" class="t s5_1050">Determining Support for SEV-ES </span>
<span id="tl_1050" class="t s3_1050">SEV-ES support can be determined by reading CPUID Fn8000_001F[EAX] as described in </span>
<span id="tm_1050" class="t s3_1050">Section 15.34.1. Bit 3 of EAX indicates support for SEV-ES. </span>
<span id="tn_1050" class="t s5_1050">15.35.2 </span><span id="to_1050" class="t s5_1050">Enabling SEV-ES </span>
<span id="tp_1050" class="t s3_1050">SEV-ES may be enabled on a per-VM basis by setting bit 2 in offset 90h of the VMCB. When enabling </span>
<span id="tq_1050" class="t s3_1050">SEV-ES, the hypervisor must also enable SEV (offset 90h bit 1) and LBR virtualization (offset B8h bit </span>
<span id="tr_1050" class="t s3_1050">0). Additionally, all other programming requirements related to enabling SEV (see Section 15.34.3) </span>
<span id="ts_1050" class="t s3_1050">must be satisfied when running an SEV-ES guest. </span>
<span id="tt_1050" class="t s3_1050">On some systems, there is a limitation on which ASID values can be used on SEV guests that are run </span>
<span id="tu_1050" class="t s3_1050">with SEV-ES disabled. While SEV-ES may be enabled on any valid SEV ASID (as defined by CPUID </span>
<span id="tv_1050" class="t s3_1050">Fn8000_001F[ECX]), there are restrictions on which ASIDs may be used for SEV guests with SEV- </span>
<span id="tw_1050" class="t s3_1050">ES disabled. CPUID Fn8000_001F[EDX] indicates the minimum ASID value that must be used for an </span>
<span id="tx_1050" class="t s3_1050">SEV-enabled, SEV-ES-disabled guest. For example, if CPUID Fn8000_001F[EDX] returns the value </span>
<span id="ty_1050" class="t s3_1050">5, then any VMs which use ASIDs 1-4 and which enable SEV must also enable SEV-ES. </span>
<span id="tz_1050" class="t s3_1050">Note that prior to running an SEV-ES VM for the first time, the hypervisor must coordinate with the </span>
<span id="t10_1050" class="t s3_1050">AMD Secure Processor to create the initial encrypted state image for the guest VM. </span>
<span id="t11_1050" class="t s5_1050">15.35.3 </span><span id="t12_1050" class="t s5_1050">SEV-ES Overview </span>
<span id="t13_1050" class="t s3_1050">The SEV-ES architecture is designed to protect guest VM register state by default, and only allow the </span>
<span id="t14_1050" class="t s3_1050">guest VM itself to grant selective access as required. This additional security protection functionality </span>
<span id="t15_1050" class="t s3_1050">is accomplished in two ways. First, all VM register state is saved and encrypted when a VM exit event </span>
<span id="t16_1050" class="t s3_1050">(#VMEXIT) occurs. This state is decrypted and restored on a VMRUN only. Second, certain types of </span>
<span id="t17_1050" class="t s3_1050">#VMEXIT events cause a new exception to be taken within the guest VM. This new exception (#VC, </span>
<span id="t18_1050" class="t s6_1050">[AMD Public Use] </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
