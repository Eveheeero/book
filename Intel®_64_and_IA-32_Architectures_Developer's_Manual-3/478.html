<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p478" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_478{left:69px;bottom:68px;letter-spacing:0.12px;}
#t2_478{left:110px;bottom:68px;letter-spacing:0.1px;}
#t3_478{left:69px;bottom:1141px;letter-spacing:-0.15px;}
#t4_478{left:69px;bottom:1088px;letter-spacing:-0.15px;word-spacing:-0.49px;}
#t5_478{left:69px;bottom:1071px;letter-spacing:-0.14px;word-spacing:-0.5px;}
#t6_478{left:69px;bottom:1046px;letter-spacing:-0.13px;}
#t7_478{left:95px;bottom:1046px;letter-spacing:-0.16px;word-spacing:2.76px;}
#t8_478{left:95px;bottom:1030px;letter-spacing:-0.14px;}
#t9_478{left:69px;bottom:1005px;letter-spacing:-0.14px;}
#ta_478{left:95px;bottom:1005px;letter-spacing:-0.17px;word-spacing:-0.42px;}
#tb_478{left:69px;bottom:981px;letter-spacing:-0.13px;}
#tc_478{left:95px;bottom:981px;letter-spacing:-0.15px;word-spacing:-0.48px;}
#td_478{left:69px;bottom:956px;letter-spacing:-0.13px;}
#te_478{left:95px;bottom:956px;letter-spacing:-0.15px;word-spacing:-1.31px;}
#tf_478{left:95px;bottom:940px;letter-spacing:-0.16px;word-spacing:-0.44px;}
#tg_478{left:69px;bottom:915px;letter-spacing:-0.14px;word-spacing:-0.99px;}
#th_478{left:69px;bottom:898px;letter-spacing:-0.16px;word-spacing:-0.44px;}
#ti_478{left:69px;bottom:881px;letter-spacing:-0.15px;word-spacing:-1.08px;}
#tj_478{left:69px;bottom:865px;letter-spacing:-0.15px;word-spacing:-1.13px;}
#tk_478{left:69px;bottom:848px;letter-spacing:-0.18px;word-spacing:-0.79px;}
#tl_478{left:69px;bottom:831px;letter-spacing:-0.15px;word-spacing:-0.45px;}
#tm_478{left:69px;bottom:807px;letter-spacing:-0.18px;word-spacing:-0.42px;}
#tn_478{left:69px;bottom:790px;letter-spacing:-0.17px;word-spacing:-0.44px;}
#to_478{left:69px;bottom:731px;letter-spacing:0.14px;}
#tp_478{left:151px;bottom:731px;letter-spacing:0.14px;word-spacing:0.01px;}
#tq_478{left:69px;bottom:707px;letter-spacing:-0.2px;word-spacing:-0.41px;}
#tr_478{left:69px;bottom:690px;letter-spacing:-0.14px;word-spacing:-0.53px;}
#ts_478{left:69px;bottom:674px;letter-spacing:-0.18px;word-spacing:-0.41px;}
#tt_478{left:69px;bottom:657px;letter-spacing:-0.19px;word-spacing:-0.44px;}
#tu_478{left:69px;bottom:632px;letter-spacing:-0.2px;word-spacing:-0.72px;}
#tv_478{left:69px;bottom:616px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#tw_478{left:69px;bottom:599px;letter-spacing:-0.18px;word-spacing:-0.45px;}
#tx_478{left:69px;bottom:582px;letter-spacing:-0.18px;word-spacing:-0.88px;}
#ty_478{left:69px;bottom:565px;letter-spacing:-0.16px;word-spacing:-0.74px;}
#tz_478{left:69px;bottom:548px;letter-spacing:-0.15px;word-spacing:-0.83px;}
#t10_478{left:69px;bottom:532px;letter-spacing:-0.18px;word-spacing:-0.86px;}
#t11_478{left:69px;bottom:515px;letter-spacing:-0.14px;word-spacing:-1.08px;}
#t12_478{left:69px;bottom:498px;letter-spacing:-0.15px;word-spacing:-1.13px;}
#t13_478{left:69px;bottom:481px;letter-spacing:-0.64px;word-spacing:-0.01px;}

.s1_478{font-size:12px;font-family:NeoSansIntel_1uk1;color:#000;}
.s2_478{font-size:14px;font-family:NeoSansIntel_1uk1;color:#0860A8;}
.s3_478{font-size:14px;font-family:Verdana_3e8;color:#000;}
.s4_478{font-size:18px;font-family:NeoSansIntelMedium_1uk0;color:#0860A8;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts478" type="text/css" >

@font-face {
	font-family: NeoSansIntelMedium_1uk0;
	src: url("fonts/NeoSansIntelMedium_1uk0.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_1uk1;
	src: url("fonts/NeoSansIntel_1uk1.woff") format("woff");
}

@font-face {
	font-family: Verdana_3e8;
	src: url("fonts/Verdana_3e8.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg478Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg478" style="-webkit-user-select: none;"><object width="935" height="1210" data="478/478.svg" type="image/svg+xml" id="pdf478" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_478" class="t s1_478">12-36 </span><span id="t2_478" class="t s1_478">Vol. 3A </span>
<span id="t3_478" class="t s2_478">MEMORY CACHE CONTROL </span>
<span id="t4_478" class="t s3_478">When remapping a page that was previously mapped as a cacheable memory type to a WC page, an operating </span>
<span id="t5_478" class="t s3_478">system can avoid this type of aliasing by doing the following: </span>
<span id="t6_478" class="t s3_478">1. </span><span id="t7_478" class="t s3_478">Remove the previous mapping to a cacheable memory type in the page tables; that is, make them not </span>
<span id="t8_478" class="t s3_478">present. </span>
<span id="t9_478" class="t s3_478">2. </span><span id="ta_478" class="t s3_478">Flush the TLBs of processors that may have used the mapping, even speculatively. </span>
<span id="tb_478" class="t s3_478">3. </span><span id="tc_478" class="t s3_478">Create a new mapping to the same physical address with a new memory type, for instance, WC. </span>
<span id="td_478" class="t s3_478">4. </span><span id="te_478" class="t s3_478">Flush the caches on all processors that may have used the mapping previously. Note on processors that support </span>
<span id="tf_478" class="t s3_478">self-snooping, CPUID feature flag bit 27, this step is unnecessary. </span>
<span id="tg_478" class="t s3_478">Operating systems that use a page directory as a page table (to map large pages) and enable page size extensions </span>
<span id="th_478" class="t s3_478">must carefully scrutinize the use of the PAT index bit for the 4-KByte page-table entries. The PAT index bit for a </span>
<span id="ti_478" class="t s3_478">page-table entry (bit 7) corresponds to the page size bit in a page-directory entry. Therefore, the operating system </span>
<span id="tj_478" class="t s3_478">can only use PAT entries PA0 through PA3 when setting the caching type for a page table that is also used as a page </span>
<span id="tk_478" class="t s3_478">directory. If the operating system attempts to use PAT entries PA4 through PA7 when using this memory as a page </span>
<span id="tl_478" class="t s3_478">table, it effectively sets the PS bit for the access to this memory as a page directory. </span>
<span id="tm_478" class="t s3_478">For compatibility with earlier IA-32 processors that do not support the PAT, care should be taken in selecting the </span>
<span id="tn_478" class="t s3_478">encodings for entries in the PAT (see Section 12.12.5, “PAT Compatibility with Earlier IA-32 Processors”). </span>
<span id="to_478" class="t s4_478">12.12.5 </span><span id="tp_478" class="t s4_478">PAT Compatibility with Earlier IA-32 Processors </span>
<span id="tq_478" class="t s3_478">For IA-32 processors that support the PAT, the IA32_PAT MSR is always active. That is, the PCD and PWT bits in </span>
<span id="tr_478" class="t s3_478">page-table entries and in page-directory entries (that point to pages) are always select a memory type for a page </span>
<span id="ts_478" class="t s3_478">indirectly by selecting an entry in the PAT. They never select the memory type for a page directly as they do in </span>
<span id="tt_478" class="t s3_478">earlier IA-32 processors that do not implement the PAT (see Table 12-6). </span>
<span id="tu_478" class="t s3_478">To allow compatibility for code written to run on earlier IA-32 processor that do not support the PAT, the PAT mech- </span>
<span id="tv_478" class="t s3_478">anism has been designed to allow backward compatibility to earlier processors. This compatibility is provided </span>
<span id="tw_478" class="t s3_478">through the ordering of the PAT, PCD, and PWT bits in the 3-bit PAT entry index. For processors that do not imple- </span>
<span id="tx_478" class="t s3_478">ment the PAT, the PAT index bit (bit 7 in the page-table entries and bit 12 in the page-directory entries) is reserved </span>
<span id="ty_478" class="t s3_478">and set to 0. With the PAT bit reserved, only the first four entries of the PAT can be selected with the PCD and PWT </span>
<span id="tz_478" class="t s3_478">bits. At power-up or reset (see Table 12-12), these first four entries are encoded to select the same memory types </span>
<span id="t10_478" class="t s3_478">as the PCD and PWT bits would normally select directly in an IA-32 processor that does not implement the PAT. So, </span>
<span id="t11_478" class="t s3_478">if encodings of the first four entries in the PAT are left unchanged following a power-up or reset, code written to run </span>
<span id="t12_478" class="t s3_478">on earlier IA-32 processors that do not implement the PAT will run correctly on IA-32 processors that do implement </span>
<span id="t13_478" class="t s3_478">the PAT. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
