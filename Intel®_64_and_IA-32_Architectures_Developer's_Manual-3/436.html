<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p436" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_436{left:69px;bottom:68px;letter-spacing:0.12px;}
#t2_436{left:110px;bottom:68px;letter-spacing:0.1px;}
#t3_436{left:69px;bottom:1141px;letter-spacing:-0.15px;word-spacing:0.01px;}
#t4_436{left:69px;bottom:869px;letter-spacing:-0.15px;word-spacing:-0.65px;}
#t5_436{left:69px;bottom:852px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t6_436{left:69px;bottom:836px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#t7_436{left:69px;bottom:813px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#t8_436{left:69px;bottom:786px;}
#t9_436{left:95px;bottom:790px;letter-spacing:-0.14px;word-spacing:-0.46px;}
#ta_436{left:69px;bottom:763px;}
#tb_436{left:95px;bottom:767px;letter-spacing:-0.13px;word-spacing:-0.48px;}
#tc_436{left:95px;bottom:750px;letter-spacing:-0.14px;}
#td_436{left:69px;bottom:727px;letter-spacing:-0.14px;word-spacing:-0.46px;}
#te_436{left:69px;bottom:710px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#tf_436{left:69px;bottom:687px;letter-spacing:-0.14px;word-spacing:-1px;}
#tg_436{left:69px;bottom:671px;letter-spacing:-0.17px;word-spacing:-0.43px;}
#th_436{left:69px;bottom:654px;letter-spacing:-0.14px;word-spacing:-0.49px;}
#ti_436{left:69px;bottom:637px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#tj_436{left:69px;bottom:620px;letter-spacing:-0.14px;word-spacing:-0.77px;}
#tk_436{left:69px;bottom:603px;letter-spacing:-0.17px;word-spacing:-0.55px;}
#tl_436{left:69px;bottom:587px;letter-spacing:-0.14px;word-spacing:-1.2px;}
#tm_436{left:69px;bottom:570px;letter-spacing:-0.15px;word-spacing:-0.45px;}
#tn_436{left:69px;bottom:553px;letter-spacing:-0.15px;word-spacing:-0.45px;}
#to_436{left:69px;bottom:530px;letter-spacing:-0.16px;word-spacing:-0.44px;}
#tp_436{left:69px;bottom:513px;letter-spacing:-0.13px;word-spacing:-0.5px;}
#tq_436{left:69px;bottom:496px;letter-spacing:-0.14px;word-spacing:-0.53px;}
#tr_436{left:69px;bottom:480px;letter-spacing:-0.14px;word-spacing:-0.44px;}
#ts_436{left:69px;bottom:430px;letter-spacing:-0.09px;}
#tt_436{left:162px;bottom:430px;letter-spacing:-0.1px;word-spacing:0.01px;}
#tu_436{left:69px;bottom:407px;letter-spacing:-0.14px;word-spacing:-0.95px;}
#tv_436{left:69px;bottom:390px;letter-spacing:-0.16px;word-spacing:-0.43px;}
#tw_436{left:69px;bottom:373px;letter-spacing:-0.14px;word-spacing:-1.12px;}
#tx_436{left:235px;bottom:373px;letter-spacing:-0.13px;word-spacing:-1.11px;}
#ty_436{left:69px;bottom:357px;letter-spacing:-0.14px;word-spacing:-0.42px;}
#tz_436{left:96px;bottom:314px;letter-spacing:-0.11px;}
#t10_436{left:69px;bottom:268px;letter-spacing:-0.14px;word-spacing:-0.46px;}
#t11_436{left:69px;bottom:251px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t12_436{left:69px;bottom:234px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#t13_436{left:69px;bottom:211px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t14_436{left:258px;bottom:923px;letter-spacing:0.13px;word-spacing:-0.08px;}
#t15_436{left:359px;bottom:923px;letter-spacing:0.13px;word-spacing:-0.02px;}
#t16_436{left:259px;bottom:1031px;letter-spacing:0.12px;word-spacing:-0.24px;}
#t17_436{left:255px;bottom:1001px;letter-spacing:-0.16px;}
#t18_436{left:662px;bottom:1001px;}
#t19_436{left:432px;bottom:977px;letter-spacing:0.1px;word-spacing:0.04px;}

.s1_436{font-size:12px;font-family:NeoSansIntel_1uk1;color:#000;}
.s2_436{font-size:14px;font-family:NeoSansIntel_1uk1;color:#0860A8;}
.s3_436{font-size:14px;font-family:Verdana_3e8;color:#000;}
.s4_436{font-size:21px;font-family:TimesNewRoman_3ec;color:#000;}
.s5_436{font-size:17px;font-family:NeoSansIntelMedium_1uk0;color:#0860A8;}
.s6_436{font-size:14px;font-family:NeoSansIntel_1uk1;color:#000;}
.s7_436{font-size:15px;font-family:NeoSansIntelMedium_1uk0;color:#0860A8;}
.s8_436{font-size:12px;font-family:Arial-Bold_3ea;color:#000;}
.s9_436{font-size:11px;font-family:Arial_3ed;color:#000;}
.sa_436{font-size:12px;font-family:Arial_3ed;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts436" type="text/css" >

@font-face {
	font-family: Arial-Bold_3ea;
	src: url("fonts/Arial-Bold_3ea.woff") format("woff");
}

@font-face {
	font-family: Arial_3ed;
	src: url("fonts/Arial_3ed.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntelMedium_1uk0;
	src: url("fonts/NeoSansIntelMedium_1uk0.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_1uk1;
	src: url("fonts/NeoSansIntel_1uk1.woff") format("woff");
}

@font-face {
	font-family: TimesNewRoman_3ec;
	src: url("fonts/TimesNewRoman_3ec.woff") format("woff");
}

@font-face {
	font-family: Verdana_3e8;
	src: url("fonts/Verdana_3e8.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg436Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg436" style="-webkit-user-select: none;"><object width="935" height="1210" data="436/436.svg" type="image/svg+xml" id="pdf436" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_436" class="t s1_436">11-46 </span><span id="t2_436" class="t s1_436">Vol. 3A </span>
<span id="t3_436" class="t s2_436">ADVANCED PROGRAMMABLE INTERRUPT CONTROLLER (APIC) </span>
<span id="t4_436" class="t s3_436">In the xAPIC mode, the Destination Format Register (DFR) through the MMIO interface determines the choice of a </span>
<span id="t5_436" class="t s3_436">flat logical mode or a clustered logical mode. Flat logical mode is not supported in the x2APIC mode. Hence the </span>
<span id="t6_436" class="t s3_436">Destination Format Register (DFR) is eliminated in x2APIC mode. </span>
<span id="t7_436" class="t s3_436">The 32-bit logical x2APIC ID field of LDR is partitioned into two sub-fields: </span>
<span id="t8_436" class="t s4_436">• </span><span id="t9_436" class="t s3_436">Cluster ID (LDR[31:16]): is the address of the destination cluster </span>
<span id="ta_436" class="t s4_436">• </span><span id="tb_436" class="t s3_436">Logical ID (LDR[15:0]): defines a logical ID of the individual local x2APIC within the cluster specified by </span>
<span id="tc_436" class="t s3_436">LDR[31:16]. </span>
<span id="td_436" class="t s3_436">This layout enables 2^16-1 clusters each with up to 16 unique logical IDs - effectively providing an addressability </span>
<span id="te_436" class="t s3_436">of ((2^20) - 16) processors in logical destination mode. </span>
<span id="tf_436" class="t s3_436">It is likely that processor implementations may choose to support less than 16 bits of the cluster ID or less than 16- </span>
<span id="tg_436" class="t s3_436">bits of the Logical ID in the Logical Destination Register. However system software should be agnostic to the </span>
<span id="th_436" class="t s3_436">number of bits implemented in the cluster ID and logical ID sub-fields. The x2APIC hardware initialization will </span>
<span id="ti_436" class="t s3_436">ensure that the appropriately initialized logical x2APIC IDs are available to system software and reads of non- </span>
<span id="tj_436" class="t s3_436">implemented bits return zero. This is a read-only register that software must read to determine the logical x2APIC </span>
<span id="tk_436" class="t s3_436">ID of the processor. Specifically, software can apply a 16-bit mask to the lowest 16 bits of the logical x2APIC ID to </span>
<span id="tl_436" class="t s3_436">identify the logical address of a processor within a cluster without needing to know the number of implemented bits </span>
<span id="tm_436" class="t s3_436">in cluster ID and Logical ID sub-fields. Similarly, software can create a message destination address for cluster </span>
<span id="tn_436" class="t s3_436">model, by bit-Oring the Logical X2APIC ID (31:0) of processors that have matching Cluster ID(31:16). </span>
<span id="to_436" class="t s3_436">To enable cluster ID assignment in a fashion that matches the system topology characteristics and to enable effi- </span>
<span id="tp_436" class="t s3_436">cient routing of logical mode lowest priority device interrupts in link based platform interconnects, the LDR are </span>
<span id="tq_436" class="t s3_436">initialized by hardware based on the value of x2APIC ID upon x2APIC state transitions. Details of this initialization </span>
<span id="tr_436" class="t s3_436">are provided in Section 11.12.10.2. </span>
<span id="ts_436" class="t s5_436">11.12.10.2 </span><span id="tt_436" class="t s5_436">Deriving Logical x2APIC ID from the Local x2APIC ID </span>
<span id="tu_436" class="t s3_436">In x2APIC mode, the 32-bit logical x2APIC ID, which can be read from LDR, is derived from the 32-bit local x2APIC </span>
<span id="tv_436" class="t s3_436">ID. Specifically, the 16-bit logical ID sub-field is derived by shifting 1 by the lowest 4 bits of the x2APIC ID, i.e., </span>
<span id="tw_436" class="t s3_436">Logical ID = 1 « x2APIC </span><span id="tx_436" class="t s3_436">ID[3:0]. The remaining bits of the x2APIC ID then form the cluster ID portion of the logical </span>
<span id="ty_436" class="t s3_436">x2APIC ID: </span>
<span id="tz_436" class="t s6_436">Logical x2APIC ID = [(x2APIC ID[19:4] « 16) | (1 « x2APIC ID[3:0])] </span>
<span id="t10_436" class="t s3_436">The use of the lowest 4 bits in the x2APIC ID implies that at least 16 APIC IDs are reserved for logical processors </span>
<span id="t11_436" class="t s3_436">within a socket in multi-socket configurations. If more than 16 APIC IDS are reserved for logical processors in a </span>
<span id="t12_436" class="t s3_436">socket/package then multiple cluster IDs can exist within the package. </span>
<span id="t13_436" class="t s3_436">The LDR initialization occurs whenever the x2APIC mode is enabled (see Section 11.12.5). </span>
<span id="t14_436" class="t s7_436">Figure 11-29. </span><span id="t15_436" class="t s7_436">Logical Destination Register in x2APIC Mode </span>
<span id="t16_436" class="t s8_436">MSR Address: 80DH </span>
<span id="t17_436" class="t s9_436">31 </span><span id="t18_436" class="t s9_436">0 </span>
<span id="t19_436" class="t sa_436">Logical x2APIC ID </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
