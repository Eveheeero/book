<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p734" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_734{left:69px;bottom:68px;letter-spacing:0.12px;}
#t2_734{left:110px;bottom:68px;letter-spacing:0.1px;}
#t3_734{left:69px;bottom:1141px;letter-spacing:-0.15px;word-spacing:0.01px;}
#t4_734{left:69px;bottom:1088px;letter-spacing:-0.15px;word-spacing:-0.41px;}
#t5_734{left:69px;bottom:1071px;letter-spacing:-0.13px;word-spacing:-1.03px;}
#t6_734{left:69px;bottom:1054px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t7_734{left:69px;bottom:1037px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#t8_734{left:69px;bottom:1013px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t9_734{left:69px;bottom:988px;letter-spacing:-0.15px;}
#ta_734{left:69px;bottom:964px;letter-spacing:-0.14px;word-spacing:-1px;}
#tb_734{left:69px;bottom:947px;letter-spacing:-0.17px;word-spacing:-0.44px;}
#tc_734{left:69px;bottom:923px;letter-spacing:-0.15px;word-spacing:-0.55px;}
#td_734{left:69px;bottom:906px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#te_734{left:69px;bottom:889px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#tf_734{left:69px;bottom:872px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#tg_734{left:69px;bottom:498px;letter-spacing:-0.16px;word-spacing:-0.93px;}
#th_734{left:69px;bottom:481px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#ti_734{left:69px;bottom:464px;letter-spacing:-0.15px;word-spacing:-0.45px;}
#tj_734{left:69px;bottom:440px;letter-spacing:-0.14px;word-spacing:-0.82px;}
#tk_734{left:69px;bottom:423px;letter-spacing:-0.16px;word-spacing:-0.51px;}
#tl_734{left:69px;bottom:399px;letter-spacing:-0.16px;word-spacing:-1.22px;}
#tm_734{left:69px;bottom:382px;letter-spacing:-0.15px;word-spacing:-0.44px;}
#tn_734{left:69px;bottom:365px;letter-spacing:-0.13px;word-spacing:-0.47px;}
#to_734{left:69px;bottom:348px;letter-spacing:-0.15px;word-spacing:-0.51px;}
#tp_734{left:69px;bottom:324px;letter-spacing:-0.16px;word-spacing:-0.47px;}
#tq_734{left:69px;bottom:299px;letter-spacing:-0.14px;word-spacing:-1.19px;}
#tr_734{left:69px;bottom:283px;letter-spacing:-0.16px;word-spacing:-0.43px;}
#ts_734{left:69px;bottom:266px;letter-spacing:-0.16px;word-spacing:-1.19px;}
#tt_734{left:69px;bottom:249px;letter-spacing:-0.15px;word-spacing:-0.77px;}
#tu_734{left:69px;bottom:224px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#tv_734{left:69px;bottom:208px;letter-spacing:-0.13px;word-spacing:-0.98px;}
#tw_734{left:69px;bottom:191px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#tx_734{left:69px;bottom:174px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#ty_734{left:69px;bottom:157px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#tz_734{left:69px;bottom:140px;letter-spacing:-0.14px;word-spacing:-0.81px;}
#t10_734{left:69px;bottom:124px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#t11_734{left:231px;bottom:828px;letter-spacing:0.12px;word-spacing:0.02px;}
#t12_734{left:317px;bottom:828px;letter-spacing:0.12px;}
#t13_734{left:78px;bottom:805px;letter-spacing:-0.14px;word-spacing:0.07px;}
#t14_734{left:204px;bottom:805px;letter-spacing:-0.11px;}
#t15_734{left:465px;bottom:805px;letter-spacing:-0.12px;word-spacing:-0.04px;}
#t16_734{left:591px;bottom:805px;letter-spacing:-0.11px;}
#t17_734{left:78px;bottom:781px;letter-spacing:-0.19px;}
#t18_734{left:204px;bottom:781px;letter-spacing:-0.14px;}
#t19_734{left:465px;bottom:781px;letter-spacing:-0.15px;}
#t1a_734{left:591px;bottom:781px;letter-spacing:-0.15px;}
#t1b_734{left:78px;bottom:756px;letter-spacing:-0.18px;}
#t1c_734{left:204px;bottom:756px;letter-spacing:-0.12px;}
#t1d_734{left:465px;bottom:756px;letter-spacing:-0.14px;}
#t1e_734{left:591px;bottom:756px;letter-spacing:-0.14px;}
#t1f_734{left:78px;bottom:732px;letter-spacing:-0.18px;}
#t1g_734{left:204px;bottom:732px;letter-spacing:-0.15px;}
#t1h_734{left:465px;bottom:732px;letter-spacing:-0.15px;}
#t1i_734{left:591px;bottom:732px;letter-spacing:-0.15px;}
#t1j_734{left:78px;bottom:707px;letter-spacing:-0.18px;}
#t1k_734{left:204px;bottom:707px;letter-spacing:-0.15px;}
#t1l_734{left:465px;bottom:707px;letter-spacing:-0.14px;}
#t1m_734{left:591px;bottom:707px;letter-spacing:-0.14px;}
#t1n_734{left:78px;bottom:683px;letter-spacing:-0.18px;}
#t1o_734{left:204px;bottom:683px;letter-spacing:-0.15px;}
#t1p_734{left:465px;bottom:683px;letter-spacing:-0.14px;}
#t1q_734{left:591px;bottom:683px;letter-spacing:-0.14px;}
#t1r_734{left:78px;bottom:658px;letter-spacing:-0.18px;}
#t1s_734{left:204px;bottom:658px;letter-spacing:-0.14px;}
#t1t_734{left:465px;bottom:658px;letter-spacing:-0.15px;}
#t1u_734{left:591px;bottom:658px;letter-spacing:-0.14px;}
#t1v_734{left:78px;bottom:634px;letter-spacing:-0.18px;}
#t1w_734{left:204px;bottom:634px;letter-spacing:-0.13px;}
#t1x_734{left:465px;bottom:634px;letter-spacing:-0.14px;}
#t1y_734{left:591px;bottom:634px;letter-spacing:-0.14px;}
#t1z_734{left:78px;bottom:609px;letter-spacing:-0.19px;}
#t20_734{left:204px;bottom:609px;letter-spacing:-0.13px;}
#t21_734{left:465px;bottom:609px;letter-spacing:-0.13px;}
#t22_734{left:591px;bottom:609px;letter-spacing:-0.15px;}
#t23_734{left:78px;bottom:585px;letter-spacing:-0.18px;}
#t24_734{left:204px;bottom:585px;letter-spacing:-0.15px;}
#t25_734{left:465px;bottom:585px;letter-spacing:-0.13px;}
#t26_734{left:591px;bottom:585px;letter-spacing:-0.12px;}
#t27_734{left:78px;bottom:561px;letter-spacing:-0.18px;}
#t28_734{left:204px;bottom:561px;letter-spacing:-0.15px;}
#t29_734{left:465px;bottom:561px;letter-spacing:-0.16px;}
#t2a_734{left:591px;bottom:561px;letter-spacing:-0.12px;}
#t2b_734{left:78px;bottom:536px;letter-spacing:-0.17px;}
#t2c_734{left:204px;bottom:536px;letter-spacing:-0.19px;}
#t2d_734{left:465px;bottom:536px;letter-spacing:-0.16px;}
#t2e_734{left:591px;bottom:536px;letter-spacing:-0.12px;word-spacing:0.01px;}

.s1_734{font-size:12px;font-family:NeoSansIntel_1uk1;color:#000;}
.s2_734{font-size:14px;font-family:NeoSansIntel_1uk1;color:#0860A8;}
.s3_734{font-size:14px;font-family:Verdana_3e8;color:#000;}
.s4_734{font-size:14px;font-family:Verdana-Bold_3e7;color:#000;}
.s5_734{font-size:15px;font-family:NeoSansIntelMedium_1uk0;color:#0860A8;}
.s6_734{font-size:14px;font-family:NeoSansIntelMedium_1uk0;color:#000;}
.s7_734{font-size:14px;font-family:NeoSansIntel_1uk1;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts734" type="text/css" >

@font-face {
	font-family: NeoSansIntelMedium_1uk0;
	src: url("fonts/NeoSansIntelMedium_1uk0.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_1uk1;
	src: url("fonts/NeoSansIntel_1uk1.woff") format("woff");
}

@font-face {
	font-family: Verdana-Bold_3e7;
	src: url("fonts/Verdana-Bold_3e7.woff") format("woff");
}

@font-face {
	font-family: Verdana_3e8;
	src: url("fonts/Verdana_3e8.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg734Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg734" style="-webkit-user-select: none;"><object width="935" height="1210" data="734/734.svg" type="image/svg+xml" id="pdf734" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_734" class="t s1_734">20-20 </span><span id="t2_734" class="t s1_734">Vol. 3B </span>
<span id="t3_734" class="t s2_734">PERFORMANCE MONITORING </span>
<span id="t4_734" class="t s3_734">The behavior of PEBS assists is reported by IA32_PERF_CAPABILITIES[6] (see Figure 20-65). The return instruc- </span>
<span id="t5_734" class="t s3_734">tion pointer (RIP) reported in the PEBS record will point to the instruction after (+1) the instruction that causes the </span>
<span id="t6_734" class="t s3_734">PEBS assist. The machine state reported in the PEBS record is the machine state after the instruction that causes </span>
<span id="t7_734" class="t s3_734">the PEBS assist is retired. For instance, if the instructions: </span>
<span id="t8_734" class="t s3_734">mov eax, [eax] ; causes PEBS assist </span>
<span id="t9_734" class="t s3_734">nop </span>
<span id="ta_734" class="t s3_734">are executed, the PEBS record will report the address of the nop, and the value of EAX in the PEBS record will show </span>
<span id="tb_734" class="t s3_734">the value read from memory, not the target address of the read operation. </span>
<span id="tc_734" class="t s3_734">The PEBS record format is shown in Table 20-3, and each field in the PEBS record is 64 bits long. The PEBS record </span>
<span id="td_734" class="t s3_734">format, along with debug/store area storage format, does not change regardless of IA-32e mode is active or not. </span>
<span id="te_734" class="t s3_734">CPUID.01H:ECX.DTES64[bit 2] reports whether the processor's DS storage format support is mode-independent. </span>
<span id="tf_734" class="t s3_734">When set, it uses 64-bit DS storage format. </span>
<span id="tg_734" class="t s3_734">In IA-32e mode, the full 64-bit value is written to the register. If the processor is not operating in IA-32e mode, 32- </span>
<span id="th_734" class="t s3_734">bit value is written to registers with bits 63:32 zeroed. Registers not defined when the processor is not in IA-32e </span>
<span id="ti_734" class="t s3_734">mode are written to zero. </span>
<span id="tj_734" class="t s3_734">Bytes AFH:90H are enhancement to the PEBS record format. Support for this enhanced PEBS record format is indi- </span>
<span id="tk_734" class="t s3_734">cated by IA32_PERF_CAPABILITIES[11:8] encoding of 0001B. </span>
<span id="tl_734" class="t s3_734">The value written to bytes 97H:90H is the state of the IA32_PERF_GLOBAL_STATUS register before the PEBS assist </span>
<span id="tm_734" class="t s3_734">occurred. This value is written so software can determine which counters overflowed when this PEBS record was </span>
<span id="tn_734" class="t s3_734">written. Note that this field indicates the overflow status for all counters, regardless of whether they were </span>
<span id="to_734" class="t s3_734">programmed for PEBS or not. </span>
<span id="tp_734" class="t s4_734">Programming PEBS Facility </span>
<span id="tq_734" class="t s3_734">Only a subset of non-architectural performance events in the processor support PEBS. The subset of precise events </span>
<span id="tr_734" class="t s3_734">are listed in Table 20-84. In addition to using IA32_PERFEVTSELx to specify event unit/mask settings and setting </span>
<span id="ts_734" class="t s3_734">the EN_PMCx bit in the IA32_PEBS_ENABLE register for the respective counter, the software must also initialize the </span>
<span id="tt_734" class="t s3_734">DS_BUFFER_MANAGEMENT_AREA data structure in memory to support capturing PEBS records for precise events. </span>
<span id="tu_734" class="t s3_734">The recording of PEBS records may not operate properly if accesses to the linear addresses in the DS buffer </span>
<span id="tv_734" class="t s3_734">management area or in the PEBS buffer (see below) cause page faults, VM exits, or the setting of accessed or dirty </span>
<span id="tw_734" class="t s3_734">flags in the paging structures (ordinary or EPT). For that reason, system software should establish paging struc- </span>
<span id="tx_734" class="t s3_734">tures (both ordinary and EPT) to prevent such occurrences. Implications of this may be that an operating system </span>
<span id="ty_734" class="t s3_734">should allocate this memory from a non-paged pool and that system software cannot do “lazy” page-table entry </span>
<span id="tz_734" class="t s3_734">propagation for these pages. A virtual-machine monitor may choose to allow use of PEBS by guest software only if </span>
<span id="t10_734" class="t s3_734">EPT maps all guest-physical memory as present and read/write. </span>
<span id="t11_734" class="t s5_734">Table 20-3. </span><span id="t12_734" class="t s5_734">PEBS Record Format for Intel Core i7 Processor Family </span>
<span id="t13_734" class="t s6_734">Byte Offset </span><span id="t14_734" class="t s6_734">Field </span><span id="t15_734" class="t s6_734">Byte Offset </span><span id="t16_734" class="t s6_734">Field </span>
<span id="t17_734" class="t s7_734">00H </span><span id="t18_734" class="t s7_734">R/EFLAGS </span><span id="t19_734" class="t s7_734">58H </span><span id="t1a_734" class="t s7_734">R9 </span>
<span id="t1b_734" class="t s7_734">08H </span><span id="t1c_734" class="t s7_734">R/EIP </span><span id="t1d_734" class="t s7_734">60H </span><span id="t1e_734" class="t s7_734">R10 </span>
<span id="t1f_734" class="t s7_734">10H </span><span id="t1g_734" class="t s7_734">R/EAX </span><span id="t1h_734" class="t s7_734">68H </span><span id="t1i_734" class="t s7_734">R11 </span>
<span id="t1j_734" class="t s7_734">18H </span><span id="t1k_734" class="t s7_734">R/EBX </span><span id="t1l_734" class="t s7_734">70H </span><span id="t1m_734" class="t s7_734">R12 </span>
<span id="t1n_734" class="t s7_734">20H </span><span id="t1o_734" class="t s7_734">R/ECX </span><span id="t1p_734" class="t s7_734">78H </span><span id="t1q_734" class="t s7_734">R13 </span>
<span id="t1r_734" class="t s7_734">28H </span><span id="t1s_734" class="t s7_734">R/EDX </span><span id="t1t_734" class="t s7_734">80H </span><span id="t1u_734" class="t s7_734">R14 </span>
<span id="t1v_734" class="t s7_734">30H </span><span id="t1w_734" class="t s7_734">R/ESI </span><span id="t1x_734" class="t s7_734">88H </span><span id="t1y_734" class="t s7_734">R15 </span>
<span id="t1z_734" class="t s7_734">38H </span><span id="t20_734" class="t s7_734">R/EDI </span><span id="t21_734" class="t s7_734">90H </span><span id="t22_734" class="t s7_734">IA32_PERF_GLOBAL_STATUS </span>
<span id="t23_734" class="t s7_734">40H </span><span id="t24_734" class="t s7_734">R/EBP </span><span id="t25_734" class="t s7_734">98H </span><span id="t26_734" class="t s7_734">Data Linear Address </span>
<span id="t27_734" class="t s7_734">48H </span><span id="t28_734" class="t s7_734">R/ESP </span><span id="t29_734" class="t s7_734">A0H </span><span id="t2a_734" class="t s7_734">Data Source Encoding </span>
<span id="t2b_734" class="t s7_734">50H </span><span id="t2c_734" class="t s7_734">R8 </span><span id="t2d_734" class="t s7_734">A8H </span><span id="t2e_734" class="t s7_734">Latency value (core cycles) </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
