<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p89" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_89{left:782px;bottom:68px;letter-spacing:0.09px;}
#t2_89{left:827px;bottom:68px;letter-spacing:0.11px;}
#t3_89{left:644px;bottom:1141px;letter-spacing:-0.14px;}
#t4_89{left:70px;bottom:1088px;letter-spacing:-0.15px;word-spacing:-1.23px;}
#t5_89{left:70px;bottom:1071px;letter-spacing:-0.15px;word-spacing:-0.44px;}
#t6_89{left:70px;bottom:1046px;letter-spacing:-0.15px;word-spacing:-1.18px;}
#t7_89{left:70px;bottom:1030px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t8_89{left:70px;bottom:1013px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t9_89{left:70px;bottom:996px;letter-spacing:-0.13px;word-spacing:-0.49px;}
#ta_89{left:70px;bottom:979px;letter-spacing:-0.15px;word-spacing:-1px;}
#tb_89{left:70px;bottom:962px;letter-spacing:-0.15px;word-spacing:-0.7px;}
#tc_89{left:70px;bottom:946px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#td_89{left:70px;bottom:929px;letter-spacing:-0.15px;word-spacing:-0.51px;}
#te_89{left:70px;bottom:904px;letter-spacing:-0.14px;word-spacing:-0.48px;}
#tf_89{left:653px;bottom:904px;letter-spacing:-0.14px;}
#tg_89{left:70px;bottom:888px;letter-spacing:-0.15px;}
#th_89{left:191px;bottom:888px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#ti_89{left:70px;bottom:863px;letter-spacing:-0.08px;word-spacing:-1px;}
#tj_89{left:70px;bottom:846px;letter-spacing:0.13px;word-spacing:-1.31px;}
#tk_89{left:399px;bottom:853px;letter-spacing:0.16px;}
#tl_89{left:417px;bottom:846px;letter-spacing:0.12px;word-spacing:-1.29px;}
#tm_89{left:70px;bottom:830px;letter-spacing:0.1px;word-spacing:-0.47px;}
#tn_89{left:70px;bottom:813px;letter-spacing:0.1px;word-spacing:-0.5px;}
#to_89{left:70px;bottom:788px;letter-spacing:-0.17px;word-spacing:-0.46px;}
#tp_89{left:70px;bottom:771px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#tq_89{left:70px;bottom:747px;letter-spacing:-0.18px;word-spacing:-0.61px;}
#tr_89{left:70px;bottom:730px;letter-spacing:-0.15px;word-spacing:-0.47px;}
#ts_89{left:70px;bottom:713px;letter-spacing:-0.16px;word-spacing:-1.32px;}
#tt_89{left:70px;bottom:697px;letter-spacing:-0.14px;word-spacing:-0.45px;}
#tu_89{left:70px;bottom:647px;letter-spacing:-0.09px;}
#tv_89{left:156px;bottom:647px;letter-spacing:-0.1px;word-spacing:-0.01px;}
#tw_89{left:70px;bottom:622px;letter-spacing:-0.15px;word-spacing:-0.68px;}
#tx_89{left:70px;bottom:606px;letter-spacing:-0.15px;word-spacing:-0.5px;}
#ty_89{left:70px;bottom:581px;letter-spacing:-0.16px;word-spacing:-0.62px;}
#tz_89{left:70px;bottom:564px;letter-spacing:-0.14px;word-spacing:-0.96px;}
#t10_89{left:70px;bottom:548px;letter-spacing:-0.15px;word-spacing:-0.45px;}
#t11_89{left:70px;bottom:489px;letter-spacing:0.12px;}
#t12_89{left:152px;bottom:489px;letter-spacing:0.15px;word-spacing:0.01px;}
#t13_89{left:70px;bottom:465px;letter-spacing:-0.14px;word-spacing:-0.46px;}
#t14_89{left:70px;bottom:448px;letter-spacing:-0.15px;word-spacing:-0.46px;}
#t15_89{left:70px;bottom:432px;letter-spacing:-0.19px;word-spacing:-0.4px;}
#t16_89{left:70px;bottom:398px;letter-spacing:-0.15px;word-spacing:-0.95px;}
#t17_89{left:70px;bottom:381px;letter-spacing:-0.15px;word-spacing:-0.45px;}
#t18_89{left:70px;bottom:364px;letter-spacing:-0.35px;}
#t19_89{left:70px;bottom:340px;letter-spacing:-0.15px;word-spacing:-0.49px;}
#t1a_89{left:70px;bottom:290px;letter-spacing:-0.09px;}
#t1b_89{left:156px;bottom:290px;letter-spacing:-0.1px;word-spacing:0.01px;}
#t1c_89{left:70px;bottom:266px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t1d_89{left:70px;bottom:249px;letter-spacing:-0.14px;word-spacing:-0.47px;}
#t1e_89{left:70px;bottom:190px;letter-spacing:0.12px;}
#t1f_89{left:152px;bottom:190px;letter-spacing:0.15px;word-spacing:0.01px;}
#t1g_89{left:70px;bottom:166px;letter-spacing:-0.14px;word-spacing:-0.49px;}
#t1h_89{left:70px;bottom:150px;letter-spacing:-0.14px;word-spacing:-0.42px;}

.s1_89{font-size:12px;font-family:NeoSansIntel_1uk1;color:#000;}
.s2_89{font-size:14px;font-family:NeoSansIntel_1uk1;color:#0860A8;}
.s3_89{font-size:14px;font-family:Verdana_3e8;color:#000;}
.s4_89{font-size:14px;font-family:Verdana_3e8;color:#0860A8;}
.s5_89{font-size:11px;font-family:Verdana_3e8;color:#000;}
.s6_89{font-size:17px;font-family:NeoSansIntelMedium_1uk0;color:#0860A8;}
.s7_89{font-size:18px;font-family:NeoSansIntelMedium_1uk0;color:#0860A8;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts89" type="text/css" >

@font-face {
	font-family: NeoSansIntelMedium_1uk0;
	src: url("fonts/NeoSansIntelMedium_1uk0.woff") format("woff");
}

@font-face {
	font-family: NeoSansIntel_1uk1;
	src: url("fonts/NeoSansIntel_1uk1.woff") format("woff");
}

@font-face {
	font-family: Verdana_3e8;
	src: url("fonts/Verdana_3e8.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg89Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg89" style="-webkit-user-select: none;"><object width="935" height="1210" data="89/89.svg" type="image/svg+xml" id="pdf89" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_89" class="t s1_89">Vol. 3A </span><span id="t2_89" class="t s1_89">2-27 </span>
<span id="t3_89" class="t s2_89">SYSTEM ARCHITECTURE OVERVIEW </span>
<span id="t4_89" class="t s3_89">of programmable and fixed-function performance monitoring counters for each processor generation are described </span>
<span id="t5_89" class="t s3_89">in Chapter 20, “Performance Monitoring.” </span>
<span id="t6_89" class="t s3_89">The programmable performance counters can support counting either the occurrence or duration of events. Events </span>
<span id="t7_89" class="t s3_89">that can be monitored on programmable counters generally are model specific (except for architectural perfor- </span>
<span id="t8_89" class="t s3_89">mance events enumerated by CPUID leaf 0AH); they may include the number of instructions decoded, interrupts </span>
<span id="t9_89" class="t s3_89">received, or the number of cache loads. Individual counters can be set up to monitor different events. Use the </span>
<span id="ta_89" class="t s3_89">system instruction WRMSR to set up values in one of the IA32_PERFEVTSELx MSR, in one of the 45 ESCRs and one </span>
<span id="tb_89" class="t s3_89">of the 18 CCCR MSRs (for Pentium 4 and Intel Xeon processors); or in the PerfEvtSel0 or the PerfEvtSel1 MSR (for </span>
<span id="tc_89" class="t s3_89">the P6 family processors). The RDPMC instruction loads the current count from the selected counter into the </span>
<span id="td_89" class="t s3_89">EDX:EAX registers. </span>
<span id="te_89" class="t s3_89">Fixed-function performance counters record only specific events that are defined at: </span><span id="tf_89" class="t s4_89">https://perfmon- </span>
<span id="tg_89" class="t s4_89">events.intel.com/ </span><span id="th_89" class="t s3_89">, and the width/number of fixed-function counters are enumerated by CPUID leaf 0AH. </span>
<span id="ti_89" class="t s3_89">The time-stamp counter is a model-specific 64-bit counter that is reset to zero each time the processor is reset. If </span>
<span id="tj_89" class="t s3_89">not reset, the counter will increment ~9.5 x 10 </span>
<span id="tk_89" class="t s5_89">16 </span>
<span id="tl_89" class="t s3_89">times per year when the processor is operating at a clock rate </span>
<span id="tm_89" class="t s3_89">of 3GHz. At this clock frequency, it would take over 190 years for the counter to wrap around. The RDTSC </span>
<span id="tn_89" class="t s3_89">instruction loads the current count of the time-stamp counter into the EDX:EAX registers. </span>
<span id="to_89" class="t s3_89">See Section 20.1, “Performance Monitoring Overview,” and Section 18.17, “Time-Stamp Counter,” for more infor- </span>
<span id="tp_89" class="t s3_89">mation about the performance monitoring and time-stamp counters. </span>
<span id="tq_89" class="t s3_89">The RDTSC instruction was introduced into the IA-32 architecture with the Pentium processor. The RDPMC instruc- </span>
<span id="tr_89" class="t s3_89">tion was introduced into the IA-32 architecture with the Pentium Pro processor and the Pentium processor with </span>
<span id="ts_89" class="t s3_89">MMX technology. Earlier Pentium processors have two performance-monitoring counters, but they can be read only </span>
<span id="tt_89" class="t s3_89">with the RDMSR instruction, and only at privilege level 0. </span>
<span id="tu_89" class="t s6_89">2.8.6.1 </span><span id="tv_89" class="t s6_89">Reading Counters in 64-Bit Mode </span>
<span id="tw_89" class="t s3_89">In 64-bit mode, RDTSC operates the same as in protected mode. The count in the time-stamp counter is stored in </span>
<span id="tx_89" class="t s3_89">EDX:EAX (or RDX[31:0]:RAX[31:0] with RDX[63:32]:RAX[63:32] cleared). </span>
<span id="ty_89" class="t s3_89">RDPMC requires an index to specify the offset of the performance-monitoring counter. In 64-bit mode for Pentium </span>
<span id="tz_89" class="t s3_89">4 or Intel Xeon processor families, the index is specified in ECX[30:0]. The current count of the performance-moni- </span>
<span id="t10_89" class="t s3_89">toring counter is stored in EDX:EAX (or RDX[31:0]:RAX[31:0] with RDX[63:32]:RAX[63:32] cleared). </span>
<span id="t11_89" class="t s7_89">2.8.7 </span><span id="t12_89" class="t s7_89">Reading and Writing Model-Specific Registers </span>
<span id="t13_89" class="t s3_89">The RDMSR (read model-specific register) and WRMSR (write model-specific register) instructions allow a </span>
<span id="t14_89" class="t s3_89">processor’s 64-bit model-specific registers (MSRs) to be read and written, respectively. The MSR to be read or </span>
<span id="t15_89" class="t s3_89">written is specified by the value in the ECX register. </span>
<span id="t16_89" class="t s3_89">RDMSR reads the value from the specified MSR to the EDX:EAX registers; WRMSR writes the value in the EDX:EAX </span>
<span id="t17_89" class="t s3_89">registers to the specified MSR. RDMSR and WRMSR were introduced into the IA-32 architecture with the Pentium </span>
<span id="t18_89" class="t s3_89">processor. </span>
<span id="t19_89" class="t s3_89">See Section 10.4, “Model-Specific Registers (MSRs),” for more information. </span>
<span id="t1a_89" class="t s6_89">2.8.7.1 </span><span id="t1b_89" class="t s6_89">Reading and Writing Model-Specific Registers in 64-Bit Mode </span>
<span id="t1c_89" class="t s3_89">RDMSR and WRMSR require an index to specify the address of an MSR. In 64-bit mode, the index is 32 bits; it is </span>
<span id="t1d_89" class="t s3_89">specified using ECX. </span>
<span id="t1e_89" class="t s7_89">2.8.8 </span><span id="t1f_89" class="t s7_89">Enabling Processor Extended States </span>
<span id="t1g_89" class="t s3_89">The XSETBV instruction is required to enable OS support of individual processor extended states in XCR0 (see </span>
<span id="t1h_89" class="t s3_89">Section 2.6). </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
